<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js"
    integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"
    integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

<style>
    /* Absolute Center Spinner */
    * {
        font-family: 'Times New Roman', Times, serif;
    }

    .borderless,
    .borderless th,
    .borderless td {
        border: 0;
        border-collapse: collapse;
    }

    .loading {
        position: fixed;
        z-index: 999;
        height: 2em;
        width: 2em;
        overflow: show;
        margin: auto;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        display: none;
    }

    /* Transparent Overlay */

    .loading:before {
        content: '';
        display: block;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.3);
    }

    /* :not(:required) hides these rules from IE9 and below */

    .loading:not(:required) {
        /* hide "loading..." text */
        font: 0/0 a;
        color: transparent;
        text-shadow: none;
        background-color: transparent;
        border: 0;
    }

    .loading:not(:required):after {
        content: '';
        display: block;
        font-size: 10px;
        width: 1em;
        height: 1em;
        margin-top: -0.5em;
        -webkit-animation: spinner 1500ms infinite linear;
        -moz-animation: spinner 1500ms infinite linear;
        -ms-animation: spinner 1500ms infinite linear;
        -o-animation: spinner 1500ms infinite linear;
        animation: spinner 1500ms infinite linear;
        border-radius: 0.5em;
        -webkit-box-shadow: rgba(0, 0, 0, 0.75) 1.5em 0 0 0, rgba(0, 0, 0, 0.75) 1.1em 1.1em 0 0, rgba(0, 0, 0, 0.75) 0 1.5em 0 0, rgba(0, 0, 0, 0.75) -1.1em 1.1em 0 0, rgba(0, 0, 0, 0.5) -1.5em 0 0 0, rgba(0, 0, 0, 0.5) -1.1em -1.1em 0 0, rgba(0, 0, 0, 0.75) 0 -1.5em 0 0, rgba(0, 0, 0, 0.75) 1.1em -1.1em 0 0;
        box-shadow: rgba(0, 0, 0, 0.75) 1.5em 0 0 0, rgba(0, 0, 0, 0.75) 1.1em 1.1em 0 0, rgba(0, 0, 0, 0.75) 0 1.5em 0 0, rgba(0, 0, 0, 0.75) -1.1em 1.1em 0 0, rgba(0, 0, 0, 0.75) -1.5em 0 0 0, rgba(0, 0, 0, 0.75) -1.1em -1.1em 0 0, rgba(0, 0, 0, 0.75) 0 -1.5em 0 0, rgba(0, 0, 0, 0.75) 1.1em -1.1em 0 0;
    }

    /* Animation */

    @-webkit-keyframes spinner {
        0% {
            -webkit-transform: rotate(0deg);
            -moz-transform: rotate(0deg);
            -ms-transform: rotate(0deg);
            -o-transform: rotate(0deg);
            transform: rotate(0deg);
        }

        100% {
            -webkit-transform: rotate(360deg);
            -moz-transform: rotate(360deg);
            -ms-transform: rotate(360deg);
            -o-transform: rotate(360deg);
            transform: rotate(360deg);
        }
    }

    @-moz-keyframes spinner {
        0% {
            -webkit-transform: rotate(0deg);
            -moz-transform: rotate(0deg);
            -ms-transform: rotate(0deg);
            -o-transform: rotate(0deg);
            transform: rotate(0deg);
        }

        100% {
            -webkit-transform: rotate(360deg);
            -moz-transform: rotate(360deg);
            -ms-transform: rotate(360deg);
            -o-transform: rotate(360deg);
            transform: rotate(360deg);
        }
    }

    @-o-keyframes spinner {
        0% {
            -webkit-transform: rotate(0deg);
            -moz-transform: rotate(0deg);
            -ms-transform: rotate(0deg);
            -o-transform: rotate(0deg);
            transform: rotate(0deg);
        }

        100% {
            -webkit-transform: rotate(360deg);
            -moz-transform: rotate(360deg);
            -ms-transform: rotate(360deg);
            -o-transform: rotate(360deg);
            transform: rotate(360deg);
        }
    }

    @keyframes spinner {
        0% {
            -webkit-transform: rotate(0deg);
            -moz-transform: rotate(0deg);
            -ms-transform: rotate(0deg);
            -o-transform: rotate(0deg);
            transform: rotate(0deg);
        }

        100% {
            -webkit-transform: rotate(360deg);
            -moz-transform: rotate(360deg);
            -ms-transform: rotate(360deg);
            -o-transform: rotate(360deg);
            transform: rotate(360deg);
        }
    }

    button {
        cursor: pointer;
    }
</style>

</head>

<body>
    <div class="loading" id="loader"></div>

    <a id="dlink" style="display:none;"></a>
    <div id="main">
        <div style="width: 40%; margin-left:30%;">
            <table class="table table-bordered">
                <tr>
                    <td style="font-size: 15px;padding-top: 15px;">
                        Start Month
                    </td>
                    <td style="width: 60%;">
                        <input type="date" class=" form-control" id="start-date">
                    </td>
                </tr>
                <tr>
                    <td style="font-size: 15px;padding-top: 15px;">
                        End Month
                    </td>
                    <td style="width: 60%;">
                        <input type="date" class=" form-control" id="end-date">
                    </td>
                </tr>
                <tr>
                    <td><button onClick="submit()" class="btn btn-primary" id="tap">Submit</button></td>
                    <td style="text-align: right;">
                        <div id="downloads" style="display: none;">
                            <img src="https://img.icons8.com/dusk/35/000000/pdf.png"
                                onmouseover="this.style.cursor='pointer'" onclick="printContent('output')"
                                style="cursor: pointer;">
                        </div>
                    </td>


                </tr>
            </table>
        </div>
        <br>
        <div id="output" style="display: none;">
            <style>
                * {
                    font-family: 'Times New Roman', Times, serif;
                }

                .borderless,
                .borderless th,
                .borderless td {
                    border: 0;
                    border-collapse: collapse;
                }
            </style>

            <div style="text-align: center;">
                <img src="../api/documents/O8RzHqmSzuE/data" alt="mizoram health strn project" height='100'
                    width='100' />
            </div>
            <table class="table table-hover borderless" style="width:100%;text-align:center">
                <tbody>
                    <tr>
                        <td>
                            <h2>Mizoram Health Systems Strengthening Project</h2>
                            <h3>REPORT OF EX-ANTE VERIFICATION</h3>
                        </td>
                    </tr>

                </tbody>
            </table>

            <table class="table table-hover borderless" style="width:100%;text-align:left">
                <tbody>
                    <tr>
                        <td>
                            <h5>NAME OF QUALITY ASSESSMENT TEAM: <span id="qa-team-name"></span></h5>
                            <h5>NAME OF IPA UNIT ASSESSED: <span id="ou"></span></h5>
                            <h5>DATE OF EX-ANTE ASSESSMENT:<span id="exAnte-startDate"></span><span
                                    id="exAnte-endDate"></span></h5>
                            <h5>PERIOD OF EX-ANTE ASSESSMENT: <span id="quater-dates"></span></h5>

                        </td>
                    </tr>
                </tbody>
            </table>
            <div>
                <h5 style="font-weight: 700;border-bottom:1px solid black;">SUMMARY</h5>
                <h5 style="font-weight: 700;">SHT EX-ANTE ASSESSMENT SCORE: </h5>
            </div>

            <table class="table table-bordered table-hover">
                <colgroup>
                    <col width="30%" />
                    <col width="20%" />
                </colgroup>
                <thead>
                    <td>
                        <h6>CODE</h6>
                    </td>
                    <td style="text-align: center;">
                        <h6>Score</h6>
                    </td>
                </thead>
                <tbody id="code-score"></tbody>
            </table>
            <br>
            <br>
            <br>
            <br>

            <div>
                <h5 style="font-weight: 700;border-bottom:1px solid black;">SHT One-time Deliverables </h5>
            </div>
            <table class="table table-bordered table-hover " width="100%">
                <thead>
                    <tr>
                        <th>S.No.</th>
                        <th>Deliverable</th>
                        <th style="text-align:center;">DATE</th>
                        <th style="text-align:center;">STATUS</th>
                    </tr>

                </thead>
                <tr>
                    <td>1.</td>
                    <td>NQAS Accreditation Road Map and
                        designated NQAS certified staff recruitment
                        for QA improvement executed</td>
                    <td style="text-align:center;"><span id="vB4sxMlhcK5-event-date"></span></td>
                    <td style="text-align:center;"><span id="vB4sxMlhcK5"></span></td>
                </tr>
                <tr>
                    <td>2.</td>
                    <td>NQAS Work - Training of Internal Evaluators
                        and Peer Reviewers - One batch of 30</td>
                    <td style="text-align:center;"><span id="wJPE4wYHDJA-event-date"></span></td>
                    <td style="text-align:center;"><span id="wJPE4wYHDJA"></span></td>
                </tr>
                <tr>
                    <td>3.</td>
                    <td>Intra-departmental formal meeting for
                        electronic payment of salary linked to
                        biomedical attendance system</td>
                    <td style="text-align:center;"><span id="Tx3633fxM9g-event-date"></span></td>
                    <td style="text-align:center;"><span id="Tx3633fxM9g"></span></td>
                </tr>
                <tr>
                    <td>4.</td>
                    <td>Notification/Government Order issued by the
                        State to link electronic attendance with salary
                        payment</td>
                    <td style="text-align:center;"><span id="gGm5qL42n6v-event-date"></span></td>
                    <td style="text-align:center;"><span id="gGm5qL42n6v"></span></td>
                </tr>
                <tr>
                    <td>5.</td>
                    <td>Payment of all staff (Contractual/Permanent)
                        through electronic payment</td>
                    <td style="text-align:center;"><span id="tbQS9uh1Jq0-event-date"></span></td>
                    <td style="text-align:center;"><span id="tbQS9uh1Jq0"></span></td>
                </tr>
                <tr>
                    <td>6.</td>
                    <td>Departmental Meeting to draft the HR Policy</td>
                    <td style="text-align:center;"><span id="S1oNoWatr0O-event-date"></span></td>
                    <td style="text-align:center;"><span id="S1oNoWatr0O"></span></td>
                </tr>
                <tr>
                    <td>7.</td>
                    <td>Drafted HR Policy sent to Finance and Law
                        Departments for inputs</td>
                    <td style="text-align:center;"><span id="H4uiEdRPa0t-event-date"></span></td>
                    <td style="text-align:center;"><span id="H4uiEdRPa0t"></span></td>
                </tr>
                <tr>
                    <td>8.</td>
                    <td>Drafted HR Policy in public domain for inputs</td>
                    <td style="text-align:center;"><span id="z5JTiX0LToG-event-date"></span></td>
                    <td style="text-align:center;"><span id="z5JTiX0LToG"></span></td>
                </tr>
                <tr>
                    <td>9.</td>
                    <td>HR Policy finalised and notified </td>
                    <td style="text-align:center;"><span id="tQP1lzDLggX-event-date"></span></td>
                    <td style="text-align:center;"><span id="tQP1lzDLggX"></span></td>
                </tr>
                <tr>
                    <td>10.</td>
                    <td>State advertisement for PPP for
                        specialists/teams</td>
                    <td style="text-align:center;"><span id="t2bWMqRQ97s-event-date"></span></td>
                    <td style="text-align:center;"><span id="t2bWMqRQ97s"></span></td>
                </tr>
                <tr>
                    <td>11.</td>
                    <td>State notification on roster of existing
                        specialists to provide fixed day service in other DH/CHC</td>
                    <td style="text-align:center;"><span id="mGqYWxjM2s4-event-date"></span></td>
                    <td style="text-align:center;"><span id="mGqYWxjM2s4"></span></td>
                </tr>
                <tr>
                    <td>12.</td>
                    <td>State notifications on district wide specialist
                        care teams, may include specialists from
                        private sector</td>
                    <td style="text-align:center;"><span id="Xy1uZ3Uhu3R-event-date"></span></td>
                    <td style="text-align:center;"><span id="Xy1uZ3Uhu3R"></span></td>
                </tr>
                <tr>
                    <td>13.</td>
                    <td>Specialist teams providing services for at least
                        once a month in other institutions</td>
                    <td style="text-align:center;"><span id="W6MEb39m76S-event-date"></span></td>
                    <td style="text-align:center;"><span id="W6MEb39m76S"></span></td>
                </tr>
                <tr>
                    <td>14.</td>
                    <td>Institution-specific Standard Treatment
                        Guideline development</td>
                    <td style="text-align:center;"><span id="CrvtN4vwdX3-event-date"></span></td>
                    <td style="text-align:center;"><span id="CrvtN4vwdX3"></span></td>
                </tr>
                <tr>
                    <td>15.</td>
                    <td>Institution-specific Standard Treatment
                        Guideline finalisation</td>
                    <td style="text-align:center;"><span id="wJvbhxRvuEU-event-date"></span></td>
                    <td style="text-align:center;"><span id="wJvbhxRvuEU"></span></td>
                </tr>
                <tr>
                    <td>16.</td>
                    <td>New 25% of Medical Officers trained on
                        Standard Treatment Guideline</td>
                    <td style="text-align:center;"><span id="rXOGRT58uay-event-date"></span></td>
                    <td style="text-align:center;"><span id="rXOGRT58uay"></span></td>
                </tr>
                <tr>
                    <td>17.</td>
                    <td>Training Manual on Public Health
                        Emergencies in Health Institutions developed</td>
                    <td style="text-align:center;"><span id="YdgL2BB1Q61-event-date"></span></td>
                    <td style="text-align:center;"><span id="YdgL2BB1Q61"></span></td>
                </tr>
                <tr>
                    <td>18.</td>
                    <td>20% facilities trained to be prepared for
                        Public Health Emergencies</td>
                    <td style="text-align:center;"><span id="S14YPQmldYh-event-date"></span></td>
                    <td style="text-align:center;"><span id="S14YPQmldYh"></span></td>
                </tr>
                <tr>
                    <td>19.</td>
                    <td>State formed a team to cross-check on
                        duplication of procurement activity or
                        purchase of items or equipment from NHM,
                        DHME and DHS</td>
                    <td style="text-align:center;"><span id="AeF1vBgPdR0-event-date"></span></td>
                    <td style="text-align:center;"><span id="AeF1vBgPdR0"></span></td>
                </tr>
                <tr>
                    <td>20.</td>
                    <td>50% facilities/districts supplied with essential
                        medicines as per the indent received</td>
                    <td style="text-align:center;"><span id="cEGdWG1oQkt-event-date"></span></td>
                    <td style="text-align:center;"><span id="cEGdWG1oQkt"></span></td>
                </tr>
                <tr>
                    <td>21.</td>
                    <td>Public notification intending to open low-cost
                        medical outlet in the DH and CHC</td>
                    <td style="text-align:center;"><span id="Xf20drGqKQt-event-date"></span></td>
                    <td style="text-align:center;"><span id="Xf20drGqKQt"></span></td>
                </tr>
                <tr>
                    <td>22.</td>
                    <td>Space allotment and agency identification for
                        low-cost medicines in all DH and CHC</td>
                    <td style="text-align:center;"><span id="q0hK7T1ThZT-event-date"></span></td>
                    <td style="text-align:center;"><span id="q0hK7T1ThZT"></span></td>
                </tr>
                <tr>
                    <td>23.</td>
                    <td>Official Inaugurations of opening of the low-
                        cost medicine outlets 15%</td>
                    <td style="text-align:center;"><span id="aiyr1VkiHjx-event-date"></span></td>
                    <td style="text-align:center;"><span id="aiyr1VkiHjx"></span></td>
                </tr>
                <tr>
                    <td>24.</td>
                    <td>New 30% of DH/CHC having functional low-
                        cost medicine outlet [Jan Aushadhi and/or
                        Amrit Pharmacy] </td>
                    <td style="text-align:center;"><span id="nMiNMLBErnr-event-date"></span></td>
                    <td style="text-align:center;"><span id="nMiNMLBErnr"></span></td>
                </tr>
            </table>

            <div>
                <h5 style="font-weight: 700;border-bottom:1px solid black;">Ex-Ante Assessment Notes</h5>
                <p id="ex-anteNotes"></p>
            </div>

            <div>
                <table class="table table-bordered table-hover">
                    <colgroup>
                        <col width="20%" />
                        <col width="80%" />
                    </colgroup>
                    <thead>
                        <td>
                            <h6>CODE</h6>
                        </td>
                        <td style="text-align: center;">
                            <h6>COMMENTS</h6>
                        </td>
                    </thead>
                    <tbody id="code-comments"></tbody>
                </table>
            </div>

            <div>
                <h5 style="font-weight: 700;border-bottom:1px solid black;">ASSESSORS</h5>
            </div>
            <div>
                <h5>Assessor I (Name and Designation): <span id="assessorI-nd"></span></h5>
                <h5>Assessor II (Name and Designation):<span id="assessorII-nd"></span></h5>
                <h5>Assessor III (Name and Designation): <span id="assessorIII-nd"></span> </h5>
            </div>
            <br>
            <div>
                <h5>Signature: </h5>
            </div>
            <div>
                <div style="width:30%;float:left;">
                    ________________
                    <br>
                    <p id="assessorI-designation"></p>
                </div>
                <div style="width:40%;float:left;">
                    __________________________
                    <br>
                    <p id="assessorII-designation"></p>
                </div>
                <div style="width:30%;float:left;">
                    ________________
                    <br>
                    <p id="assessorIII-designation"></p>
                </div>
            </div>


        </div>
    </div>
</body>

<script>
    var selectedOrgUnit = dhis2.report.organisationUnit;
    var quaters = [
        "January-March",
        "April-June",
        "July-September",
        "October-December"
    ]
    var dataElement = [
        {
            id: 'OuaDZeFJqpj',
            name: 'SHT_1_NQAS'
        },
        {
            id: 'xnecLpYQ4Lu',
            name: 'SHT_2_Dist_Ass'
        },
        {
            id: 'QHJvFFDoHof',
            name: 'SHT_3_Policies'
        },
        {
            id: 'aVdgnK5VvnO + IJqEQIv5AG3 + BLembZTwLNn',
            name: 'SHT_4_JMM'
        },
        {
            id: 'YP6zJgpikqZ',
            name: 'SHT_5_PAY'
        },
        {
            id: 'Rw8gUpXgPjN',
            name: 'SHT_6_KM'
        },
        {
            id: 'jdYVfqroshX',
            name: 'SHT_7_ICT'
        },
        {
            id: 'm50G1QGE4E8',
            name: 'TOTAL (Max 1000 points = 100%)'
        },
        {
            id: 'm50G1QGE4E8',
            name: 'PERCENTAGE'
        }
    ];
    var deComments = [
        {
            id: 'tssjehQhdj3',
            name: 'SHT_1_NQAS'
        },
        {
            id: 'UasUkPzRjQ3',
            name: 'SHT_2_Dist_Ass'
        },
        {
            id: 'c6uiiuhyhj3',
            name: 'SHT_3_Policies'
        },
        {
            id: 'HAmeGZ3nUi5',
            name: 'SHT_4_JMM'
        },
        {
            id: 'UCtE937u81Y',
            name: 'SHT_5_PAY'
        },
        {
            id: 'uhdwklCTHCg',
            name: 'SHT_6_KM'
        },
        {
            id: 'a5uK26nhufj',
            name: 'SHT_7_ICT'
        }
    ];
    var oneTimeDeliverables = {
        vB4sxMlhcK5: true,
        wJPE4wYHDJA: true,
        Tx3633fxM9g: true,
        gGm5qL42n6v: true,
        tbQS9uh1Jq0: true,
        S1oNoWatr0O: true,
        H4uiEdRPa0t: true,
        z5JTiX0LToG: true,
        tQP1lzDLggX: true,
        t2bWMqRQ97s: true,
        mGqYWxjM2s4: true,
        Xy1uZ3Uhu3R: true,
        W6MEb39m76S: true,
        CrvtN4vwdX3: true,
        wJvbhxRvuEU: true,
        rXOGRT58uay: true,
        YdgL2BB1Q61: true,
        S14YPQmldYh: true,
        AeF1vBgPdR0: true,
        cEGdWG1oQkt: true,
        Xf20drGqKQt: true,
        q0hK7T1ThZT: true,
        aiyr1VkiHjx: true,
        nMiNMLBErnr: true
    }

    document.getElementById("loader").style.display = "none";

    var submit = function () {
        document.getElementById("downloads").style.display = "none";

        var startDate = document.getElementById("start-date").value;
        var endDate = document.getElementById("end-date").value;
        var dates = [startDate, endDate];
        var data = {
            startDate: startDate,
            endDate: endDate
        }

        if (new Date(dates["0"]) > new Date(dates["1"]) || !dates["0"] || !dates["1"]) alert("Please select dates Correctly");
        else {
            document.getElementById("output").style.display = "none";
            document.getElementById("loader").style.display = "block";

            setTimeout(function () {
                getData(data)
            }, 1000)
        }

        async function getData(data) {
            var dataObj = {};

            var responseFirst = await (await fetch(`../api/events.json?fields=*&program=TVQwW3ykTzX&orgUnit=${selectedOrgUnit.id}&startDate=${data.startDate}&endDate=${data.endDate}&paging=false`)).json();
            responseFirst.events.forEach(event => {
                event.dataValues.forEach(dv => {
                    dataObj[dv.dataElement] = dv.value;
                    if (oneTimeDeliverables[dv.dataElement] && dv.value == true) {
                        let value = event.eventDate.split("T")[0];
                        dataObj[`${dv.dataElement}-event-date`] = value;
                    }
                })
                if (event.programStage == 'WRW0lyez5Sh') {
                    let value = event.eventDate.split("T")[0];
                    let year = Number(value.split("-")[0]);
                    value = Number(value.split("-")[1]);
                    value = value >= 1 && value <= 3 ? 0 : value;
                    value = value >= 4 && value <= 6 ? 1 : value;
                    value = value >= 7 && value <= 9 ? 2 : value;
                    value = value >= 10 && value <= 12 ? 3 : value;
                    let quater = quaters[(value + '')].split('-');

                    dataObj["exAnte-ev"] = quater.length ? quater[0] + ' ' + year + ' - ' + quater[1] + ' ' + year : ''
                }
            });
            document.getElementById('qa-team-name').innerHTML = (dataObj['D8fsB13w245'] ? dataObj['D8fsB13w245'] : '');
            document.getElementById('ou').innerHTML = selectedOrgUnit.name;
            document.getElementById('quater-dates').innerHTML = dataObj["exAnte-ev"];
            document.getElementById('exAnte-startDate').innerHTML = (dataObj['WWekZ4prgf4'] ? dataObj['WWekZ4prgf4'] : '');
            document.getElementById('exAnte-endDate').innerHTML = (dataObj['MkkWs8MkL8C'] ? ` to ${dataObj['MkkWs8MkL8C']}` : '');

            for(let id in oneTimeDeliverables) {
            console.log(id)
            document.getElementById(id).innerHTML = (dataObj[id] ? 'Completed' : '');
            document.getElementById(`${id}-event-date`).innerHTML = (dataObj[`${id}-event-date`] ? dataObj[`${id}-event-date`] : '');

            }
            
            document.getElementById('ex-anteNotes').innerHTML = dataObj['kEmB5rxi38s'] ? dataObj['kEmB5rxi38s'] : '';
            
            document.getElementById('assessorI-nd').innerHTML = (dataObj['YHGt2ebEsPP'] ? dataObj['YHGt2ebEsPP'] : '') + (dataObj['Bt7OvMO4KoD'] ? `, ${dataObj['Bt7OvMO4KoD']}` : '');
            document.getElementById('assessorII-nd').innerHTML = (dataObj['tHlFqnqwV2o'] ? dataObj['tHlFqnqwV2o'] : '') + (dataObj['PEUbEOT8VNV'] ? `, ${dataObj['PEUbEOT8VNV']}` : '');
            document.getElementById('assessorIII-nd').innerHTML = (dataObj['g3xzqucnUyW'] ? dataObj['g3xzqucnUyW'] : '') + (dataObj['Zrt7faR6v76'] ? `, ${dataObj['Zrt7faR6v76']}` : '');
            document.getElementById('assessorI-designation').innerHTML = (dataObj['Bt7OvMO4KoD'] ? dataObj['Bt7OvMO4KoD'] : '');
            document.getElementById('assessorII-designation').innerHTML = (dataObj['PEUbEOT8VNV'] ? dataObj['PEUbEOT8VNV'] : '');
            document.getElementById('assessorIII-designation').innerHTML = (dataObj['Zrt7faR6v76'] ? dataObj['Zrt7faR6v76'] : '');

            var codeScore = '';
            dataElement.forEach(de => {
                if (de.name == "SHT_4_JMM") {
                    let totalValue = 0;
                    let des = de.id.split(" + ");
                    des.forEach(de => totalValue += dataObj[de] ? Number(dataObj[de]) : 0);
                    codeScore += `<tr><td >${de.name}</td><td style="text-align:center;">${totalValue}</td></tr>`;

                } else if (de.id == "m50G1QGE4E8") {
                    let value = dataObj['m50G1QGE4E8'] ? dataObj['m50G1QGE4E8'] : '';
                    if (de.name == "PERCENTAGE") calculatedVal = value ? ((value / 1000) && value / 1000 != "Infinity" ? ((value / 1000) * 100).toFixed(2) : '') : '';
                    else calculatedVal = value;
                    codeScore += `<tr><td style="font-weight:bold">${de.name}</td><td style="text-align:center;font-weight:bold">${calculatedVal}</td></tr>`;
                }
                else codeScore += `<tr><td>${de.name}</td><td style="text-align:center">${(dataObj[de.id] ? dataObj[de.id] : '')}</td></tr>`;
            })
            document.getElementById('code-score').innerHTML = codeScore;

            var codeComments = '';
            deComments.forEach(de => {
                codeComments += `<tr><td>${de.name}</td><td style="text-align:center">${(dataObj[de.id] ? dataObj[de.id] : '')}</td></tr>`;
            })
            document.getElementById('code-comments').innerHTML = codeComments;

            document.getElementById("output").style.display = "block";
            document.getElementById("downloads").style.display = "block";
            document.getElementById("loader").style.display = "none";

        }
    };

    function printContent(el) {
        var restorepage = document.body.innerHTML;
        var printcontent = document.getElementById("output").innerHTML;
        document.body.innerHTML = printcontent;
        window.print();
        window.location.reload();

    }

</script>