<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        table,
        tr,
        td {
            border: 1px solid black;
            border-collapse: collapse;
            text-align: center;
            font-size: 14px;
            font-family: Roboto, sans-serif;
        }
        .dSelection {
            margin-left: 25%;
            height: 150px;
            width: 550px;
            background-color:#ebf0f6;
            padding: 30px;
            border-radius: 10px;
            font-size: 16px;
            border: 1px solid black;
        }

        #loader {
            position: absolute;
            left: 50%;
            top: 70%;
            z-index: 1;
            width: 150px;
            height: 150px;
            margin: -75px 0 0 -75px;
            border: 16px solid #f3f3f3;
            border-radius: 50%;
            border-top: 16px solid #34B4DB;
            width: 120px;
            height: 120px;
            -webkit-animation: spin 2s linear infinite;
            animation: spin 2s linear infinite;
        }

        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0deg);
            }

            100% {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<div class="dSelection">
    <label>Department Name :</label>
    <select name="" id="department" style="height: 30px;">
        <option selected hidden>Select Department</option>
    </select>
   <div style="padding-top: 10px;">
    <label>Sample Name :</label>
    <select name="" id="sampleSelection" style="height: 30px; margin-left: 27px;">
        <option selected hidden>Select Sample</option>
    </select>
   </div>
    <div style="padding-top: 10px; padding-bottom: 10px;">
     <label style="margin-right: 30px;">Select Period :</label>
     <select  id="year" style="height: 30px;">
    </select>
    <select name="" id="month" style="height: 30px;">
        <option value="01">January</option>
        <option value="02">February</option>
        <option value="03">March</option>
        <option value="04">April</option>
        <option value="05">May</option>
        <option value="06">June</option>
        <option value="07">July</option>
        <option value="08">August</option>
        <option value="09">September</option>
        <option value="10">October</option>
        <option value="11">November</option>
        <option value="12">December</option>
    </select>
    </div>
    <button style="background-color: rgb(44, 102, 147); margin-left: 10px; border-radius: 10px;height: 35px; font-weight: bold; margin-left: 185px; color: white;" onclick="generateReport()">Generate Report</button>
</div>
<div id="loader"></div>
<div id="print" >
    <button type="button"  style=" background-color: rgb(44, 102, 147); height: 40px; font-weight: bold; padding: 10px; width: 90px; text-align: center; border-radius: 10px; color: white;"onclick="printContent('table')">&nbsp;Print</button>
</div>
<section id="table">
    <table id="table1" width="100%" >
        <thead >
            <tr>
                <th colspan="12" style="background-color: rgb(44, 102, 147); color: white;">Three most resistant drugs</th>
            </tr>
            <tr>
                <th colspan="12" style="background-color: rgb(44, 102, 147); color: white;"> Department - <span class="selectedDepartment"></span></th>
            </tr>
            <tr>
                <th colspan="12" style="background-color: rgb(44, 102, 147); color: white;"> Sample - <span class="sample"></span></th>
            </tr>
            <tr>
                <th colspan="12" style="background-color: rgb(44, 102, 147); color: white;"><span id="og1"></span></th>
            </tr>
             <tr style="background-color: #ebf0f6;">
                <td>S.No</td>
                <td>Most Resistant/Sensitive</td>
                <td>Antibiotics Name</td>
                <td>OPD</td>
                <td>ICU</td>
                <td>NICU</td>
                <td>Ward</td>
                <td>CCU</td>
                <td>Burn Unit</td>
                <td>PICU</td>
                <td>Unknown</td>
                <td>Total</td>
            </tr>
        </thead>
        <tbody> 
        </tbody>
    </table>
    <br />
    <table id="table2" width="100%" >
        <thead>
            <tr>
                <th colspan="12" style="color: white; background-color: rgb(44, 102, 147);"><span id="og2"></span></th>
            </tr>
             <tr style="background-color: #ebf0f6;">
                <td>S.No</td>
                <td>Most Resistant/Sensitive</td>
                <td>Antibiotics Name</td>
                <td>OPD</td>
                <td>ICU</td>
                <td>NICU</td>
                <td>Ward</td>
                <td>CCU</td>
                <td>Burn Unit</td>
                <td>PICU</td>
                <td>Unknown</td>
                <td>Total</td>
            </tr>
        </thead>
        <tbody> 
        </tbody>
    </table>
    <br />
    <table id="table3" width="100%" >
        <thead>
            <tr>
                <th colspan="12" style="background-color: rgb(44, 102, 147); color: white;"><span id="og3"></span></th>
            </tr>
             <tr style="background-color: #ebf0f6;">
                <td>S.No</td>
                <td>Most Resistant/Sensitive</td>
                <td>Antibiotics Name</td>
                <td>OPD</td>
                <td>ICU</td>
                <td>NICU</td>
                <td>Ward</td>
                <td>CCU</td>
                <td>Burn Unit</td>
                <td>PICU</td>
                <td>Unknown</td>
                <td>Total</td>
            </tr>
          </thead>
        <tbody> 
           
        </tbody>
    </table>
    <br />
</section>
</html>
<script>
   var aoData =[
{aId:"I5oNT6aYZS9", aName:'Acinetobacter baumannii - AW',	oId:'tXD8XFWShLu',oName:"Acinetobacter baumannii"},
{aId:"r7bjTxLIgCq", aName:"Acinetobacter calcoaceticus - AW",	oId:"e1IUxzo6g1J", oName:"Acinetobacter calcoaceticus"},
{aId:"bxW34t0xz0s",	aName:"Acinetobacter lwoffii - AW",	oId:"wZ7LAmgPWWw",	oName:"Acinetobacter lwoffii"},
{aId:"MnxsHJlTc55",	aName:"Acinetobacter spp. - AW",oId:"mYJjJmdJOqw", oName:"Acinetobacter spp."},
 {aId:"gFW3bixpypH", aName:"Aeromonas spp. - AW", oId:"gmn116uDf7s", oName:"Aeromonas spp."},
 {aId:"v7Ukm9e3cF6", aName:"Arizona spp. - AW", oId:"vcAIYI5yREO", oName:"Arizona spp."},
 {aId:"a0g4n2SCgjW", aName:"Aspergillus flavus - AW", oId:"pK7hHbAJK7b", oName:"Aspergillus flavus"},
 {aId:"GnBn8lgUiZL", aName:"Aspergillus fumigatus - AW", oId:"pTCUC4aW6Km", oName:"Aspergillus fumigatus"},
 {aId:"Jal7j67OZZX", aName:"Aspergillus nidulans - AW",	oId:"LvZ43nVFRo0", oName:"Aspergillus nidulans"},
 {aId:"uEbxkzrPqkr", aName:"Aspergillus niger - AW",	oId:"F8XIhKNG5vJ", oName:"Aspergillus niger"},
 {aId:"evNo2gYJZ6N", aName:"Aspergillus terreus - AW",	oId:"X7iypNUfSJm", oName:"Aspergillus terreus"},
 {aId:"rhTgkToqMHn", aName:"Aspergillus versicolor - AW",	oId:"Rz3lMI7fRbS", oName:" Aspergillus versicolor"},
 {aId:"kYNdjBnk0s8", aName:"Blastobortrys adeninivorans - AW",	oId:"jIdJQTPkQeL", oName:" Blastobortrys adeninivorans"},
 {aId:"mOven4FhQJY", aName:"Burkholderia cepacia - AW",	oId:"ULu7XaTIDTS", oName:"Burkholderia cepacia"},
 {aId:"vrXfJKjFbJA", aName:"Campylobacter jejuni - AW",	oId:"OXW4u7hVvXS", oName:" Campylobacter jejuni"},
 {aId:"WDysZqtpxVY", aName:"Candida albicans - AW",	oId:"uca3pIEzbiX", oName:"Candida albicans"},
 {aId:"RnU13XIKI3O", aName:"Candida auris - AW",	oId:"kBLWWk3jd42", oName:"Candida auris"},
 {aId:"wHVPM4kqDJj", aName:"Candida catenulata - AW",	oId:"j4pTAIz3Cy8", oName:" Candida catenulata"},
 {aId:"ZdtNG420QNw", aName:"Candida chiropterorum - AW",	oId:"M2s0qSrhJej", oName:"Candida chiropterorum"},
 {aId:"L9MVubYrzA8", aName:"Candida famata - AW",	oId:"ZF5OKh2kZRQ", oName:"Candida famata"},
 {aId:"ZkZVWTyXA4q", aName:"Candida glabrata - AW",	oId:"K6TrparggHU", oName:" Candida glabrata"},
 {aId:"GCiHFD396jt", aName:"Candida guilliermondii - AW",	oId:"BZNcL8jeUPf", oName:"Candida guilliermondii"},
 {aId:"rfEH2kk0QYY", aName:"Candida haemulonii - AW",	oId:"wkfpknYuhkM", oName:"Candida haemulonii"},
 {aId:"piFxDvwngAX", aName:"Candida intermedia - AW",	oId:"tQ85XfQoxDc", oName:"Candida intermedia"},
 {aId:"zC9fxkjGwHs", aName:"Candida kefyr - AW",	oId:"jRXpq7vJUXu", oName:"Candida kefyr"},
 {aId:"d2gR2cFHxbI", aName:"Candida krusei - AW",	oId:"mzRsc86gEoc", oName:"Candida krusei"},
 {aId:"DzKR4p2l9te", aName:"Candida lipolytica - AW",	oId:"fBUrCfm0YEy", oName:"Candida lipolytica"},
 {aId:"t8P7m7SYWcF", aName:"Candida lusitaniae - AW",	oId:"dSisvVZ4d59", oName:" Candida lusitaniae"},
 {aId:"EhfHdxhxF0J", aName:"Candida nivariensis - AW",	oId:"FAwYniCYfBF", oName:"Candida nivariensis"},
 {aId:"xYMmjCLrQX3", aName:"Candida parapsilosis - AW",	oId:"acAD5WuxgA6", oName:"Candida parapsilosis"},
 {aId:"q3tZrUEM2k1", aName:"Candida pararugosa - AW",	oId:"Dy5HaZTpFni", oName:"Candida pararugosa"},
 {aId:"PM1KZqzLWUB", aName:"Candida pelliculosa - AW",	oId:"MJQEOmUzffr", oName:"Candida pelliculosa"},
 {aId:"S0pBBB60rtZ", aName:"Candida rugosa - AW",	oId:"J3NQNoWBljN", oName:"Candida rugosa"},
 {aId:"vFnWOvUWLzL", aName:"Candida tropicalis - AW",	oId:"INLI7NuGyQr", oName:"Candida tropicalis"},
 {aId:"cXbgLMRNPaI", aName:"Candida utilis - AW",	oId:"w3g4l2KTcPg", oName:"Candida utilis"},
 {aId:"vFUHShuN6XM", aName:"Candida vishwanathii - AW",	oId:"upIQDsLIJzj", oName:"Candida vishwanathii"},
 {aId:"AEK43ptWFtd", aName:"Citrobacter freundii - AW",	oId:"mcaCZXuV5D4", oName:"Citrobacter freundii"},
 {aId:"dAY0iofyJ5P", aName:"Citrobacter koseri - AW",	oId:"NFudkhOso6I", oName:"Citrobacter koseri"},
 {aId:"O58GB3w5pSG", aName:"Citrobacter spp. - AW",	oId:"gJznP3m2NRE", oName:"Citrobacter spp."},
 {aId:"bezv2JmxwtN", aName:"Clostridium difficile - AW",	oId:"VMxNF5iK8dS", oName:"Clostridium difficile"},
 {aId:"YSQRSZML10J", aName:"Cryptococcus neoformans - AW",	oId:"dpmZcGHVWZB", oName:"Cryptococcus neoformans"},
 {aId:"KJdAzmnZXz9", aName:"Cryptococcus neoformans var gattii - AW",	oId:"z5caDJJZJ1j", oName:"Cryptococcus neoformans var gattii"},
 {aId:"UElhtmideWI", aName:"Cryptococcus neoformans var grubii - AW",	oId:"JAoSDpqpkyi", oName:"Cryptococcus neoformans var grubii"},
 {aId:"NuiKZ0JL5QG", aName:"Debaromyces hansenii - AW",	oId:"IUBUzZPxGrF", oName:"Debaromyces hansenii"},
 {aId:"UInZjGzT7BF", aName:"Edwardsiella sp - AW",	oId:"bP0L5pKSRY7", oName:"Edwardsiella sp"},
 {aId:"EhndGcxznc2", aName:"Enterobacter aerogenes - AW",	oId:"RLe066CQyGe", oName:"Enterobacter aerogenes"},
 {aId:"BPRb3TfWPR4", aName:"Enterobacter cloacae - AW",	oId:"vDLo6oLqDuY", oName:"Enterobacter cloacae"},
 {aId:"F7ByhOzq7XL", aName:"Enterobacter spp. - AW",	oId:"VF1W4Ya1A1T", oName:"Enterobacter spp."},
 {aId:"ZQozYn8h20C", aName:"Enterococcus faecalis - AW",	oId:"Wqmy4Ele0Al", oName:"Enterococcus faecalis"},
 {aId:"GKwAZ5MAdsJ", aName:"Enterococcus faecium - AW",	oId:"eP8lKHcKaXC", oName:"Enterococcus faecium"},
 {aId:"HpzftJ0ijtI", aName:"Enterococcus spp. - AW",	oId:"L7B2ptwmDO9", oName:"Enterococcus spp."},
 {aId:"ggvfkXMlUSn", aName:"Escherichia coli - AW",	oId:"oeTx5HoZdl8", oName:"Escherichia coli"},
 {aId:"VXtu0Aio3oM", aName:"Escherichia coli Diarrhoeagenic - AW",	oId:"cRRwk1KUwKG", oName:"Escherichia coli Diarrhoeagenic"},
 {aId:"ckMJbclKQ6z", aName:"Hafnia alvei - AW",	oId:"vsXRwL9otSn", oName:"Hafnia alvei"},
 {aId:"dyjt1sRpMDl", aName:"Klebsiella oxytoca - AW",	oId:"k0F3u9qeeQH", oName:"Klebsiella oxytoca"},
 {aId:"COuXhtgQIlJ", aName:"Klebsiella pneumoniae - AW",	oId:"zAI1KUCGWPu", oName:"Klebsiella pneumoniae"},
 {aId:"O8Q2IkG1p5S", aName:"Klebsiella spp. - AW",	oId:"xJP6r1TrmGL", oName:"Klebsiella spp."},
 {aId:"V33xVlNLCo3", aName:"Kodamaea ohmeri - AW",	oId:"t4KKsLSFAp2", oName:"Kodamaea ohmeri"},
 {aId:"Jfmk3bryFLW", aName:"Lichtheimia spp. - AW",	oId:"H5K1W8Q1zeE", oName:"Lichtheimia spp."},
 {aId:"OEj1QLLyJmP", aName:"Morganella morganii - AW",	oId:"NKNmuaR8s2N", oName:"Morganella morganii"},
 {aId:"qolJyedjNyV", aName:"Mucor spp. - AW",	oId:"tqvokkL4TJf", oName:"Mucor spp."},
 {aId:"Q51fQRluXGY", aName:"Non Candida albicans - AW",	oId:"zbTL4RrXNq5", oName:"Non Candida albicans"},
 {aId:"aegDBLFZAOZ", aName:"Other fungal spp. - AW",	oId:"rAC7CcnPU9r", oName:"Other fungal spp."},
 {aId:"hbpsOjIFLfE", aName:"Pichia fabianii - AW",	oId:"wuXQOZxz9El", oName:"Pichia fabianii"},
 {aId:"FGwkcnu2i9h", aName:"Pichia jadinii - AW",	oId:"vSFbuVNkmOi", oName:"Pichia jadinii"},
 {aId:"yU3ZpCkaE0b", aName:"Pichia kudriavzevii - AW",	oId:"gxTCG0Vpcps", oName:"Pichia kudriavzevii"},
 {aId:"ETqr60goVt4", aName:"Plesiomonas shigelloides - AW",	oId:"w5xXSuQ9Rkp", oName:"Plesiomonas shigelloides"},
 {aId:"QpWZwkJ7srQ", aName:"Proteus mirabilis - AW",	oId:"ywm2iro8c5Z", oName:"Proteus mirabilis"},
 {aId:"kwPpy5EyYml", aName:"Proteus vulgaris - AW",	oId:"auXNqzoMcQn", oName:"Proteus vulgaris"},
 {aId:"mzvDl5wnC5F", aName:"Providencia rettgeri - AW",	oId:"NbBdhKEcCUV", oName:"Providencia rettgeri"},
 {aId:"ifwjspVINPg", aName:"Providencia sp. - AW",	oId:"BgyqycBiUIR 22 	Providencia sp."},
 {aId:"Fyj9ULZ0Kfv", aName:"Providencia stuartii - AW",	oId:"yag0FZhCZfZ", oName:"Providencia stuartii"},
 {aId:"C3FmGvHur8C", aName:"Pseudomonas aeruginosa - AW",	oId:"jeS639ZOW6b", oName:"Pseudomonas aeruginosa"},
 {aId:"NaUmlwCFPWg", aName:"Pseudomonas spp. - AW",	oId:"n0wFL3n68aa", oName:"Pseudomonas spp."},
 {aId:"LlfWmDl2if2", aName:"Pseudozyma aphidis - AW",	oId:"PZWQcSkafCq", oName:"Pseudozyma aphidis"},
 {aId:"XaKcqHOEVRV", aName:"Pseudozyma churashimaensis - AW",	oId:"uv4t28QJdRR", oName:"Pseudozyma churashimaensis"},
 {aId:"TCVvUtCNTJT", aName:"Rhizopus homothallicus - AW",	oId:"vN0qlfKHJYv", oName:"Rhizopus homothallicus"},
 {aId:"IuURhw0Sp4Z", aName:"Rhizopus microsporus - AW",	oId:"hErNR35JuIv", oName:"Rhizopus microsporus"},
 {aId:"WWVmBfG7QWS", aName:"Rhizopus oryzae - AW",	oId:"rHgmoWaULpH", oName:"Rhizopus oryzae"},
 {aId:"tUdPmA2uu1E", aName:"Rhizopus spp. - AW",	oId:"mSBKBPedoDh", oName:"Rhizopus spp."},
 {aId:"pjVfiMhxMd7", aName:"Rhodotorula glutinis - AW",	oId:"mEdjfTj4PaN", oName:"Rhodotorula glutinis"},
 {aId:"iflbA3dvhTM", aName:"Rhodotorula mucilaginosa - AW",	oId:"uhjMye9Btov", oName:"Rhodotorula mucilaginosa"},
 {aId:"KWconnjgQf1", aName:"Saccharomyces cerevisiae - AW",	oId:"np2ZmJwhlkT", oName:"Saccharomyces cerevisiae"},
 {aId:"d0S5pG6DqCx", aName:"Salmonella Enteritidis - AW",	oId:"dtneHlF0wVU", oName:"Salmonella Enteritidis"},
 {aId:"XYtQA1O1qFM", aName:"Salmonella Heidelberg - AW",	oId:"WWZs9GUDdHn", oName:"Salmonella Heidelberg"},
 {aId:"g6uXohCSAkO", aName:"Salmonella Newport - AW",	oId:"Ovy5Po3M3md", oName:"Salmonella Newport"},
 {aId:"h34HlfCnDGE", aName:"Salmonella Paratyphi A - AW",	oId:"KozFhmkpUhA", oName:"Salmonella Paratyphi A"},
 {aId:"YXsJQIn7skJ", aName:"Salmonella spp. - AW",	oId:"opRQ63g58sm", oName:"Salmonella spp."},
 {aId:"cmQJIbsB2r2", aName:"Salmonella spp. Faecal - AW",	oId:"hpydGEvRhMJ", oName:"Salmonella spp. Faecal"},
 {aId:"OJXk1P2zWuy", aName:"Salmonella Typhi - AW",	oId:"yoqq0WHeEnQ", oName:"Salmonella Typhi"},
 {aId:"kZOPWQozUgl", aName:"Salmonella Typhimurium Faecal - AW",oId:"ZUUGtqgpqgU", oName:"Salmonella Typhimurium Faecal"},
 {aId:"M8O4DvoghWP", aName:"Serratia marcescens - AW",	oId:"Lu5yq1rIyOR", oName:"Serratia marcescens"},
 {aId:"jqcBT71UxLY", aName:"Shigella boydii - AW",	oId:"jAepVDlhPEn", oName:"Shigella boydii"},
 {aId:"AcebBUNjOXO", aName:"Shigella dysenteriae - AW",	oId:"jaRrqCnI932", oName:"Shigella dysenteriae"},
 {aId:"OhxWd5hStJ7", aName:"Shigella flexneri - AW",	oId:"zWaK3RahvGp", oName:"Shigella flexneri"},
 {aId:"EA1WIaAS8Si", aName:"Shigella sonnei - AW",	oId:"YIHMCA8ExQr", oName:"Shigella sonnei"},
 {aId:"FjoPunG4Lgz", aName:"Shigella spp. - AW",	oId:"BptjMCxkGHI", oName:"Shigella spp."},
 {aId:"gaJrZCxLlby", aName:"Staphylococcus aureus - AW",	oId:"haO3du80dTz", oName:"Staphylococcus aureus"},
 {aId:"xBTE2ewnDWL", aName:"Staphylococcus epidermidis - AW",	oId:"gsRbyPA2ETG", oName:"Staphylococcus epidermidis"},
 {aId:"XjwwaGTJFfz", aName:"Staphylococcus haemolyticus - AW",	oId:"hMEn8cxOlN7", oName:"Staphylococcus haemolyticus"},
 {aId:"uFxANdU12dM", aName:"Staphylococcus hominis - AW",	oId:"XbYGDUr8ls2", oName:"Staphylococcus hominis"},
 {aId:"LSf9XrX2FgV", aName:"Staphylococcus lugdunensis - AW",	oId:"TRgLeuMACtt", oName:"Staphylococcus lugdunensis"},
 {aId:"BwdW5D76Ypu", aName:"Staphylococcus pseudointermedius - AW",	oId:"g6wX3liurW8", oName:"Staphylococcus pseudointermedius"},
 {aId:"vRYnUohoi3b", aName:"Staphylococcus saprophyticus - AW",	oId:"jUJ6BTXPBRS", oName:"Staphylococcus saprophyticus"},
 {aId:"l5iU7pJ0M4H", aName:"Staphylococcus spp. - AW",	oId:"h7pnFefA1FW", oName:"Staphylococcus spp."},
 {aId:"KTw8Yu0PVrA", aName:"Stenotrophomonas maltophilia - AW",	oId:"gt9dMPr4e1X", oName:"Stenotrophomonas maltophilia"},
 {aId:"DFiUXHv45DB", aName:"Streptococcus, beta-haem. Group B - AW",	oId:"StDYA5rCGzm", oName:"Streptococcus, beta-haem. Group B"},
 {aId:"Yua65xcwk9I", aName:"Streptococcus pneumoniae - AW",	oId:"njAw2Yz8FXQ", oName:"Streptococcus pneumoniae"},
 {aId:"bvMTX0xWq73", aName:"Trichophyton mentagrophytes - AW",	oId:"qGrgqXNmY6F", oName:"Trichophyton mentagrophytes"},
 {aId:"b2e44cscYXb", aName:"Trichosporon asahii - AW",	oId:"k2QX2mwzeiN", oName:"Trichosporon asahii"},
 {aId:"GVKK9NPyGY0", aName:"Trichosporon mucoides - AW",	oId:"bXVTDmmMjKl", oName:"Trichosporon mucoides"},
 {aId:"B6KKihmwewt", aName:"Vibrio cholerae - AW",	oId:"NyzmVyllwxZ", oName:"Vibrio cholerae"},
 {aId:"Czino91qni7", aName:"Vibrio parahaemolyticus - AW",	oId:"QsOVM8yoy00", oName:"Vibrio parahaemolyticus"},
 {aId:"ophA407n58g", aName:"Vibrio spp. - AW",	oId:"uWC1uTbh1t0", oName:"Vibrio spp."},
 {aId:"qGm0NuUiJmE", aName:"Yersinia enterocolitica - AW",	oId:"IQdO5CMfs9a", oName:"Yersinia enterocolitica"}
]
    $('#table').hide()
    $('#loader').hide()
    $('#print').hide()
    var url = '../api/29/categories/uoGPDb7NKXC.json?fields=categoryOptions[displayName,id]&paging=false';
    $.get(url, function (json) {
        for (let opt of json.categoryOptions) {
            let select = document.getElementById('department')
            select.options[select.options.length] = new Option(opt.displayName, JSON.stringify(opt));
        }
    })
   let url1 ='../api/29/categoryOptionGroupSets/AapI9odDnk2.json?paging=false&fields=categoryOptionGroups[name,id]'
   $.get(url1, function (json) {
        for (let opt of json.categoryOptionGroups) {
            let select = document.getElementById('sampleSelection')
            select.options[select.options.length] = new Option(opt.name, JSON.stringify(opt));
        }
    })

    let year = new Date().getFullYear()
      for( let i =1; i<10; i++ ){
             let select = document.getElementById('year')
            select.options[select.options.length] = new Option(year, year);
            year =year-1
      }

    function generateReport() {
        $('#loader').show()
        $('#print').show()
        let dpName = document.getElementById("department").value
        let selectedSample = document.getElementById('sampleSelection').value
        let year = document.getElementById("year").value
        let month = document.getElementById("month").value
        var period = year.concat(month)
        if (dpName === '' || dpName === 'Select Department' || selectedSample === '' || selectedSample === 'Select Sample') {
            alert('Select Department and sample correctly')
           $('#loader').hide()
            return false;
        } else {
              let dp = JSON.parse(dpName)
              let department = dp.displayName
              var dpId = dp.id;
              let sampleSelected = JSON.parse(selectedSample)
              var sampleName = sampleSelected.name
              var sampleId = sampleSelected.id 
            $('.selectedDepartment').text(department)
            $('.sample').text(sampleName)
           let url12 = "../api/29/analytics.json?dimension=uoGPDb7NKXC:"+dpId+"&dimension=BB34TO1MsbB:o2KJuGuyUQ8;Ci3YWzweFIZ;DlD3fIWinjJ;PDkTBvpXxDL;hUsQwwsNkYs;EixFFe8U26O;fkwG2huZCzS;Evx7exBNN1A&dimension=AapI9odDnk2:"+sampleId+"&dimension=o3f27RemB0u:uafU3z8FI5k;A9lhvAzBHWB;cRTGleVcSot;AG1SqURA7ZY;S4s7CQ6jvEp;tvrmLWyKEfa;CHxxE1FWcJt;ut6SBS9f8d7;AKir7rABOFw;YTqzjOxGLsK;jwoozvFjwxH;pL3dCGW5GtT;PTX6rtu1UgD;mRPpjB3Edii;AlxZqKXI17J;UZrg4Q4udS9;BEVbXVVhDCZ;r44xE28T8Xs;VMIRSc5Wqfw;L5TicdN8XbU;KU322WNZVAx;xJmiytz4Je3;uDPQOTBt5tr;FLU2xujN3EE;MBnkOJsirWk;RqKmKtJJUzN;IVipan1rQME;D5ccm9bfeGR;LHfThMHy709;dczhpmYFqzi;Jf4NWtBtmld;be2xD7h9jQ7;VnQecHUo9iq;zP9f8mjR4bH;GEjROCGRdBK;uvLGlNO6qNF;ijkNLCXyyHv;JvAzvm9YD2v;mzFPJIqz4OP;AAHcICnhiSV;w3G8Zh8VrOf;D6tqkQl3eSo;d7KOQSOEVRs;XcHYZ0B5ngC;TVHmMkJ1r7u;lVWvJc57RQe;WlPLm82Jzs7;zn2Juh5xDFy;CReS4iT7FVy;yKAKER11ABp;RvxbV2SYPbr;WdjbrHqLEtI;iV0RRHElQlL;SjrgaDJCg9H;twtctjeWQx4;D3VjC2F63Hh;oaP95BtU2mN;MsVMhZ89xUu;SfCZriRGdUQ;ARgcVFsmG6U;anYRHxr9bTC;vmS4xy4l4Or;pgR3EnL82be;dgfNQgAV8To;ZAqVX035fFB;c5P5vdayuB2;gWs2HKwumAL;WF3qcs1UJrc;bYtSCWtlwAU;qk11Fc8X1C0;cT1L17B86AC;ZpQsajaflnv;D5qKlljklBk;ZXVC82NqKgi;SpRBbSCmsGp;WZePItBM9Mb;kU8yb0OOcNs;XYwAJU1Uv79;ER5mUO5NaEZ;FXdYH8aZtVo;WMiY06XquPC;iQ79W3m4guP;OAMRa8ilRoK;aOVW6i2R1Hx;KQTPbeAuFBL;WucG2xpnuST;UnEkcXjNdVx;fZqGEUb18ra;enNnkS1O2Gb;rRg6JUNpg5j;oZAdCPK0Ywa;FnNq5XTWW1q;fOYysS1VqzQ;fQwFi3COlEa;QwQZlI5kwxD;BeJEQIXsWqx;iB4l1PiXVER;pgsmsVEKGqK;RhvcqFKWxDu&dimension=OeTywbgqYtV:IBJVjPuQjM4;oMG1kpCFtzS;OedC9yr4wYk&dimension=dx:I5oNT6aYZS9;r7bjTxLIgCq;bxW34t0xz0s;MnxsHJlTc55;gFW3bixpypH;v7Ukm9e3cF6;a0g4n2SCgjW;GnBn8lgUiZL;Jal7j67OZZX;uEbxkzrPqkr;evNo2gYJZ6N;rhTgkToqMHn;kYNdjBnk0s8;mOven4FhQJY;vrXfJKjFbJA;WDysZqtpxVY;RnU13XIKI3O;wHVPM4kqDJj;ZdtNG420QNw;L9MVubYrzA8;ZkZVWTyXA4q;GCiHFD396jt;rfEH2kk0QYY;piFxDvwngAX;zC9fxkjGwHs;d2gR2cFHxbI;DzKR4p2l9te;t8P7m7SYWcF;EhfHdxhxF0J;xYMmjCLrQX3;q3tZrUEM2k1;PM1KZqzLWUB;S0pBBB60rtZ;vFnWOvUWLzL;cXbgLMRNPaI;vFUHShuN6XM;AEK43ptWFtd;dAY0iofyJ5P;O58GB3w5pSG;bezv2JmxwtN;YSQRSZML10J;KJdAzmnZXz9;UElhtmideWI;NuiKZ0JL5QG;UInZjGzT7BF;EhndGcxznc2;BPRb3TfWPR4;F7ByhOzq7XL;ZQozYn8h20C;GKwAZ5MAdsJ;HpzftJ0ijtI;ggvfkXMlUSn;VXtu0Aio3oM;ckMJbclKQ6z;dyjt1sRpMDl;COuXhtgQIlJ;O8Q2IkG1p5S;V33xVlNLCo3;Jfmk3bryFLW;OEj1QLLyJmP;qolJyedjNyV;Q51fQRluXGY;aegDBLFZAOZ;hbpsOjIFLfE;FGwkcnu2i9h;yU3ZpCkaE0b;ETqr60goVt4;QpWZwkJ7srQ;kwPpy5EyYml;mzvDl5wnC5F;ifwjspVINPg;Fyj9ULZ0Kfv;C3FmGvHur8C;NaUmlwCFPWg;LlfWmDl2if2;XaKcqHOEVRV;TCVvUtCNTJT;IuURhw0Sp4Z;WWVmBfG7QWS;tUdPmA2uu1E;pjVfiMhxMd7;iflbA3dvhTM;KWconnjgQf1;d0S5pG6DqCx;XYtQA1O1qFM;g6uXohCSAkO;h34HlfCnDGE;OJXk1P2zWuy;kZOPWQozUgl;YXsJQIn7skJ;cmQJIbsB2r2;M8O4DvoghWP;jqcBT71UxLY;AcebBUNjOXO;OhxWd5hStJ7;EA1WIaAS8Si;FjoPunG4Lgz;gaJrZCxLlby;xBTE2ewnDWL;XjwwaGTJFfz;uFxANdU12dM;LSf9XrX2FgV;BwdW5D76Ypu;vRYnUohoi3b;l5iU7pJ0M4H;KTw8Yu0PVrA;Yua65xcwk9I;DFiUXHv45DB;bvMTX0xWq73;b2e44cscYXb;GVKK9NPyGY0;B6KKihmwewt;Czino91qni7;ophA407n58g;qGm0NuUiJmE&filter=ou:bLfOUtl4eZd&filter=pe:"+period+"&displayProperty=SHORTNAME"
           $.get(url12, function (jsonRes) {
                var  antiBiotics = jsonRes.metaData.dimensions.o3f27RemB0u
                var  items = jsonRes.metaData.items
                var dx1 = jsonRes.metaData.dimensions.dx
                var Ris = jsonRes.metaData.dimensions.OeTywbgqYtV
            var url2 = '../api/29/analytics.json?dimension=BB34TO1MsbB:o2KJuGuyUQ8;Ci3YWzweFIZ;DlD3fIWinjJ;PDkTBvpXxDL;hUsQwwsNkYs;EixFFe8U26O;fkwG2huZCzS;Evx7exBNN1A&dimension=uoGPDb7NKXC:'+dpId+'&dimension=AapI9odDnk2:nOCKwu6CrWi;fmErXlxWNJe;rsM7PcWW6at;Z8WLvfVppGO;MFQMoYwwUWU;TnI52tKWlV3&dimension=dx:vcAIYI5yREO;wZ7LAmgPWWw;X7iypNUfSJm;gmn116uDf7s;e1IUxzo6g1J;pTCUC4aW6Km;F8XIhKNG5vJ;mYJjJmdJOqw;tXD8XFWShLu;LvZ43nVFRo0;pK7hHbAJK7b;oeTx5HoZdl8;w3g4l2KTcPg;VF1W4Ya1A1T;M2s0qSrhJej;j4pTAIz3Cy8;jIdJQTPkQeL;Rz3lMI7fRbS;kBLWWk3jd42;ULu7XaTIDTS;OXW4u7hVvXS;uca3pIEzbiX;ZF5OKh2kZRQ;K6TrparggHU;BZNcL8jeUPf;wkfpknYuhkM;tQ85XfQoxDc;jRXpq7vJUXu;mzRsc86gEoc;fBUrCfm0YEy;dSisvVZ4d59;FAwYniCYfBF;acAD5WuxgA6;Dy5HaZTpFni;MJQEOmUzffr;J3NQNoWBljN;INLI7NuGyQr;upIQDsLIJzj;mcaCZXuV5D4;NFudkhOso6I;gJznP3m2NRE;VMxNF5iK8dS;dpmZcGHVWZB;z5caDJJZJ1j;JAoSDpqpkyi;IUBUzZPxGrF;bP0L5pKSRY7;RLe066CQyGe;vDLo6oLqDuY;Wqmy4Ele0Al;eP8lKHcKaXC;L7B2ptwmDO9;cRRwk1KUwKG;vsXRwL9otSn;k0F3u9qeeQH;zAI1KUCGWPu;xJP6r1TrmGL;t4KKsLSFAp2;H5K1W8Q1zeE;NKNmuaR8s2N;tqvokkL4TJf;zbTL4RrXNq5;rAC7CcnPU9r;wuXQOZxz9El;vSFbuVNkmOi;gxTCG0Vpcps;w5xXSuQ9Rkp;ywm2iro8c5Z;auXNqzoMcQn;NbBdhKEcCUV;BgyqycBiUIR;yag0FZhCZfZ;jeS639ZOW6b;n0wFL3n68aa;PZWQcSkafCq;uv4t28QJdRR;vN0qlfKHJYv;hErNR35JuIv;rHgmoWaULpH;mSBKBPedoDh;mEdjfTj4PaN;uhjMye9Btov;np2ZmJwhlkT;dtneHlF0wVU;WWZs9GUDdHn;Ovy5Po3M3md;KozFhmkpUhA;yoqq0WHeEnQ;ZUUGtqgpqgU;opRQ63g58sm;hpydGEvRhMJ;Lu5yq1rIyOR;jAepVDlhPEn;jaRrqCnI932;zWaK3RahvGp;YIHMCA8ExQr;BptjMCxkGHI;haO3du80dTz;gsRbyPA2ETG;hMEn8cxOlN7;XbYGDUr8ls2;TRgLeuMACtt;g6wX3liurW8;jUJ6BTXPBRS;h7pnFefA1FW;gt9dMPr4e1X;njAw2Yz8FXQ;StDYA5rCGzm;qGrgqXNmY6F;k2QX2mwzeiN;bXVTDmmMjKl;NyzmVyllwxZ;QsOVM8yoy00;uWC1uTbh1t0;IQdO5CMfs9a&filter=ou:bLfOUtl4eZd&filter=pe:'+period+'&displayProperty=SHORTNAME&outputIdScheme=UID'
            $.get(url2, function (json) {
               $('#table').show()
                let obj = {}
                let data = {}
                var dataArr = [], sampleArr = [], locationArr = [], antiBioticsArr = [], dxArr=[], risArr=[];
                var dx = json.metaData.dimensions.dx
                var dp = json.metaData.dimensions.uoGPDb7NKXC
                var sample = json.metaData.dimensions.AapI9odDnk2
                var locations = json.metaData.dimensions.BB34TO1MsbB
                var gObj = { department: {} }
                var gObj1 = { department: { sample: {}} }
                var jsonObj = json.metaData.items
                for (let d of dx) {
                    let o = {}
                    for (let de in jsonObj) {
                        if (d === de) {
                            o['name'] = jsonObj[de].name
                            o['id'] = d
                            dataArr.push(o)
                        }
                    }
                }
                for (let d of dx1) {
                    let o = {}
                    for (let de in items) {
                        if (d === de) {
                            o['name'] = items[de].name
                            o['id'] = d
                            dxArr.push(o)
                        }
                    }
                }
                for (let d of Ris) {
                    let o = {}
                    for (let de in items) {
                        if (d === de) {
                            o['name'] = items[de].name
                            o['id'] = d
                            risArr.push(o)
                        }
                    }
                }
                for (let s of sample) {
                    let o = {}
                    for (let pro in jsonObj) {
                        if (s === pro) {
                            o['name'] = jsonObj[pro].name
                            o['id'] = s
                            sampleArr.push(o)
                        }
                    }
                }
                for (let d of locations) {
                    let o = {}
                    for (let de in jsonObj) {
                        if (d === de) {
                            o['name'] = jsonObj[de].name
                            o['id'] = d
                            locationArr.push(o)
                        }
                    }
                } 
                for (let d of antiBiotics) {
                    let o = {}
                    for (let de in items) {
                        if (d === de) {
                            o['name'] = items[de].name
                            o['id'] = d
                            antiBioticsArr.push(o)
                        }
                    }
                }                             
                for (let sample of sampleArr) {
                    gObj.department[sample.name] = {}
                    for (let location of locationArr) {
                        gObj.department[sample.name][location.name] = []
                        let o = {}
                        for (let data of json.rows) {
                            if (sample.id == data['3'] && location.id == data['1']) {
                                for (let d of dataArr) {
                                    if (d.id === data['0']) {
                                        o[d.name] = Number(data["4"])
                                        gObj.department[sample.name][location.name].shift()
                                        gObj.department[sample.name][location.name].push(o)
                                    }
                                }
                            }
                        }
                    }
                }
                    for( let d of dxArr){
                        gObj1.department.sample[d.name] = {}
                        for (let location of locationArr) {
                        gObj1.department.sample[d.name][location.name] = []
                        for( let anti of antiBioticsArr){
                             let o = {}
                             o[anti.name] ={}
                             let o1 ={}
                             o1['totalResistant']=0
                             o1['totalSusceptible']=0
                             for( let ris of risArr){
                                 for (let data of jsonRes.rows) {
                                   if(d.id == data['0'] && location.id == data['2']  && anti.id == data['4'] && ris.id == data['5']){
                                    o1[ris.name] =Number(data['6'])
                                 }
                               }
                             }
                             o[anti.name] =o1
                             o1['name']=anti.name
                             gObj1.department.sample[d.name][location.name].push(o)
                        }
                     }
                    }
                    var takeObj = {}
                    for (let dx of dxArr) {
                        takeObj[dx.name] = []
                         for (let d of antiBioticsArr) {
                          let no = {}
                           no['name'] = d.name
                            no['total'] = 0
                        for (let location of locationArr) {
                            no[location.name] = ''
                        }
                        takeObj[dx.name].push(no)
                       }
                      }
                      var oo ={}
                     for (let pro in gObj1.department.sample) {
                           oo[pro] ={}
                           var antiData =[]
                            for ( let anti of antiBioticsArr){
                                let antiobj = {
                                Resistant:0,
                                Susceptible:0,
                                totalResistant:0,
                                totalSusceptible:0,
                            }
                                antiobj["name"]= anti.name 
                                antiData.push(antiobj)
                            }
                            for (let pro1 in gObj1.department.sample[pro]) {
                                for( let anti of antiData){
                                for (let d of gObj1.department.sample[pro][pro1]){
                                    for( let pro in d){
                                        if(anti.name === pro){
                                        let l = d[pro]
                                            if(l.Resistant) anti["totalResistant"] += l.Resistant
                                            if(l.Susceptible) anti["totalSusceptible"] += l.Susceptible
                                        }
                                    }
                                }
                            }
                       }

                       let obj ={
                        mostResistant:antiData.sort((a, b) => (a.totalResistant < b.totalResistant) ? 1 : ((b.totalResistant < a.totalResistant) ? -1 : 0)).slice(0, 3),
                        mostSusceptible:antiData.sort((a, b) => (a.totalSusceptible < b.totalSusceptible) ? 1 : ((b.totalSusceptible < a.totalSusceptible) ? -1 : 0)).slice(0, 3)
                       }
                       oo[pro]=obj
                    }


                    /// ookk 
                    var ooo ={}
                     for (let pro in gObj1.department.sample) {
                        ooo[pro] ={}
                           var antiData =[]
                            for ( let anti of antiBioticsArr){
                                let antiobj = {
                                Resistant:0,
                                Susceptible:0,
                                totalResistant:0,
                                totalSusceptible:0,
                            }
                                antiobj["name"]= anti.name 
                                antiData.push(antiobj)
                            }
                            for (let pro1 in gObj1.department.sample[pro]) {
                                for( let anti of antiData){
                                for (let d of gObj1.department.sample[pro][pro1]){
                                    for( let pro in d){
                                        if(anti.name === pro){
                                        let l = d[pro]
                                            if(l.Susceptible) anti["totalSusceptible"] += l.Susceptible
                                        }
                                    }
                                }
                            }
                       }

                       let obj ={
                        mostSusceptible:antiData.sort((a, b) => (a.totalSusceptible < b.totalSusceptible) ? 1 : ((b.totalSusceptible < a.totalSusceptible) ? -1 : 0)).slice(0, 3)
                       }
                       ooo[pro]=obj
                    }
                    var oo1 ={}
                            for (let pro in gObj1.department.sample) {
                                oo1[pro] = {}
                                for (let pro1 in gObj1.department.sample[pro]) {
                                 oo1[pro][pro1] = {}
                                 let mRis = gObj1.department.sample[pro][pro1].filter(obj =>{
                                    for( let o in obj){
                                        for(let oPro in oo){
                                           for(let mostR of oo[oPro].mostResistant){
                                            if(mostR.name == o){
                                           return obj
                                        }
                                       }
                                      }
                                     }
                                 })
                                  oo1[pro][pro1]=mRis     
                                } 
                           }

                           // for sus
                           var susObj ={}
                            for (let pro in gObj1.department.sample) {
                                susObj[pro] = {}
                                for (let pro1 in gObj1.department.sample[pro]) {
                                    susObj[pro][pro1] = {}
                                 let mSus = gObj1.department.sample[pro][pro1].filter(obj =>{
                                    for( let o in obj){
                                        for(let oPro in ooo){
                                           for(let mostR of ooo[oPro].mostSusceptible){
                                            if(mostR.name == o){
                                           return obj
                                        }
                                       }
                                      }
                                     }
                                 })
                                 susObj[pro][pro1]=mSus     
                                } 
                           }
                        let sobj={}
                       for(let p in susObj){
                            sobj[p]=[]
                            for(let anti of antiBioticsArr){
                                let o ={}
                                o['name']=anti.name
                                o['total']=0
                                for(let l of locationArr){
                                   o[l.name]=''
                                }
                                sobj[p].push(o)
                            }
                       }
                       for(let obj in susObj){
                      for(let obj1 in susObj[obj]){
                             makeObj2(obj,obj1, susObj[obj][obj1])
                          }
                        }
                        function makeObj2(d, l, data ){ 
                       for(let obj of data){
                           for( let p in obj){
                               for( let ad of sobj[d]){
                                   if( p == ad.name ){
                                       for(let pp in ad){
                                        if(l == pp){
                                            if(obj[p].Susceptible) ad[pp]= obj[p].Susceptible
                                            if(obj[p].Susceptible) ad["total"]= obj[p].Susceptible
                                          }
                                       }
                                   }
                                  }
                           }
                       }
                    }

                       let eobj={}
                       for(let p in oo1){
                           eobj[p]=[]
                            for(let anti of antiBioticsArr){
                                let o ={}
                                o['name']=anti.name
                                o['total']=0
                                for(let l of locationArr){
                                   o[l.name]=''
                                }
                                eobj[p].push(o)
                            }
                       }
                      for(let obj in oo1){
                      for(let obj1 in oo1[obj]){
                             makeObj1(obj,obj1, oo1[obj][obj1])
                          }
                        }
                   function makeObj1(d, l, data ){ 
                       for(let obj of data){
                           for( let p in obj){
                               for( let ad of eobj[d]){
                                   if( p == ad.name ){
                                       for(let pp in ad){
                                        if(l == pp){
                                            if(obj[p].Resistant) ad[pp]= obj[p].Resistant
                                            if(obj[p].Resistant) ad["total"]= obj[p].Resistant
                                        }
                                       }
                                   }
                                  }
                           }
                       }
                    }
                var teckObj = {}
                for (let sample of sampleArr) {
                    teckObj[sample.name] = []
                    for (let d of dataArr) {
                        let no = {}
                        no['name'] = d.name
                        no['total'] = 0
                        for (let location of locationArr) {
                            no[location.name] = ''
                        }
                        teckObj[sample.name].push(no)
                    }
                }
                for (let pro in gObj.department) {
                    for (let pro1 in gObj.department[pro]) {
                        let l = gObj.department[pro][pro1]['0']
                        makeObj(pro, pro1, l)
                    }
                }
                function makeObj(s, l, d) {
                    let myobj = {}
                    myobj[s] = {}
                    for (let p in d) {
                        for (let e of teckObj[s]) {
                            if (p == e.name) {
                                e[l] = d[p]
                                e["total"] += Number(d[p])
                            }
                        }
                    }
                }
                for (let sample of sampleArr) {
                    let arr = teckObj[sample.name].sort((a, b) => (a.total < b.total) ? 1 : ((b.total < a.total) ? -1 : 0)).slice(0, 3)
                      printData(sample, arr)
                }
                function printData(sample, arr){
                    $('#loader').hide()
                    if(sample.name === sampleName){
                       $('#og1').text(arr[0].name)
                       $('#og2').text(arr[1].name)
                       $('#og3').text(arr[2].name)
                       let n = arr[0].name +'- AW'
                       let n1 = arr[1].name +'- AW'
                       let n2 = arr[2].name +'- AW'
                       $('#table1').find("tbody").empty()
                       $('#table2').find("tbody").empty()
                       $('#table3').find("tbody").empty()
                       let i =1;
                       let newarr = eobj[n].map(ele =>{
                           let tot =0
                           tot = Number(ele.OPD) + Number(ele.ICU) + Number(ele.NICU) + Number(ele.Ward) + Number(ele.CCU) + Number(ele['Burn Unit']) + Number(ele.PICU) + Number(ele.Unknown) 
                           ele['tot']= tot
                           return ele
                       })
                       let newarr1 = eobj[n1].map(ele =>{
                           let tot =0
                           tot = Number(ele.OPD) + Number(ele.ICU) + Number(ele.NICU) + Number(ele.Ward) + Number(ele.CCU) + Number(ele['Burn Unit']) + Number(ele.PICU) + Number(ele.Unknown) 
                           ele['tot']= tot
                           return ele
                       })
                       let newarr2 = eobj[n2].map(ele =>{
                           let tot =0
                           tot = Number(ele.OPD) + Number(ele.ICU) + Number(ele.NICU) + Number(ele.Ward) + Number(ele.CCU) + Number(ele['Burn Unit']) + Number(ele.PICU) + Number(ele.Unknown) 
                           ele['tot']= tot
                           return ele
                       })
                       let newarr10 = sobj[n].map(ele =>{
                           let tot =0
                           tot = Number(ele.OPD) + Number(ele.ICU) + Number(ele.NICU) + Number(ele.Ward) + Number(ele.CCU) + Number(ele['Burn Unit']) + Number(ele.PICU) + Number(ele.Unknown) 
                           ele['tot']= tot
                           return ele
                       })
                       let newarr11 = sobj[n1].map(ele =>{
                           let tot =0
                           tot = Number(ele.OPD) + Number(ele.ICU) + Number(ele.NICU) + Number(ele.Ward) + Number(ele.CCU) + Number(ele['Burn Unit']) + Number(ele.PICU) + Number(ele.Unknown) 
                           ele['tot']= tot
                           return ele
                       })
                       let newarr12 = sobj[n2].map(ele =>{
                           let tot =0
                           tot = Number(ele.OPD) + Number(ele.ICU) + Number(ele.NICU) + Number(ele.Ward) + Number(ele.CCU) + Number(ele['Burn Unit']) + Number(ele.PICU) + Number(ele.Unknown) 
                           ele['tot']= tot
                           return ele
                       })
                       for(let ele of newarr.sort((a, b) => (a.tot < b.tot) ? 1 : ((b.tot < a.tot) ? -1 : 0)).slice(0,3)){
                        let totals = 0
                            totals = Number(ele.OPD) + Number(ele.ICU) + Number(ele.NICU) + Number(ele.Ward) + Number(ele.CCU) + Number(ele['Burn Unit']) + Number(ele.PICU) + Number(ele.Unknown) 
                        $('#table1').find('tbody').append(`<tr style="background-color: #4A638d">
                            <td>${i}</td>
                            <td>Most Resistant</td>
                            <td>${ele.name}</td>
                            <td>${ele.OPD}</td>
                            <td>${ele.ICU}</td>
                            <td>${ele.NICU}</td>
                            <td>${ele.Ward}</td>
                            <td>${ele.CCU}</td>
                            <td>${ele['Burn Unit']}</td>
                            <td>${ele.PICU}</td>
                            <td>${ele.Unknown}</td>
                            <td>${totals}</td>
                            </tr>`)
                            i++
                            totals=0
                         }
                         i -= i;
                         for(let ele of newarr1.sort((a, b) => (a.tot < b.tot) ? 1 : ((b.tot < a.tot) ? -1 : 0)).slice(0,3)){
                            let totals = 0
                            totals = Number(ele.OPD) + Number(ele.ICU) + Number(ele.NICU) + Number(ele.Ward) + Number(ele.CCU) + Number(ele['Burn Unit']) + Number(ele.PICU) + Number(ele.Unknown) 
                        $('#table2').find('tbody').append(`<tr style="background-color: #4A638d">
                            <td>${i+1}</td>
                            <td>Most Resistant</td>
                            <td>${ele.name}</td>
                            <td>${ele.OPD}</td>
                            <td>${ele.ICU}</td>
                            <td>${ele.NICU}</td>
                            <td>${ele.Ward}</td>
                            <td>${ele.CCU}</td>
                            <td>${ele['Burn Unit']}</td>
                            <td>${ele.PICU}</td>
                            <td>${ele.Unknown}</td>
                            <td>${totals}</td>
                            </tr>`)
                            i++
                            totals=0
                         }
                         i -= i;
                         for(let ele of newarr2.sort((a, b) => (a.tot < b.tot) ? 1 : ((b.tot < a.tot) ? -1 : 0)).slice(0,3)){
                            let totals = 0
                            totals = Number(ele.OPD) + Number(ele.ICU) + Number(ele.NICU) + Number(ele.Ward) + Number(ele.CCU) + Number(ele['Burn Unit']) + Number(ele.PICU) + Number(ele.Unknown) 
                        $('#table3').find('tbody').append(`<tr style="background-color: #4A638d">
                            <td>${i+1}</td>
                            <td>Most Resistant</td>
                            <td>${ele.name}</td>
                            <td>${ele.OPD}</td>
                            <td>${ele.ICU}</td>
                            <td>${ele.NICU}</td>
                            <td>${ele.Ward}</td>
                            <td>${ele.CCU}</td>
                            <td>${ele['Burn Unit']}</td>
                            <td>${ele.PICU}</td>
                            <td>${ele.Unknown}</td>
                            <td>${totals}</td>
                            </tr>`)
                            i++
                            totals=0
                         }
                         i -= i;
                      //   for sus
                         for(let ele of newarr10.sort((a, b) => (a.tot < b.tot) ? 1 : ((b.tot < a.tot) ? -1 : 0)).slice(0,3)){
                            let totals = 0
                            totals = Number(ele.OPD) + Number(ele.ICU) + Number(ele.NICU) + Number(ele.Ward) + Number(ele.CCU) + Number(ele['Burn Unit']) + Number(ele.PICU) + Number(ele.Unknown) 
                        $('#table1').find('tbody').append(`<tr style="background-color: lightblue">
                            <td>${i+1}</td>
                            <td>Most Sensitive</td>
                            <td>${ele.name}</td>
                            <td>${ele.OPD}</td>
                            <td>${ele.ICU}</td>
                            <td>${ele.NICU}</td>
                            <td>${ele.Ward}</td>
                            <td>${ele.CCU}</td>
                            <td>${ele['Burn Unit']}</td>
                            <td>${ele.PICU}</td>
                            <td>${ele.Unknown}</td>
                            <td>${totals}</td>
                            </tr>`)
                            i++
                            totals=0
                         }
                         i -= i;
                         for(let ele of newarr11.sort((a, b) => (a.tot < b.tot) ? 1 : ((b.tot < a.tot) ? -1 : 0)).slice(0,3)){
                            let totals = 0
                            totals = Number(ele.OPD) + Number(ele.ICU) + Number(ele.NICU) + Number(ele.Ward) + Number(ele.CCU) + Number(ele['Burn Unit']) + Number(ele.PICU) + Number(ele.Unknown) 
                        $('#table2').find('tbody').append(`<tr style="background-color: lightblue">
                            <td>${i+1}</td>
                            <td>Most Sensitive</td>
                            <td>${ele.name}</td>
                            <td>${ele.OPD}</td>
                            <td>${ele.ICU}</td>
                            <td>${ele.NICU}</td>
                            <td>${ele.Ward}</td>
                            <td>${ele.CCU}</td>
                            <td>${ele['Burn Unit']}</td>
                            <td>${ele.PICU}</td>
                            <td>${ele.Unknown}</td>
                            <td>${totals}</td>
                            </tr>`)
                            i++
                            totals=0
                         }
                         i -= i;
                         for(let ele of newarr12.sort((a, b) => (a.tot < b.tot) ? 1 : ((b.tot < a.tot) ? -1 : 0)).slice(0,3)){
                            let totals = 0
                            totals = Number(ele.OPD) + Number(ele.ICU) + Number(ele.NICU) + Number(ele.Ward) + Number(ele.CCU) + Number(ele['Burn Unit']) + Number(ele.PICU) + Number(ele.Unknown) 
                        $('#table3').find('tbody').append(`<tr style="background-color: lightblue">
                            <td>${i+1}</td>
                            <td>Most Sensitive</td>
                            <td>${ele.name}</td>
                            <td>${ele.OPD}</td>
                            <td>${ele.ICU}</td>
                            <td>${ele.NICU}</td>
                            <td>${ele.Ward}</td>
                            <td>${ele.CCU}</td>
                            <td>${ele['Burn Unit']}</td>
                            <td>${ele.PICU}</td>
                            <td>${ele.Unknown}</td>
                            <td>${totals}</td>
                            </tr>`)
                            i++
                            totals=0
                         }
                    }
                }
            })
        })
    }
    }
    function printContent(el) {
        var restorepage = document.body.innerHTML;
        var printcontent = document.getElementById(el).innerHTML;
        document.body.innerHTML = printcontent;
        window.print();
        document.body.innerHTML = restorepage;
    }
</script>