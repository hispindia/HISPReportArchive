
<!-- <link rel="stylesheet" href="../dhis-web-commons/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href="../dhis-web-commons/bootstrap/css/bootstrap-theme.min.css">
<script src="../dhis-web-commons/bootstrap/js/bootstrap.min.js"></script>	-->

<link rel="stylesheet" href="../dhis-web-commons/javascripts/ext/resources/css/ext-plugin-gray.css" />
<script src="../dhis-web-commons/javascripts/ext/ext-all.js"></script>
<script src="../dhis-web-commons/javascripts/plugin/chart.js"></script>

<script type="text/javascript">
	var periods = dhis2.report.periods;
	var period = periods[0];
	var orgUnit = dhis2.report.organisationUnit;
	orgUnit.parent = dhis2.report.organisationUnitHierarchy[1];
	orgUnit.parent.parent = dhis2.report.organisationUnitHierarchy[2];

	var orgUnitChildrens = dhis2.report.organisationUnitChildren;
	var stringDEs = "";
	var arrayDEs = stringDEs.split(";");                                                                                                                                                     
			
	var uidGroupSet = "BXJjJYo3MjI";
	var stt=0;
	var load=1;

	var url = window.location.href;
	var params = url.split('=');
	var gotPeriod=params[2];
	
	var base = "";

	var table1DX = [{ id: "kUblzoip82e", name: "ABER" }, { id: "b1xITjZptuv", name: "TPR" }, { id: "bbETHYQwVSX", name: "Pf" }, { id: "es1BEMqzt4v", name: "Pv" }, { id: "hrOpx6utoln", name: "Mixed" }, { id: "L74cULAuOOH", name: "Total cases" }, { id: "w1XJfR1qMFY", name: "API" }, { id: "i6ooiaF5CEg", name: "Deaths" } ];
	var table2DX = [
					{ id: "oInL1eHmLs5", name: "TestsDH" }, { id: "HBpLQuGUxoc", name: "TestsSDH" }, { id: "GrjGaHFeP0n", name: "TestsCHC" }, { id: "gvBWYOOZMte", name: "TestsPHC" }, { id: "ogPpAH5BHd4", name: "TestsSC" }, { id: "qQYCiXrwJR4", name: "TestsFTD" }, { id: "X4R4AFytf9B", name: "TestsMHU" }, 
					{ id: "wrnQyjMnXQ7", name: "PosTestsDH" }, { id: "SQ9bnuriZHT", name: "PosTestsSDH" }, { id: "OQ5Ak02wFUa", name: "PosTestsCHC" }, { id: "i6tpgZnM351", name: "PosTestsPHC" }, { id: "oRzWG9dfuyi", name: "PosTestsSC" }, { id: "MpKESJ9v7Qq", name: "PosTestsFTD" }, { id: "ozMB7sUNJxJ", name: "PosTestsMHU" }, 
					{ id: "HpSFpir9Vdy", name: "Severe cases" }, 
					{ id: "L74cULAuOOH", name: "Top SC" }
				];
	var table3_1DX = [{ id: "WdXbRmF1mRJ", name: "IRS (HH) VC" }, { id: "hsC0lsgRjWY", name: "IRS (HH) Target" }, { id: "y2hKj0nYFDg", name: "LLIN VC" }, { id: "TPD4QDUn4Zf", name: "LLIN Target" }, { id: "q4bcPlF7Z6t", name: "ITNs VC" } ];
	var table3_2DX = [{ id: "aeNHo82N0kC", name: "<24hrs - testing" }, { id: "N38MGB3PeyZ", name: "<24hrs - treatment" }, { id: "scBA2kJQ9eh", name: ">48hrs -testing" }, { id: "yWW9yC4okBS", name: ">48hrs -treatment" } ];
	var table4DX = [{ id: "ZxNMii7CiCS", name: "Direct issue" }, { id: "vCzK9qpEUGE", name: "Referred" }, { id: "Y2xgedpfAfC", name: "Repeat" }, { id: "UpSbIHzw0YP", name: "Follow-up" }, { id: "DIGfDbPbaCq", name: "Adverse events" }];
	
	var desForTable5_1 = "VJzesZoVqo4";
	var decocForTable5_1 = "Uu333dpxab2;xN0BfT7RSTa;kzLX5lkPMYA;wKLFBBCZQO1;ThPMNQYnYLP";
	var desForTable5_2 = "ovsR2arUk7T;Zy6zKunziC5;dbJ1BOpR3GZ;Y6ZzhrJ0zk3;t6H8hzMHcVA;EA9oQTDLsKb;XyJ2nfHZ6Hy;PPMIIoMXSE2;zvFVPzDORw7;oefcMViEovH;jsRG5QnmJdy;HueCXV4DMHT;sYpeDctsiV9;aEFxnt5dnIZ;i2YEfJJXAh4;cWo0AbSoZzH;DHs1o642LQ0;fHBNTycDxgQ;S3MZc0dcQMh";

	var table6DX = [ { id: "IiSIvlVT03F", name: "Population (residing)" }, { id: "", name: "Population (residing)" }, { id: "", name: "Population (residing)" }, { id: "", name: "Population (residing)" }, { id: "", name: "Population (residing)" }, { id: "", name: "Population (residing)" }, 
					 { id: "sAOEwg6S3Ls", name: "Total tests" }, { id: "jUojtgw9Dko", name: "Total tests" }, { id: "SY3ruadQwSm", name: "Total tests" }, { id: "", name: "Total tests" }, { id: "RA2NZ7zrgkU", name: "Total tests" }, { id: "", name: "Total tests" }, 
					 { id: "JpXVYbkOSQo", name: "Total positives" }, { id: "GCEeoTyl4Wk", name: "Total positives" }, { id: "vjgl7SAZx9G", name: "Total positives" }, { id: "LitpmwxNYII", name: "Total positives" }, { id: "UJBb9BbW6py", name: "Total positives" }, { id: "sFEUpLGKzBG", name: "Total positives" }, 
					 { id: "dFix4ZQFlJx", name: "Total asymptomatics (without fever found positive)" }, { id: "YE3W5fWHcta", name: "Total asymptomatics (without fever found positive)" }, { id: "", name: "Total asymptomatics (without fever found positive)" }, { id: "", name: "Total asymptomatics (without fever found positive)" }, { id: "", name: "Total asymptomatics (without fever found positive)" }, { id: "", name: "Total asymptomatics (without fever found positive)" }, 
					 { id: "n8uY3CBkeil", name: "Pf" }, { id: "", name: "Pf" }, { id: "KdBt8iFqQPh", name: "Pf" }, { id: "", name: "Pf" }, { id: "atHl2u0N4R0", name: "Pf" }, { id: "", name: "Pf" },
					 { id: "bzBPj8AhN8n", name: "Pv" }, { id: "", name: "Pv" }, { id: "cecgFHjkzCB", name: "Pv" }, { id: "", name: "Pv" }, { id: "cQUtgIn7J5a", name: "Pv" }, { id: "", name: "Pv" },
					 { id: "fKxQwarNZ32", name: "Mixed" }, { id: "", name: "Mixed" }, { id: "RyGkClw5vVm", name: "Mixed" }, { id: "", name: "Mixed" }, { id: "YjZCA37tkJX", name: "Mixed" }, { id: "", name: "Mixed" }
					 ];
	
	var desForChart1 = "gHU2axe8SMo;uEW9E6W3Joi;xiqBNzLFq7N";
	var desForChart2 = "kUblzoip82e;b1xITjZptuv;w1XJfR1qMFY";
	var desForChart3 = "SzYtNvbFdN0;SnaCRoQqm4r;aeNHo82N0kC";
	var desForChart4 = "UpSbIHzw0YP";
	
	//for state and district selection
	var showingTable="datavalue1";

	jQuery( document ).ready( function() {	
	
		$.get("../api/system/info", function(json){
			base = json.contextPath;
			validateReport();
		
			$("#btnExport").click(function(e) {
				window.open('data:application/vnd.ms-excel,'+ encodeURIComponent($('#printing').html()));
				e.preventDefault();
			});
		});
	});



//get period *************************************************************
function getPeriod(pr)
{
	var year = pr.substring(0,4);
	var month = pr.substring(4,6);
	var strMonth="";
	
	if(month=="01" || month=="1")
		strMonth="January";
	else if(month=="02" || month=="2")
		strMonth="February";
	else if(month=="03" || month=="3")
		strMonth="March";
	else if(month=="04" || month=="4")
		strMonth="April";
	else if(month=="05" || month=="5")
		strMonth="May";
	else if(month=="06" || month=="6")
		strMonth="June";
	else if(month=="07" || month=="7")
		strMonth="Junly";
	else if(month=="08" || month=="8")
		strMonth="August";
	else if(month=="09" || month=="9")
		strMonth="September";
	else if(month=="10")
		strMonth="October";
	else if(month=="11")
		strMonth="November";
	else if(month=="12")
		strMonth="December";
	
	return strMonth + " " +year;
}
//************************************************************************

	var selYear = parseInt( gotPeriod.substring(0,4) );
	var pYear = selYear -1;
	
	//var periodsForTable1 = selYear+";"+pYear;
	
	var ytdCYPeriods = [];
	var ytdPYPeriods = [];
	//var periodsForTable1 = "";
	var ytdCYPeriodStr = "";
	var ytdPYPeriodStr = "";
	
	function preparePeriods()
	{		
		ytdCYPeriods.push( selYear );
		ytdCYPeriodStr += selYear+";";
		ytdPYPeriods.push( pYear );
		ytdPYPeriodStr += pYear+";";
		periodsForTable1 = selYear+";"+pYear;		
	}
	
	/*
	function preparePeriods()
	{
		var year = parseInt( gotPeriod.substring(0,4) );
		var month = parseInt( gotPeriod.substring(4,6) );
		
		for( var i=1; i <= month; i++ )
		{
			if( i < 10 )
			{
				ytdCYPeriods.push( year+"0"+i );
				ytdCYPeriodStr += year+"0"+i+";";
				ytdPYPeriods.push( (year-1)+"0"+i );
				ytdPYPeriodStr += (year-1)+"0"+i+";";
				periodsForTable1 += year+"0"+i+";"+(year-1)+"0"+i+";";
			}
			else
			{
				ytdCYPeriods.push( year+""+i );
				ytdCYPeriodStr += year+""+i+";";
				ytdPYPeriods.push( (year-1)+""+i );
				ytdPYPeriodStr += (year-1)+""+i+";";
				periodsForTable1 += year+""+i+";"+(year-1)+""+i+";";
			}
		}		
	}
	*/

	var numberofYears = 5;
	var lastXperiods = [];
	var lastXperiodsStr = "";
	var fromDate = "";
	
	
	function getLastXYearPeriods( )
	{
		var year = parseInt( gotPeriod.substring(0,4) );
		var month = parseInt( gotPeriod.substring(4,6) );
		fromDate = (year-numberofYears)+"01";
		
		for( var i=numberofYears; i>=0; i-- )
		{
			for( var j=1; j<=12; j++ )
			{
				if( i==0 && j > month )
				{
					break;
				}
				
				if( j < 10) 
				{
					lastXperiods.push( (year-i)+"0"+j );
					lastXperiodsStr += (year-i)+"0"+j+";";
				}
				else
				{
					lastXperiods.push( (year-i)+""+j );
					lastXperiodsStr += (year-i)+""+j+";";
				}
			}
		}		
	}
	
	function getLastXYearlyPeriods( )
	{		
		for( var i=numberofYears; i>=0; i-- )
		{
			lastXperiods.push( (selYear-i)+"" );
			lastXperiodsStr += (selYear-i)+";";
		}		
	}

	function validateReport()
	{

		$.get("../api/organisationUnitGroups/hdvIWjIWixd?filter=organisationUnits.id:eq:"+orgUnit.id,function(json){
	
			if ( !json.name )
			{
				alert("Selected Facility is not in Intervention OU Group");
				window.history.back();	
			}
			else
			{
				loadReport();
			}			
		});	
	}
	
	function loadReport()
	{
		preparePeriods();
		//getLastXYearPeriods();
		getLastXYearlyPeriods();
				
		document.getElementById('blockName').innerHTML=orgUnit.name;
		document.getElementById('perd1').innerHTML=getPeriod(gotPeriod);
		document.getElementById('districtName').innerHTML=orgUnit.parent.name;
		document.getElementById('stateName').innerHTML=orgUnit.parent.parent.name;
		
		populateTable1();
		populateTable2();
		populateTable3();
		populateTable3_2();
		populateTable4();
		//populateTable5();
		populateTable6();
		
		prepareLast3YearChart( desForChart1, "chart1", "Cases" );
		prepareLast3YearChart( desForChart2, "chart2", "ABER/ TPR / API" );
		//prepareLast3YearChart( desForChart3, "chart3" );
		prepareLast3YearChart( desForChart4, "chart4", "%" );
	}

	var publicOuGroupSetUID = "S43WrJLjMIl";
	var phcOUGroupUID = "fXXlOfR3KNY";
	var chcOUGroupUID = "I5vwf6HSnHT";
	var scOUGroupUID = "qaaIaEGClsl";
	var sdhOUGroupUID = "GrTLCbny9hl";

 
 
	function prepareLast3YearChart( des, chartDiv, rangeAxisTitle )
	{	
		var desForChart1Array = des.split(";");
		Ext.onReady(function() {
			
			var chartJson = {
				url: base,
				el: chartDiv,
				type: "line",					
				columns: [ {dimension: "dx", items: [ ]} ],	
				rows: [{dimension: "pe", items: [ ]}],
				filters: [ {dimension: "ou", items: [{id: orgUnit.id}]} ],
				showData: true,
				hideLegend: false,
				title: " ",
				domainAxisTitle: "Periods",
				rangeAxisTitle: rangeAxisTitle,
				hideEmptyRows: false,
				legendStyle: {}
			};
					
			$.each(lastXperiods, function (index, value) {
				if( parseInt( value ) > 2010 )
					chartJson.rows[0].items.push( {'id': value} );				
			});	
						
			$.each(desForChart1Array, function (index, value) {		
				chartJson.columns[0].items.push( {'id': value} );
			});				
			
			DHIS.getChart( chartJson );
		});	
	}

function populateTable5()
{
	var htmlReport="";
	var year = parseInt( gotPeriod.substring(0,4) );
	var month = gotPeriod.substring(4,6);
	
	var selPeriod = year+""+month;
	
	var desForTable5_1Array = desForTable5_1.split(";");
	var desForTable5_2Array = desForTable5_2.split(";");
	
	$.get("../api/analytics.json?dimension=dx:"+desForTable5_1+"&filter=ou:"+orgUnit.id+"&dimension=co&dimension=pe:"+selPeriod,function(json1)
	{		
		console.log("../api/analytics.json?dimension=dx:"+desForTable5_1+"&filter=ou:"+orgUnit.id+"&dimension=co&dimension=pe:"+selPeriod);
		var curMonthValue;
	
		// TABLE5 HEADER
		htmlReport += "<tr class='active' bgcolor='#CCCCCC' height='40'>";
		htmlReport += "<td align='center'>Stock</td>";
		htmlReport += "<td align='center'>RDT-M</td>";
		htmlReport += "<td align='center'>RDT-B</td>";
		htmlReport += "<td align='center'>ACT1</td>";
		htmlReport += "<td align='center'>ACT4</td>";
		htmlReport += "<td align='center'>ACT8</td>";
		htmlReport += "<td align='center'>ACT14</td>";
		htmlReport += "<td align='center'>ACTA</td>";
		htmlReport += "<td align='center'>CQ</td>";
		htmlReport += "<td align='center'>PQS</td>";
		htmlReport += "<td align='center'>PQL</td>";
		htmlReport += "<td align='center'>Quinine</td>";
		htmlReport += "<td align='center'>AS Inj</td>";
		htmlReport += "</tr>";
		
		$.get("../api/analytics.json?dimension=dx:"+desForTable5_2+"&filter=ou:"+orgUnit.id+"&dimension=pe:"+selPeriod,function(json)
		{								
			// TABLE5: ROW1
			htmlReport += "<tr height='50'>";
			htmlReport += "<td>Utilized</td>";

			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[0], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[1], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			
			//ACT
			curMonthValue = getValueByDeAndPeriodAndCoc( json1, desForTable5_2Array[0], selPeriod, decocForTable5_1[0] );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriodAndCoc( json1, desForTable5_2Array[0], selPeriod, decocForTable5_1[1] );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriodAndCoc( json1, desForTable5_2Array[0], selPeriod, decocForTable5_1[2] );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriodAndCoc( json1, desForTable5_2Array[0], selPeriod, decocForTable5_1[3] );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriodAndCoc( json1, desForTable5_2Array[0], selPeriod, decocForTable5_1[4] );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[2], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";			
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[3], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";			
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[4], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";			
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[5], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[6], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			htmlReport += "</tr>";

			// TABLE5: ROW2
			htmlReport += "<tr height='50'>";
			htmlReport += "<td>End balance</td>";
			
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[7], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[8], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[9], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[10], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[11], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[12], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[13], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[14], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[15], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[16], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[17], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			curMonthValue = getValueByDeAndPeriod( json, desForTable5_2Array[18], selPeriod );
			curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			htmlReport += "</tr>";

			// TABLE5: ROW3
			/*
			curMonthValue = "";
			htmlReport += "<tr height='50'>";
			htmlReport += "<td>Needed</td>";
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
			htmlReport += "</tr>";	
			*/
			
			$("#table5").append( htmlReport );			
		});
	});

}


function populateTable4()
{
	var htmlReport="";
	var year = parseInt( gotPeriod.substring(0,4) );
	var month = gotPeriod.substring(4,6);
	
	var selPeriod = year+""+month;
	
	var desForTable4 = "";	
	$.each(table4DX, function () {		
		desForTable4 += this.id + ";";
	});
		
	$.get("../api/analytics.json?dimension=dx:"+desForTable4+"&filter=ou:"+orgUnit.id+"&dimension=pe:"+periodsForTable1,function(json)
	{	
		$.get("../api/analytics.json?dimension=dx:"+desForTable4+"&dimension=ou:"+orgUnit.id+"&filter=pe:"+ytdCYPeriodStr,function(json2)
		{
			$.get("../api/analytics.json?dimension=dx:"+desForTable4+"&dimension=ou:"+orgUnit.id+"&filter=pe:"+ytdPYPeriodStr,function(json3)
			{	
				var curMonthValue;
				var ytdCYValue;
				var ytdPYValue;
				var diffValue;
						
				// TABLE4 HEADER
				htmlReport += "<tr class='active' bgcolor='#CCCCCC' height='50'>";
				htmlReport += "<td>Patient card</td>";
				<!--htmlReport += "<td align='center'>"+month+""+year+"</td>";-->
				htmlReport += "<td align='center'>"+selYear+"</td>";
				htmlReport += "<td align='center'>"+ pYear+"</td>";
				htmlReport += "<td align='center'>% Δ</td>";
				htmlReport += "</tr>";
				
				$.each(table4DX, function () {		
					//curMonthValue = getValueByDeAndPeriod( json, this.id, selPeriod );
					//ytdCYValue = getCellValueByDe( json2, this.id ); 
					ytdCYValue = getCellValue( json2, this.id, orgUnit.id );
					//ytdPYValue = getCellValueByDe( json3, this.id );
					ytdPYValue = getCellValue( json3, this.id, orgUnit.id );
					//ytdCYValue = getValueByDeAndPeriods( json, this.id, ytdCYPeriods );
					//ytdPYValue = getValueByDeAndPeriods( json, this.id, ytdPYPeriods );
					
					//curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
					ytdCYValue = Math.round( parseFloat( ytdCYValue ) * 10) / 10;
					ytdPYValue = Math.round( parseFloat( ytdPYValue ) * 10) / 10;
					
					diffValue = ( ( ytdCYValue - ytdPYValue ) / ytdPYValue ) * 100;
					diffValue = Math.round( parseFloat( diffValue ) * 10) / 10;
					/*ytdCYValue = ytdCYValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
					ytdPYValue = ytdPYValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
					diffValue = diffValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");*/
					
					htmlReport += "<tr height='41'>";
					htmlReport += "<td>"+this.name+"</td>";		
					//htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
					htmlReport += "<td align='center'>"+ getNumberFormat(ytdCYValue, ",") +"</td>";
					htmlReport += "<td align='center'>"+ getNumberFormat(ytdPYValue, ",") +"</td>";
					htmlReport += "<td align='center'>"+ getNumberFormat(diffValue, ",") +"</td>";
					htmlReport += "</tr>";		
				});
						
				$("#table4").append( htmlReport );
			});	
		});		
	});		
}


function populateTable6()
{
	var htmlReport="";
	var year = parseInt( gotPeriod.substring(0,4) );
	var month = gotPeriod.substring(4,6);
	
	var selPeriod = year+""+month;
	
	var desForTable6 = "";	
	$.each(table6DX, function () {
		if( this.id != "" )
			desForTable6 += this.id + ";";
	});
		
	$.get("../api/analytics.json?dimension=dx:"+desForTable6+"&filter=ou:"+orgUnit.id+"&dimension=pe:"+periodsForTable1,function(json)
	{	
		var curMonthValue;
				
		// TABLE6 HEADER
		htmlReport += "<tr class='active' bgcolor='#CCCCCC' height='50'>";
		htmlReport += "<td>Indicator</td>";
		htmlReport += "<td align='center'>Mass survey</td>";
		htmlReport += "<td align='center'>&nbsp;&nbsp;%&nbsp;&nbsp;</td>";
		htmlReport += "<td align='center'>Mass fever survey</td>";
		htmlReport += "<td align='center'>&nbsp;&nbsp;%&nbsp;&nbsp;</td>";
		htmlReport += "<td align='center'>EDCT Camps</td>";	
        htmlReport += "<td align='center'>&nbsp;&nbsp;%&nbsp;&nbsp;</td>";		
		htmlReport += "</tr>";

		var colCount = 1;
		$.each(table6DX, function () {
			
			if( colCount > 6 ){
				colCount = 1;
				htmlReport += "</tr>";
			}

			if( colCount == 1 ){
				htmlReport += "<tr height='49'>";
				htmlReport += "<td>"+this.name+"</td>";
				
			}

			if( this.id == "" ){
				htmlReport += "<td align='center' bgcolor='#CCCCCC'>&nbsp;</td>";
			}
			else{
				curMonthValue = getValueByDeAndPeriod( json, this.id, selYear );
                	
				curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
				//curMonthValue = curMonthValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
					
				htmlReport += "<td align='center'>"+ getNumberFormat(curMonthValue, ",") +"</td>";
			}
			colCount++;
		});
		
		//htmlReport += "</tr>";
		
		$("#table6").append( htmlReport );
	});		
}

function populateTable3_2()
{
	var htmlReport="";
	var year = parseInt( gotPeriod.substring(0,4) );
	var month = gotPeriod.substring(4,6);
	
	var selPeriod = year+""+month;
	
	var desForTable3_2 = "";	
	$.each(table3_2DX, function () {		
		desForTable3_2 += this.id + ";";
	});
		
	$.get("../api/analytics.json?dimension=dx:"+desForTable3_2+"&filter=ou:"+orgUnit.id+"&dimension=pe:"+periodsForTable1,function(json)
	{	
		$.get("../api/analytics.json?dimension=dx:"+desForTable3_2+"&dimension=ou:"+orgUnit.id+"&filter=pe:"+ytdCYPeriodStr,function(json2)
		{
			$.get("../api/analytics.json?dimension=dx:"+desForTable3_2+"&dimension=ou:"+orgUnit.id+"&filter=pe:"+ytdPYPeriodStr,function(json3)
			{	
				var curMonthValue;
				var ytdCYValue;
				var ytdPYValue;
				var diffValue;
						
				// TABLE3_2 HEADER
				htmlReport += "<tr class='active' bgcolor='#CCCCCC' height='50'>";
				htmlReport += "<td>Indicator (%)</td>";
				<!--htmlReport += "<td align='center'>"+month+""+year+"</td>";-->
				htmlReport += "<td align='center'>"+selYear+"</td>";
				htmlReport += "<td align='center'>"+pYear+"</td>";
				htmlReport += "<td align='center'>% Δ</td>";
				htmlReport += "</tr>";
				
				$.each(table3_2DX, function () {		
					//curMonthValue = getValueByDeAndPeriod( json, this.id, selPeriod );
					//ytdCYValue = getCellValueByDe( json2, this.id ); 
					ytdCYValue = getCellValue( json2, this.id, orgUnit.id );
					//ytdPYValue = getCellValueByDe( json3, this.id );
					ytdPYValue = getCellValue( json3, this.id, orgUnit.id );
					//ytdCYValue = getValueByDeAndPeriods( json, this.id, ytdCYPeriods );
					//ytdPYValue = getValueByDeAndPeriods( json, this.id, ytdPYPeriods );
					
					//curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
					ytdCYValue = Math.round( parseFloat( ytdCYValue ) * 10) / 10;
					ytdPYValue = Math.round( parseFloat( ytdPYValue ) * 10) / 10;
					
					diffValue = ( ( ytdCYValue - ytdPYValue ) / ytdPYValue ) * 100;
					diffValue = Math.round( parseFloat( diffValue ) * 10) / 10;
					/*ytdCYValue = ytdCYValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
					ytdPYValue = ytdPYValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
					diffValue = diffValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");*/
					
					htmlReport += "<tr height='36'>";
					htmlReport += "<td>"+this.name+"</td>";		
					<!--htmlReport += "<td align='center'>"+ curMonthValue +"</td>";-->
					htmlReport += "<td align='center'>"+ getNumberFormat(ytdCYValue, ",") +"</td>";
					htmlReport += "<td align='center'>"+ getNumberFormat(ytdPYValue, ",") +"</td>";
					htmlReport += "<td align='center'>"+ getNumberFormat(diffValue, ",") +"</td>";
					htmlReport += "</tr>";		
				});
						
				$("#table3_2").append( htmlReport );
			});	
		});		
	});		
}


	function populateTable3()
	{
		var htmlReport="";
		var year = parseInt( gotPeriod.substring(0,4) );
		var month = gotPeriod.substring(4,6);
		
		var selPeriod = year+""+month;
		
		var desForTable3 = "";	
		$.each(table3_1DX, function () {		
			desForTable3 += this.id + ";";
		});
		$.each(table3_2DX, function () {		
			desForTable3 += this.id + ";";
		});
		
		var desForTable3Array = desForTable3.split(";");
			
		$.get("../api/analytics.json?dimension=dx:"+desForTable3+"&filter=ou:"+orgUnit.id+"&dimension=pe:"+periodsForTable1,function(json)
		{		
			var curMonthValue;
			var ytdCYValue;
			var ytdPYValue;
			var diffValue;
			var targetValue;
			var coverageValue;
			
			// TABLE3 HEADER1
			htmlReport += "<tr class='active' bgcolor='#CCCCCC' height='41'>";
			htmlReport += "<td>VC</td>";
			htmlReport += "<td align='center'>"+selYear+"</td>";
			<!--htmlReport += "<td align='center'>"+pYear+"</td>";-->
			<!--htmlReport += "<td align='center'>% Target</td>";-->
			//htmlReport += "<td align='center'>% Coverage</td>";
			htmlReport += "</tr>";
					
			// TABLE3: ROW1 FOR IRS (HH)
			<!--curMonthValue = getValueByDeAndPeriod( json, table3_1DX[0].id, selPeriod );-->
			ytdCYValue = getValueByDeAndPeriod( json, table3_1DX[0].id, selYear );
			<!--targetValue = getValueByDeAndPeriod( json, table3_1DX[1].id, pYear );-->
			//coverageValue = getValueByDeAndPeriod( json, table3_1DX[2].id, selPeriod );
			//curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			ytdCYValue = Math.round( parseFloat( ytdCYValue ) * 10) / 10;
			//ytdCYValue = ytdCYValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
			//targetValue = Math.round( parseFloat( targetValue ) * 10) / 10;
			//coverageValue = Math.round( parseFloat( coverageValue ) * 10) / 10;
			
			htmlReport += "<tr height='45'>";
			htmlReport += "<td>IRS (HH)</td>";		
			//htmlReport += "<td align='center'>"+curMonthValue+"</td>";
			htmlReport += "<td align='center'>"+getNumberFormat(ytdCYValue, ",")+"</td>";
			//htmlReport += "<td align='center'>"+targetValue+"</td>";
			//htmlReport += "<td align='center'>"+coverageValue+"</td>";
			htmlReport += "</tr>";

			// TABLE3: ROW2 FOR LLIN
			//curMonthValue = getValueByDeAndPeriod( json, table3_1DX[2].id, selPeriod );
			ytdCYValue = getValueByDeAndPeriods( json, table3_1DX[2].id, ytdCYPeriods );
			//targetValue = getValueByDeAndPeriod( json, table3_1DX[3].id, selPeriod );
			//coverageValue = getValueByDeAndPeriod( json, table3_1DX[5].id, selPeriod );
			//curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			ytdCYValue = Math.round( parseFloat( ytdCYValue ) * 10) / 10;
			//ytdCYValue = ytdCYValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
			//targetValue = Math.round( parseFloat( targetValue ) * 10) / 10;
			//coverageValue = Math.round( parseFloat( coverageValue ) * 10) / 10;

			htmlReport += "<tr height='45'>";
			htmlReport += "<td>LLIN</td>";		
			//htmlReport += "<td align='center'>"+curMonthValue+"</td>";
			htmlReport += "<td align='center'>"+getNumberFormat(ytdCYValue, ",")+"</td>";
			//htmlReport += "<td align='center'>"+targetValue+"</td>";
			//htmlReport += "<td align='center'>"+coverageValue+"</td>";
			htmlReport += "</tr>";

			// TABLE3: ROW3 FOR ITNs
			//curMonthValue = getValueByDeAndPeriod( json, table3_1DX[4].id, selPeriod );
			ytdCYValue = getValueByDeAndPeriods( json, table3_1DX[4].id, ytdCYPeriods );
			//targetValue = getValueByDeAndPeriod( json, table3_1DX[5].id, selPeriod );
			//coverageValue = getValueByDeAndPeriod( json, table3_1DX[8].id, selPeriod );
			//curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
			ytdCYValue = Math.round( parseFloat( ytdCYValue ) * 10) / 10;
			//ytdCYValue = ytdCYValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
			//targetValue = Math.round( parseFloat( targetValue ) * 10) / 10;
			//coverageValue = Math.round( parseFloat( coverageValue ) * 10) / 10;
			
			htmlReport += "<tr height='45'>";
			htmlReport += "<td>ITNs</td>";		
			//htmlReport += "<td align='center'>"+curMonthValue+"</td>";
			htmlReport += "<td align='center'>"+getNumberFormat(ytdCYValue, ",")+"</td>";
			//htmlReport += "<td align='center'>&nbsp;</td>";
			//htmlReport += "<td align='center'>"+targetValue+"</td>";			
			//htmlReport += "<td align='center'>"+coverageValue+"</td>";
			htmlReport += "</tr>";
			
			/*
			// TABLE3 HEADER2
			htmlReport += "<tr class='active' bgcolor='#CCCCCC' height='45'>";
			htmlReport += "<td>Indicator (%)</td>";
			htmlReport += "<td align='center'>"+month+""+year+"</td>";
			htmlReport += "<td align='center'>01"+year+" - "+month+""+year+"</td>";
			htmlReport += "<td align='center'>01"+(year-1)+" - "+month+""+(year-1)+"</td>";
			htmlReport += "<td align='center'>% Δ</td>";
			htmlReport += "</tr>";
			
			$.each(table3_2DX, function () {					
				curMonthValue = getValueByDeAndPeriod( json, this.id, selPeriod );
				ytdCYValue = getValueByDeAndPeriods( json, this.id, ytdCYPeriods );
				ytdPYValue = getValueByDeAndPeriods( json, this.id, ytdPYPeriods );
				
				curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
				//ytdCYValue = Math.round( ( parseFloat( ytdCYValue ) / ytdCYPeriods.length ) * 10) / 10;
				//ytdPYValue = Math.round( ( parseFloat( ytdPYValue ) / ytdPYPeriods.length ) * 10) / 10;
				
				diffValue = ( ( ytdCYValue - ytdPYValue ) / ytdPYValue ) * 100;
				diffValue = Math.round( parseFloat( diffValue ) * 10) / 10;
				
				htmlReport += "<tr height='45'>";
				htmlReport += "<td>"+this.name+"</td>";		
				htmlReport += "<td align='center'>"+ curMonthValue +"</td>";
				htmlReport += "<td align='center'>"+ ytdCYValue +"</td>";
				htmlReport += "<td align='center'>"+ ytdPYValue +"</td>";
				htmlReport += "<td align='center'>"+ diffValue +"</td>";
				htmlReport += "</tr>";
			});
			*/

			$("#table3").append( htmlReport );
		});		
	}

	function getNumberFormat( numberVal, formatChar ){
		return numberVal.toString().replace(/\B(?=(\d{3})+(?!\d))/g, formatChar );	
	}

	function populateTable2()
	{
		var htmlReport="";
		//var year = parseInt( gotPeriod.substring(0,4) );
		//var month = gotPeriod.substring(4,6);
		
		//var selPeriod = year+""+month;
		var desForTable2 = "";	
		$.each(table2DX, function () {		
			desForTable2 += this.id + ";";
		});
		
		$.get("../api/analytics.json?dimension=dx:"+desForTable2+"&filter=ou:"+orgUnit.id+"&filter=pe:"+selYear,function(json1){
		
			//$.get("../api/analytics.json?dimension="+publicOuGroupSetUID+":"+phcOUGroupUID+";"+chcOUGroupUID+";"+scOUGroupUID+";"+sdhOUGroupUID+"&filter=pe:"+selPeriod+"&dimension=dx:"+desForTable2+"&filter=ou:"+orgUnit.id+"&displayProperty=NAME",function(json)
			//{		
				var chcValue;
				var phcValue;
				var scValue;
				var sdhValue;
				var totalValue;
				var ftdValue;
				var dhValue;
				var mhuValue;
				
				// TABLE2 HEADER
				htmlReport += "<tr class='active' bgcolor='#CCCCCC' height='41'>";		
				htmlReport += "<td align='center'>"+ selYear +"</td>";				
				htmlReport += "<td align='center'>DH</td>";
				htmlReport += "<td align='center'>SDH</td>";
				htmlReport += "<td align='center'>CHC</td>";
				htmlReport += "<td align='center'>PHC</td>";
				htmlReport += "<td align='center'>SC</td>";
				htmlReport += "<td align='center'>FTD</td>";
				htmlReport += "<td align='center'>MHU</td>";
				//htmlReport += "<td align='center'>TOTAL</td>";
				htmlReport += "</tr>";
				
				// TABLE2 ROW1 TESTS
				dhValue = getCellValueByDe( json1, table2DX[0].id );
				sdhValue = getCellValueByDe( json1, table2DX[1].id );
				chcValue = getCellValueByDe( json1, table2DX[2].id );
				phcValue = getCellValueByDe( json1, table2DX[3].id );
				scValue = getCellValueByDe( json1, table2DX[4].id );
				ftdValue = getCellValueByDe( json1, table2DX[5].id );
				mhuValue = getCellValueByDe( json1, table2DX[6].id );
								
				chcValue = Math.round( parseFloat( chcValue ) * 10) / 10;
				phcValue = Math.round( parseFloat( phcValue ) * 10) / 10;
				scValue = Math.round( parseFloat( scValue ) * 10) / 10;
				sdhValue = Math.round( parseFloat( sdhValue ) * 10) / 10;
				ftdValue = Math.round( parseFloat( ftdValue ) * 10) / 10;
				dhValue = Math.round( parseFloat( dhValue ) * 10) / 10;
				mhuValue = Math.round( parseFloat( mhuValue ) * 10) / 10;
				totalValue = chcValue + phcValue + scValue + sdhValue + ftdValue + dhValue + mhuValue;
				totalValue = Math.round( parseFloat( totalValue ) * 10) / 10;
					//chcValue = chcValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//phcValue = phcValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//scValue = scValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//sdhValue = sdhValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//ftdValue = ftdValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//dhValue = dhValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//mhuValue = mhuValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				
				htmlReport += "<tr height='41'>";
				htmlReport += "<td align='left'>Tests</td>";
				htmlReport += "<td align='center'>"+ getNumberFormat(dhValue, ",") +"</td>";
				htmlReport += "<td align='center'>"+ getNumberFormat(sdhValue, ",") +"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(chcValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(phcValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(scValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(ftdValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(mhuValue, ",")+"</td>";
				//htmlReport += "<td align='center'>"+totalValue+"</td>";
				htmlReport += "</tr>";
				
				// TABLE2 ROW2 % TOTAL
				var chcPValue = Math.round( parseFloat( (chcValue / totalValue)*100 ) * 10) / 10;
				var phcPValue = Math.round( parseFloat( (phcValue / totalValue)*100 ) * 10) / 10;
				var scPValue = Math.round( parseFloat( (scValue / totalValue)*100)  * 10) / 10;
				var sdhPValue = Math.round( parseFloat( (sdhValue / totalValue)*100 ) * 10) / 10;
				var ftdPValue = Math.round( parseFloat( (ftdValue / totalValue)*100 ) * 10) / 10;				
				var dhPValue = Math.round( parseFloat( (dhValue / totalValue)*100 ) * 10) / 10;
				var mhuPValue = Math.round( parseFloat( (mhuValue / totalValue)*100 ) * 10) / 10;
				/*chcPValue = chcPValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				phcPValue = phcPValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				scPValue = scPValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				sdhPValue = sdhPValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				ftdPValue = ftdPValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				dhPValue = dhPValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				mhuPValue = mhuPValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");*/
				
				htmlReport += "<tr height='41'>";		
				htmlReport += "<td align='left'>% Total</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(dhPValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(sdhPValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(chcPValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(phcPValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(scPValue, ",")+"</td>";				
				htmlReport += "<td align='center'>"+getNumberFormat(ftdPValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(mhuPValue, ",")+"</td>";
				//htmlReport += "<td align='center'>&nbsp;</td>";
				htmlReport += "</tr>";
				
				// TABLE2 ROW3 POSITIVE TESTS
				dhValue = getCellValueByDe( json1, table2DX[7].id );
				sdhValue = getCellValueByDe( json1, table2DX[8].id );
				chcValue = getCellValueByDe( json1, table2DX[9].id );
				phcValue = getCellValueByDe( json1, table2DX[10].id );
				scValue = getCellValueByDe( json1, table2DX[11].id );
				ftdValue = getCellValueByDe( json1, table2DX[12].id );
				mhuValue = getCellValueByDe( json1, table2DX[13].id );
								
				chcValue = Math.round( parseFloat( chcValue ) * 10) / 10;
				phcValue = Math.round( parseFloat( phcValue ) * 10) / 10;
				scValue = Math.round( parseFloat( scValue ) * 10) / 10;
				sdhValue = Math.round( parseFloat( sdhValue ) * 10) / 10;
				ftdValue = Math.round( parseFloat( ftdValue ) * 10) / 10;
				dhValue = Math.round( parseFloat( dhValue ) * 10) / 10;
				mhuValue = Math.round( parseFloat( mhuValue ) * 10) / 10;
				totalValue = chcValue + phcValue + scValue + sdhValue + ftdValue + dhValue + mhuValue;
				totalValue = Math.round( parseFloat( totalValue ) * 10) / 10;
				//chcValue = chcValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//phcValue = phcValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//scValue = scValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//ftdValue = ftdValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//dhValue = dhValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//mhuValue = mhuValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//sdhValue = sdhValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				
				htmlReport += "<tr height='41'>";
				htmlReport += "<td align='left'>Positive tests</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(dhValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(sdhValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(chcValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(phcValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(scValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(ftdValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(mhuValue, ",")+"</td>";
				//htmlReport += "<td align='center'>"+totalValue+"</td>";
				htmlReport += "</tr>";

				// TABLE2 ROW4 % TOTAL POSITIVE TESTS
				var chcPValue = Math.round( parseFloat( (chcValue / totalValue)*100 ) * 10) / 10;
				var phcPValue = Math.round( parseFloat( (phcValue / totalValue)*100 ) * 10) / 10;
				var scPValue = Math.round( parseFloat( (scValue / totalValue)*100)  * 10) / 10;
				var sdhPValue = Math.round( parseFloat( (sdhValue / totalValue)*100 ) * 10) / 10;
				var ftdPValue = Math.round( parseFloat( (ftdValue / totalValue)*100 ) * 10) / 10;				
				var dhPValue = Math.round( parseFloat( (dhValue / totalValue)*100 ) * 10) / 10;
				var mhuPValue = Math.round( parseFloat( (mhuValue / totalValue)*100 ) * 10) / 10;
				
				
						//chcPValue = chcPValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//phcPValue = phcPValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//scPValue = scPValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//sdhPValue = sdhPValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//ftdPValue = ftdPValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//dhPValue = dhPValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//mhuPValue = mhuPValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				
				htmlReport += "<tr height='41'>";		
				htmlReport += "<td align='left'>% Total</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(dhPValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(sdhPValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(chcPValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(phcPValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(scPValue, ",")+"</td>";				
				htmlReport += "<td align='center'>"+getNumberFormat(ftdPValue, ",")+"</td>";
				htmlReport += "<td align='center'>"+getNumberFormat(mhuPValue, ",")+"</td>";
				//htmlReport += "<td align='center'>&nbsp;</td>";
				htmlReport += "</tr>";
				
				
				// TABLE2 ROW5 SEVERE CASES
				var cellValue = getCellValueByDe( json1, table2DX[14].id );
				cellValue = Math.round( parseFloat( cellValue ) * 10) / 10;
				/*
				chcValue = getValueByOUGroupAndDe( json, chcOUGroupUID, table2DX[14].id );
				phcValue = getValueByOUGroupAndDe( json, phcOUGroupUID, table2DX[14].id );
				scValue = getValueByOUGroupAndDe( json, scOUGroupUID, table2DX[14].id );
				sdhValue = getValueByOUGroupAndDe( json, sdhOUGroupUID, table2DX[14].id );
						
				chcValue = Math.round( parseFloat( chcValue ) * 10) / 10;
				phcValue = Math.round( parseFloat( phcValue ) * 10) / 10;
				scValue = Math.round( parseFloat( scValue ) * 10) / 10;
				sdhValue = Math.round( parseFloat( sdhValue ) * 10) / 10;
				totalValue = chcValue + phcValue + scValue + sdhValue;
				totalValue = Math.round( parseFloat( totalValue ) * 10) / 10;
				*/
				
				htmlReport += "<tr height='41'>";		
				htmlReport += "<td >Severe cases</td>";
				htmlReport += "<td align='center' align='left' colspan='7'>"+ cellValue +"</td>";
				htmlReport += "</tr>";
				
				// TABLE2 ROW6 TOP SC
				htmlReport += "<tr height='41'>";		
				htmlReport += "<td align='left'>Top SC</td>";
				htmlReport += "<td id='topSCs' align='center' colspan='7'>&nbsp;</td>";
				htmlReport += "</tr>";

				findTopSCs( 5, table2DX[15].id, 'topSCs' );

				// TABLE2 ROW4 TOP VILLAGE
				//htmlReport += "<tr height='41'>";		
				//htmlReport += "<td align='left'>Top Village</td>";
				//htmlReport += "<td align='center' colspan='6'>&nbsp;</td>";
				//htmlReport += "</tr>";
				
				
				$("#table2").append( htmlReport );
				
			//});
		});
	}
	
	function findTopSCs( topSCCount, deUID, cellID )
	{
		var topSCs = "NONE";
		var year = parseInt( gotPeriod.substring(0,4) );
		var month = gotPeriod.substring(4,6);
		var orgUnitDataJson = [];
		
		$.get("../api/analytics.json?dimension=dx:"+deUID+"&dimension=ou:"+orgUnit.id+";OU_GROUP-"+scOUGroupUID+"&filter=pe:"+year+""+month+"&displayProperty=NAME",function(json)
		{
			console.log( "../api/analytics.json?dimension=dx:"+deUID+"&dimension=ou:"+orgUnit.id+";OU_GROUP-"+scOUGroupUID+"&filter=pe:"+year+""+month+"&displayProperty=NAME" );
			
			json.metaData.ou.forEach(function(child){
				var tempVal = 0;
				tempVal = parseInt( getCellValue( json, deUID, child ) );
				
				orgUnitDataJson.push( {'id': child, 'name': json.metaData.names[child], 'value': tempVal} );
			});
			
			console.log( orgUnitDataJson );
			
			orgUnitDataJson.sort( function( a, b ){
				if ( a.value > b.value )
					return -1;
				if ( a.value < b.value )
					return 1;
				return 0;
			});
			
			console.log( orgUnitDataJson );
			topSCs = "";
			var count = 1;
			$.each(orgUnitDataJson, function () {
				if( count <= topSCCount )
				{
					topSCs += this.name + ", ";								
				}
				count++;	
			});
			
			document.getElementById(cellID).innerHTML= topSCs;
		});		
	}
	
	function populateTable1()
	{
		var htmlReport="";
		//var year = parseInt( gotPeriod.substring(0,4) );
		//var month = gotPeriod.substring(4,6);
		
		//var selPeriod = year+""+month;
		var desForTable1 = "";	
		$.each(table1DX, function () {		
			desForTable1 += this.id + ";";
		});
		
		$.get("../api/analytics.json?dimension=dx:"+desForTable1+"&filter=ou:"+orgUnit.id+"&dimension=pe:"+periodsForTable1,function(json)
		{	
			var curMonthValue;
			var ytdCYValue;
			var ytdPYValue;
			var diffValue;
			
			// TABLE1 HEADER
			htmlReport += "<tr class='active' bgcolor='#CCCCCC' height='31'>";
			htmlReport += "<td>Indicator</td>";
			<!--htmlReport += "<td align='center'>"+month+""+year+"</td>";-->
			htmlReport += "<td align='center'>"+selYear+"</td>";
			htmlReport += "<td align='center'>"+pYear+"</td>";
			htmlReport += "<td align='center'>% Δ</td>";
			htmlReport += "</tr>";

			$.each(table1DX, function () {
				//curMonthValue = getValueByDeAndPeriod( json, this.id, selPeriod );
				ytdCYValue = getValueByDeAndPeriod( json, this.id, selYear );
				ytdPYValue = getValueByDeAndPeriod( json, this.id, pYear );
				//ytdCYValue = getValueByDeAndPeriods( json, this.id, ytdCYPeriods );
				//ytdPYValue = getValueByDeAndPeriods( json, this.id, ytdPYPeriods );

				//curMonthValue = Math.round( parseFloat( curMonthValue ) * 10) / 10;
				ytdCYValue = Math.round( parseFloat( ytdCYValue ) * 10) / 10;
				ytdPYValue = Math.round( parseFloat( ytdPYValue ) * 10) / 10;
			
				diffValue = ( ( ytdCYValue - ytdPYValue ) / ytdPYValue ) * 100;
				diffValue = Math.round( parseFloat( diffValue ) * 10) / 10;
				//ytdCYValue = ytdCYValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//ytdPYValue = ytdPYValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
				//diffValue = diffValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

				htmlReport += "<tr height='31'>";
				htmlReport += "<td>"+this.name+"</td>";		
				<!--htmlReport += "<td align='center'>"+ curMonthValue +"</td>";-->
				htmlReport += "<td align='center'>"+ getNumberFormat(ytdCYValue, ",")  +"</td>";
				htmlReport += "<td align='center'>"+ getNumberFormat(ytdPYValue, ",") +"</td>";
				htmlReport += "<td align='center'>"+ getNumberFormat(diffValue, ",") +"</td>";
				htmlReport += "</tr>";
			});
			
			$("#table1").append( htmlReport );							
		});
			
	}


//***************************sorting***********************************
	var ChildCount=0;
	var childrens=[];
	var allCodes=[];
	var regionsLoaded=0;


function stringOrgChild(org)
{
		var stringOrg = "";
		var stringCode = "";
		
	$.get("../api/organisationUnits/"+org+".json",function(json)
	{
		ChildCount=0;
		childrens=[];
		allCodes=[];
		
		json.children.forEach(function(child)
		{
			//console.log(child);	
			var childID=child.id;
			var childName=child.name;
			childrens.push([childID,childName]);
			ChildCount++;
		});
		
		sortChildren();
		//alert(ChildCount);
		
		for(var f=0; f<ChildCount; f++)
		{
			var childID=childrens[f][0];
			stringOrg+=childID+";";
		}
		
		if(orgUnit.id=="Z62o5F3NmDg")
		{
			stringOrg+=org;
		}
		
		allCodes.push([stringOrg,stringCode]);

		writelines(stringOrg,stringCode);
	});
}


function sortChildren()
{
	for(var u=0;u<ChildCount;u++)
	{
		for(var k=0; k<ChildCount-1; k++)
		{
			if(childrens[k][1]>childrens[k+1][1])
			{
				var tempID=childrens[k][0];
				var tempCode=childrens[k][1];
				
				childrens[k][1]=childrens[k+1][1];
				childrens[k][0]=childrens[k+1][0];
				childrens[k+1][1]=tempCode;
				childrens[k+1][0]=tempID;
			}
		}
	}
}


//******************************************************************						

function getValueByOUGroupAndDe( json, oug, de )
{
	var result=0;
	
	for( var i=0; i < json.rows.length; i++ )
	{
		if( json.rows[i][1] == de && json.rows[i][0] == oug && json.rows[i][2]!= null )
		{
			result = json.rows[i][2];
			break;
		}
	}
	
	return result;
}

function getValueByDeAndPeriodAndCoc( json, de, p, coc )
{
	var result=0;
	
	for( var i=0; i < json.rows.length; i++ )
	{
		if( json.rows[i][0] == de && json.rows[i][2] == coc && json.rows[i][1] == p && json.rows[i][3]!= null )
		{
			result = json.rows[i][3];
			break;
		}
	}
	
	return result;
}

function getValueByDeAndPeriod( json, de, p )
{
	var result=0;
	
	for( var i=0; i < json.rows.length; i++ )
	{
		if( json.rows[i][0] == de && json.rows[i][1] == p && json.rows[i][2]!= null )
		{
			result = json.rows[i][2];
			break;
		}
	}
	
	return result;
}

function getValueByDeAndPeriods( json, de, periods )
{
	var result=0.0;
	
	for( var i=0; i < json.rows.length; i++ )
	{	
		for( var j=0; j < periods.length; j++ )
		{
			var p = periods[j];
			
			if( json.rows[i][0] == de && json.rows[i][1] == p && json.rows[i][2]!= null )
			{
				result += parseFloat(json.rows[i][2]);
				continue;
			}
		}
	}
	
	return result;
}

function getCellValueByDe( json, de )
{
	var result = 0;
	
	for (var i = 0; i < json.rows.length; i++)
	{
		if( json.rows[i][0] == de && json.rows[i][1] != null )
		{
			result = json.rows[i][1];
			break;
		}
	}
	
	return result;
}
	
	function getCellValue( json, de, orgUnit )
	{
		var result = 0;
		
		for (var i = 0; i < json.rows.length; i++)
		{
			if( json.rows[i][0] == de && json.rows[i][1] == orgUnit && json.rows[i][2] != null )
			{
				result = json.rows[i][2];
				break;
			}
		}
		
		return result;
	}

function getValueSum(json,de,orgGroup){
	var result=0;
	for (var i=0; i < json.rows.length; i++){
		if (json.rows[i][0] == de && json.rows[i][1] == orgGroup && json.rows[i][2]!= null)
		{
			result = parseFloat(json.rows[i][2]);
		}
	}
	return result;
}
function getValueTotal(json,de){
	var result=0;
	for (var i=0; i < json.rows.length; i++){
		if (json.rows[i][0] == de && json.rows[i][2]!= null)
		{
			result=json.rows[i][2];
		}
	}
	return result;
}
</script>


<!-- download script ------------------------------------------------------
		--------------------------------------------------------------------------
		-------------------------------------------------------------------------------------- -->
<script type="text/javascript">
	 var tablesToExcel = (function() {
    var uri ='data:application/vnd.ms-excel;base64,', tmplWorkbookXML ='<?xml version="1.0"?><?mso-application progid="Excel.Sheet"?><Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">'+'<DocumentProperties xmlns="urn:schemas-microsoft-com:office:office"><Author>ThaiND</Author><Created>{created}</Created></DocumentProperties>'+'<Styles><Style ss:ID="Default" ss:Name="Normal"><Alignment ss:Horizontal="Center" ss:WrapText="1"/><Borders><Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/></Borders><Font/><Interior /><NumberFormat /><Protection /></Style><Style ss:ID="s21"><Alignment ss:WrapText="1" ss:Horizontal="Center" ss:Vertical="Center"/><Font ss:Size="10" ss:Bold="1" /><Interior ss:Color="#999999" ss:Pattern="Solid" /><Borders><Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/></Borders></Style> <Style ss:ID="s22"><Alignment ss:WrapText="1" ss:Horizontal="Center" ss:Vertical="Center"/><Font ss:Size="10" ss:Bold="1" /><Interior ss:Color="#999999" ss:Pattern="Solid" /><Borders><Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/><Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/></Borders></Style><Style ss:ID="s64"> <Alignment ss:WrapText="1" ss:Horizontal="Center" ss:Vertical="Center" ss:Indent="0" ss:Rotate="90"/><Font ss:Size="10" ss:Bold="1" /><Interior ss:Color="#999999" ss:Pattern="Solid" /> </Style> </Styles>'+'{worksheets}</Workbook>', tmplWorksheetXML ='<Worksheet ss:Name="{nameWS}"><Table><Column ss:AutoFitWidth="0" ss:Width="100"/><Column ss:AutoFitWidth="0" ss:Width="150"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/><Column ss:AutoFitWidth="0" ss:Width="80"/>{rows}</Table></Worksheet>', tmplCellXML ='<Cell ss:StyleID="{sid}" ss:MergeAcross="{mrg}"><Data ss:Type="{dtype}">{data}</Data></Cell>', base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) }
    , format = function(s, c) { return s.replace(/{(\w+)}/g, function(m, p) { return c[p]; }) }
	
    return function(tables, wsnames, wbname) {
		var ctx = "";
		var workbookXML = "";
		var worksheetsXML = "";
		var rowsXML = "";
		
		for (var i = 0; i < tables.length; i++) 
		{
		
			if (!tables[i].nodeType) 
			tables[i] = document.getElementById(tables[i]);
		
			for (var j = 0; j < tables[i].rows.length; j++) 
			{
				rowsXML +='<Row>'for (var k = 0; k < tables[i].rows[j].cells.length; k++) 
				{
					
					var cols=tables[i].rows[j].cells[k].getAttribute("colspan");
					var rws=tables[i].rows[j].cells[k].getAttribute("rowspan");
					var styl=tables[i].rows[j].cells[k].getAttribute("bgcolor");
					var styl2=tables[i].rows[j].getAttribute("bgcolor");
					var cls=tables[i].rows[j].cells[k].getAttribute("class");
					
						var dataType ='String';
						var dataValue = tables[i].rows[j].cells[k].innerHTML;
						var typeD="";
						var parsed=parseInt(dataValue);
						
						if (parsed==dataValue)
						{
							typeD="Number";
						}
						else
						{
							typeD="String";
						}
					
					
					
					if(styl2)
					{
						if(cols)
						{
							if(cls=="aso")
							{
								ctx = {data: dataValue, mrg: cols-1, sid:"s64",dtype:typeD};
								rowsXML += format(tmplCellXML, ctx);
							}
							else
							{
								ctx = {data: dataValue, mrg: cols-1, sid:"s22",dtype:typeD};
								rowsXML += format(tmplCellXML, ctx);
							}
						}

						else
						{
							if(cls=="aso")
							{
								ctx = {data: dataValue, mrg: 0, sid:"s64",dtype:typeD};
								rowsXML += format(tmplCellXML, ctx);
							}
							else
							{
								ctx = {data: dataValue, mrg: 0, sid: "s22",dtype:typeD};
								rowsXML += format(tmplCellXML, ctx);
							}
						}
					}
				
					else if(styl)
					{
						if(cols)
						{
							ctx = {data: dataValue, mrg: cols-1, sid:"s21",dtype:typeD};
							rowsXML += format(tmplCellXML, ctx);
						}

						else
						{
							ctx = {data: dataValue, mrg: 0, sid: "s21",dtype:typeD};
							rowsXML += format(tmplCellXML, ctx);
						}
					}
					
					else
					{
						if(cols)
						{
							ctx = {data: dataValue, mrg: cols-1, sid:"Default",dtype:typeD};
							rowsXML += format(tmplCellXML, ctx);
						}

						else
						{
							ctx = {data: dataValue, mrg: 0, sid: "Default",dtype:typeD};
							rowsXML += format(tmplCellXML, ctx);
						}
					
					}
					
				}
				  rowsXML +='</Row>'}
			ctx = {rows: rowsXML, nameWS: wsnames[i] ||'Sheet'+ i};
			worksheetsXML += format(tmplWorksheetXML, ctx);
			rowsXML = "";
      }

		ctx = {created: (new Date()).getTime(), worksheets: worksheetsXML};
		workbookXML = format(tmplWorkbookXML, ctx);

		console.log(workbookXML);

		var link = document.createElement("A");
		link.href = uri + base64(workbookXML);
		link.download = wbname ||'Workbook.xls';
		link.target ='_blank';
		document.body.appendChild(link);
		link.click();
		document.body.removeChild(link);
    }
  })();
</script>


<style>
@media print{@page {size: landscape}}
	
	#cover{ position:fixed; top:0; left:0; background:rgba(0,0,0,0.7); z-index:5; width:100%; height:100%;}
			#loads { height:100px; width:500px; position:fixed; z-index:10;  margin:0 auto;   top: 50%; left: 50%; margin-top:-50px; margin-left:-250px; background:#999; border:5px solid #cccccc; text-align=center; border-radius:5px; }
			.loading { width:400px; font-size:20px; font-family:verdana; font-weight:bolder; position:fixed;  top: 50%; left: 50%; margin:0 auto; margin-top:-8px; margin-left:-200px;}
		
</style>
<!--<div id="loads" > <p class="loading" align="center">Reports Loading... Please Wait...</p></div>
		<div id="cover" > </div>-->

</br></br>

<div id="printing">

	<table  class="table" cellspacing="6" cellpadding="4" align="center" id="datavalue1" width="98%" style="border-collapse:collapse; font-weight:bolder">
		<tr bgcolor="#32849C" align="center" height="31">
			<td colspan="8" height="31"><font color="#FFFFFF" >ANNUAL REPORT CARD</font></td>
		</tr>
		<tr bgcolor="#F2DDDC" align="center" height="57">
			<td align="right" width="5%" >State: </td>
			<td align="left" id="stateName" width="20%"></td>
			<td align="right" width="5%">District: </td>
			<td align="left" id="districtName" width="20%">&nbsp;</td>
			<td align="right" width="5%">Block: </td>
			<td align="left" id="blockName" width="20%">&nbsp;</td>
			<td align="right" width="10%">Year: </td>
			<td align="left" id="perd1" width="15%">&nbsp;</td>			
		</tr>
	</table>

	<br />	
	<table  class="table" cellspacing="6" cellpadding="4" border="0" id="datavalue2" width="95%" align="center" style="border-collapse:collapse; font-weight:bolder">	
		<tr bgcolor="#32849C" align="center" height="31">
			<td colspan="3"><font color="#FFFFFF" >EPIDEMIOLOGY &amp; IMPACT</font></td>
		</tr>		
		<tr>
			<td width="48%">
				<table class="table table-striped table-bordered" border="1" id="table1" cellspacing="6" cellpadding="4"  width="100%" align="center" style="border-collapse:collapse; border:2px; font-weight:bolder">					
				</table>
			</td>
			<td width="4%">&nbsp;</td>
			<td width="48%">
				<table class="table table-striped table-bordered" border="1" id="table2" cellspacing="6" cellpadding="4"  width="100%" align="center" style="border-collapse:collapse; border:2px; font-weight:bolder">
				</table>
			</td>
		</tr>
		<tr>
			<td width="48%"><div align="left" id="chart1" style="width:650px; height:415px;"></div></td>
			<td width="4%">&nbsp;</td>
			<td width="48%"><div align="left" id="chart2" style="width:650px; height:415px;"></div></td>
		</tr>
		
		<tr align="center" height="31">
			<td colspan="3">&nbsp;</td>
		</tr>
		<tr align="center" height="31">
			<td colspan="3">&nbsp;</td>
		</tr>
		<tr align="center" height="31">
			<td colspan="3">&nbsp;</td>
		</tr>

		<tr>
			<td colspan="3" bgcolor="#32849C" align="center"><font color="#FFFFFF" >INTERVENTION COVERAGE</font></td>
		</tr>
		<tr>
			<td width="48%">
				<table id="table3" border="1" cellspacing="6" cellpadding="4" width="100%" style="border-collapse:collapse; border:2px; font-weight:bolder">
				</table>
				<table id="table3_2" border="1" cellspacing="6" cellpadding="4" width="100%" style="border-collapse:collapse; border:2px; font-weight:bolder">
				</table>				
			</td>
			<td width="4%">&nbsp;</td>
			<!-- <td width="48%"><div id="chart3" style="width:650px; height:410px;"></div></td> -->
			<td width="48%">
				<table class="table table-striped table-bordered" border="1" id="table6" cellspacing="6" cellpadding="4"  width="100%" align="center" style="border-collapse:collapse; border:2px; font-weight:bolder">
				</table>
			</td>			
		</tr>
		<tr>
			<td bgcolor="#32849C" align="center" colspan="3"><font color="#FFFFFF" >TRACKING & LOGISTICS</font></td>
		</tr>
		<tr>
			<td width="48%">
				<table id="table4" border="1" cellspacing="6" cellpadding="4" width="100%" style="border-collapse:collapse; border:2px; font-weight:bolder">
				</table>
			</td>
			<td width="4%">&nbsp;</td>
			<td width="48%"><div id="chart4" style="width:650px; height:400px;"></div></td>
		</tr>
		<tr align="center" height="31">
			<td colspan="3">&nbsp;</td>
		</tr>		
		<tr>
			<td colspan="3">
				<table id="table5" border="1" cellspacing="6" cellpadding="4" width="100%" style="border-collapse:collapse; border:2px; font-weight:bolder">
				</table>
			</td>
		</tr>
	</table>
</div>
