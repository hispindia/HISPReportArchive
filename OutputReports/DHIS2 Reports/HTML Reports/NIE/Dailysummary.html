<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Daily Summary Report</title>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.15.35/css/bootstrap-datetimepicker.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.15.35/js/bootstrap-datetimepicker.min.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/no-data-to-display.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://dhis2-cdn.org/v225-1/plugin/jquery-2.2.4.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>

    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" />
    <!--<link rel="stylesheet" href="../api/documents/yV6CLAi1CWA/data" />-->
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" />
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
</head>

<body>
  <style type="text/css" href="http://139.162.61.147/nieodk_new/api/documents/IlCodOSjSxY/data" media="print">
        @media print {
            #notPrint {
                display: none;
            }
            #printing {
                display: block;
            }
            @page {
                size: A4 portrait;
                max-height: 100%;
                max-width: 100%
            }
        }
    </style>
<Style>
    .leaflet-popup-tip-container {
        display: none;
    }
    .leaflet-container {
        background-color:rgba(255,0,0,0.0);
    }
    .newRow td{
			border:1px solid black;
			height:30px;
			text-align:center;
		}
		thead th {
		text-align:center;
		}

.reporttable{
            border-collapse: collapse;
            border:1px solid black;
			text-align:center;
        }
        .tablerows{
            text-align: center;
            font-size:16px;
            background-color: #81969B;
            border:1px solid black;
            height:50px;
            width:10%;
        }
    .media screen {
        border: 1px solid blue;
    }
    .media print {
        border: 1px solid green;
    }

    .header img {
        float: left;
        width: 100px;
        height: 100px;
    }


    .header h1 {
        position: relative;
        top: 18px;
        left: 10px;
    }


    .table3 h1 {
        text-align: center;
    }

    .reporttableC {
        border-collapse: collapse;
        border: 1px solid black;
        text-align: center;
        width: 100%;
    }

    .reporttableC tr td {
        border: 1px solid black;
        height: 40px;
        min-width: 120px;
    }

    .reporttableC thead tr th {
        height: 50px;
        min-width: 120px;
        border: 2px solid black;
        background-color: #99ccff;
    }
    table {
        border-collapse: collapse;
    }

    tr {
        padding-top: .4em;
        padding-bottom: .5em;
    }
	.clusterHead td{
		background: skyblue;
		border: 2px solid black;
	}

        .custom-popup .leaflet-popup-content-wrapper {
            font-size:10px;
            line-height:2px;
        }
        .custom-popup .leaflet-popup-content-wrapper a {
            font-size:2px;
            line-height:2px;
            width:04px;
            height:04px;
        }
        .custom-popup .leaflet-popup-tip-container {
            width:04px;
            height:04px;
        }
    .info { padding: 6px 8px; font: 14px/16px Arial, Helvetica, sans-serif; background: white; background: rgba(255,255,255,0.8); box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 5px; } .info h4 { margin: 0 0 5px; color: #777; }
    .legend { text-align: left; line-height: 18px; color: #555; } .legend i { width: 18px; height: 18px; float: left; margin-right: 8px; opacity: 0.7; }
</Style>
<script>
  var tei,url,ou;
        var clusterId="None", clusterType="None";
        var district="None",hud="None",block="None",phc="None";
        var population=0, houseCount=0;
		var patients,patientsArray;
        var Pname,Page,Pgender,Pdoor,Phabitation,Pvillage,Pmob,Ponset, Pdate, Pstreet, Plab=[];

var total_1day= 0,total_7day= 0,total_30day=0;
    var p_indicator = [],
        x_categories = [],
        ip_fever_male_data = [],
        ip_fever_female_data = [],
        ip_fever_total_data = [];
    var series = [],
        flag = "false",
        ip_fever_male_data1, ip_fever_female_data1, ip_fever_age12 = [],
        ip_fever_agel = [],
        ip_fever_age1to5 = [],
        ip_fever_ageg6to12 = [];
    var data1 = ["10", "20", "30", "40", "50"],
        ip_fever_dengue_cases = [],
        ip_fever_scrub_cases = [],
//        opcases = [],
        ipcases = [],
        labconfirmedcases = [];
    var target = 0;
    var last30days,last7days;
//    var today, last30days = "20170427;20170426;20170425;20170424;20170423;20170422;20170421",
//     last7days = "20170427;20170426;20170425;20170424;20170423;20170422;20170421";
    var url, ou;
    var taluk_count_07 = {
        orgname: [],
        orgcount: []

    };
    var opcases = {
        ouval: [],
        ouperiod: []

    };

    var taluk_count_01 = {
        orgname: [],
        orgcount: []

    };
    var block_7count = 0,
        block_30count = 0;

    var taluk_count_30 = {
        orgname: [],
        orgcount: []

    };
    var taluk_chart_data = [];
    var taluk_chart_data_name = [];
    var ip_fever = {
        ip_fever_male: [],
        ip_fever_female: [],
        ip_fever_total: []
    };

    var ip_fever_gender = {
        ip_fever_age_g_12: [],
        ip_fever_age_l_1: [],
        ip_fever_age_6to12: [],
        ip_fever_age_1to5: []
    };

    var ip_fever_disease = {
        ip_fever_dengue: [],
        ip_fever_scrub: []
    };

    var op_cases = {
        op_fever_cases: []
    };
    var ip_cases = {
        ip_fever_cases: []
    };
    var lab_confirmed = {
        lab_confirmed_cases: []
    };
    //
    //    $(document).ready(function(){
    //
    //    });
	var today="";
    $(document).ready(function () {
		var url = window.location.href;
		var arrayUrl = url.split('&');
		if(arrayUrl.length >2){
		var arraySDate = arrayUrl[2] ;
		 today = arraySDate.split('=')[1];
		 loadDataX();
		}

    });


  function loadDataX() {
        url = window.location.href;
        ou = url.split('=')[2];

        $("#legend").show();

        var datee;
				if(today==""){
            today = document.getElementById('datepicker').value;
}
      var  year=today.substring(0,4);
      var month=today.substring(5,7);
      var piechartperod=year+''+month;
      var date=today.substring(8,11);

      var today_=year+"-"+month+"-"+date;
      var today_fortable=year+month+date;
      last30days="";
      var d = new Date(year,month-1,date);
      var  previousdy = new Date(d.getTime() - 1*24*60*60*1000);
      var  previousdy_7 = new Date(d.getTime() - 7*24*60*60*1000);
      var mon=previousdy.getMonth()+1;
      var mon_=previousdy_7.getMonth()+1;
      var datenew = previousdy.getDate();
      var datenew_ = previousdy_7.getDate();
      var dateyear=previousdy.getFullYear();
      var date_print=datenew+"-"+mon+"-"+dateyear;
      if(mon<10)
      {mon='0'+mon;
      }
      if(datenew<10){
          datenew = "0"+datenew;
      }if(mon_<10)
      {mon_='0'+mon_;
      }
      if(datenew_<10){
          datenew_ = "0"+datenew_;
      }
      var previousdy1=previousdy.getFullYear()+''+mon+''+datenew;
      var previousdy1_=previousdy.getFullYear()+'-'+mon+'-'+datenew;
      var previousdy_7_=previousdy_7.getFullYear()+'-'+mon_+'-'+datenew_;


      for (var x = 30; x >=1; x--) {
          // var date2=x-date;

          var  startDate = new Date(d.getTime() - x*24*60*60*1000);

          var date3=startDate.getDate();
          if(date3<10){
              date3='0'+date3;}
          var month1=startDate.getMonth()+1;
          if(month1<10){
              month1='0'+month1;
          }
          var year1=startDate.getFullYear();




          var period=year1+''+month1+''+date3;


          last30days= period+';'+last30days;

      };
      var len=last30days.length-1;
      last30days=last30days.substring(0,len);
      var blockwise=[];

      var target=0;
      var tar=0;
      var hell="Last 30 Days Average ";
      var last7days="";
      for (var x = 7; x >=1; x--) {
          // var date2=x-date;

          var  startDate = new Date(d.getTime() - x*24*60*60*1000);
          var date3=startDate.getDate();
          if(date3<10){
              date3='0'+date3;}
          var month1=startDate.getMonth()+1;
          if(month1<10){
              month1='0'+month1;
          }
          var year1=startDate.getFullYear();


          var period=year1+''+month1+''+date3;


          last7days= period+';'+last7days;

      };
      loadReports(previousdy_7_,previousdy1_,last7days);
      var len1=last7days.length-1;
      last7days=last7days.substring(0,len1);
//            var cloudmade1 = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
//                maxZoom: 18,
//                attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',
//                key: 'BC9A493B41014CAABB9dsfsdfds8F0471D759707'
//            });

            var map1 = L.map('map1')
                    .setView([13.232323, 79.8888], 10);


            // control that shows state info on hover
            var info = L.control();

            info.onAdd = function (map) {
                this._div = L.DomUtil.create('div', 'info');
                this.update();
                return this._div;
            };

            info.update = function (props) {
                this._div.innerHTML = '';
            };

            info.addTo(map1);


            // get color depending on population density value
            function getColor(d) {
                var afi_3 = '../api/documents/ph7t8TbV1lJ/data';
                var afi_5 = '../api/documents/KE87BJI62sC/data';
                var lab_1 = '../api/documents/AafIibwti0p/data';
                return d > '1 Lab confirmed case' ? lab_1 :
                        d > '5 AFI cases (last 5 days)' ? afi_5 :
                                d > '3 AFI cases (last 5 days)' ? afi_3 :
                                        '#FFEDA0';


            }

//


            function style(feature) {
                return {
                    weight: 2,
                    opacity: 1,
                    color: 'white',
                    dashArray: '3',
                    fillOpacity: 0.7,
                    fillColor: getColor(feature.properties.density)
                };
            }


            var legend = L.control({position: 'bottomright'});

            legend.onAdd = function (map) {

                var div = L.DomUtil.create('div', 'info legend'),
                        grades = ['3 AFI cases (last 5 days)', '5 AFI cases (last 5 days)', '1 Lab confirmed case','Manual Cluster'],
                        labels = [],
                        from = ['../api/documents/ph7t8TbV1lJ/data', '../api/documents/KE87BJI62sC/data', '../api/documents/AafIibwti0p/data','../api/documents/dWIBuOQPMHq/data'],
                        to;

                for (var i = 0; i < grades.length; i++) {
//                from = grades[i];
                    to = grades[i];

                    labels.push(
                            '<img src="' + (from[i]) + '"  style="width:20px;height: 20px ;"> ' + ( to ));
                }

                div.innerHTML = labels.join('<br>');
                return div;
            };

            legend.addTo(map1);


            var afi_3 = '../api/documents/ph7t8TbV1lJ/data';
            var afi_5 = '../api/documents/KE87BJI62sC/data';
            var lab_1 = '../api/documents/AafIibwti0p/data';

            document.getElementById("report").innerHTML = "Report ID:";
            document.getElementById("datet").innerHTML = "Date : " + today_;
            document.getElementById("period").innerHTML = "Period : " + previousdy_7_+ " - " + previousdy1_;

            $.ajax({
                async: false,
                type: "GET",
                dataType: "json",
                contentType: "application/json",
                url: '../api/25/analytics.json?dimension=dx:c6ZZS1owbii;BJ3D1sBfXkN&dimension=pe:' + last7days +
                '&filter=ou:leMGqLV90eH&displayProperty=NAME&outputIdScheme=CODE',
                success: function (dhis_rows) {
                    for (var i = 0; i < dhis_rows.metaData.pe.length; i++) {
                        x_categories.push(dhis_rows.metaData.pe[i]);
                    }
                    for (var i = 0; i < dhis_rows.rows.length; i++) {
                        if (dhis_rows.rows[i][0] == "c6ZZS1owbii") {
                            ip_fever.ip_fever_male.push({
                                "name": "IP fever case (male)",
                                "period": dhis_rows.rows[i][1],
                                "value": dhis_rows.rows[i][2]
                            });

                            ip_fever_male_data.push(Number(dhis_rows.rows[i][2]));

                        } else if (dhis_rows.rows[i][0] == "BJ3D1sBfXkN") {
                            ip_fever.ip_fever_female.push({
                                "name": "IP fever case (female)",
                                "period": dhis_rows.rows[i][1],
                                "value": dhis_rows.rows[i][2]
                            });
                            ip_fever_female_data.push(Number(dhis_rows.rows[i][2]));

                        } else {
                            ip_fever.ip_fever_total.push({
                                "name": "IP fever case (total)",
                                "period": dhis_rows.rows[i][1],
                                "value": dhis_rows.rows[i][2]
                            });
                            ip_fever_total_data.push(dhis_rows.rows[i][2]);
                        }

                    }
//                    x_categories.reverse();
                    ip_fever_male_data.reverse();
                    ip_fever_female_data.reverse();

                    generatechart_ipfever_male_female(x_categories, ip_fever_male_data,
                            ip_fever_female_data);


                },
                error: function (response) {

                }
            });

            $.ajax({
                async: false,
                type: "GET",
                dataType: "json",
                contentType: "application/json",
                url: '../api/25/analytics.json?dimension=dx:qt1YSg9Nxrf;tGevnp0W5lQ;b2RCQBQGScR;PGmsNGvuZtr&dimension=pe:' +
                last7days + '&filter=ou:leMGqLV90eH&displayProperty=NAME&skipMeta=true',
                success: function (dhis_rows) {
                    x_categories = [];
                    for (var i = 0; i < dhis_rows.rows.length; i++) {
                        for (var i = 0; i < dhis_rows.rows.length; i++) {
                            if (dhis_rows.rows[i][0] == "PGmsNGvuZtr") {
                                ip_fever_gender.ip_fever_age_g_12.push({
                                    "name": "IP fever case (age > 12 yrs)",
                                    "period": dhis_rows.rows[i][1],
                                    "value": dhis_rows.rows[i][2]
                                });

                                ip_fever_age12.push(Number(dhis_rows.rows[i][2]));
                                x_categories.push(dhis_rows.rows[i][1]);
                            } else if (dhis_rows.rows[i][0] == "qt1YSg9Nxrf") {
                                ip_fever_gender.ip_fever_age_l_1.push({
                                    "name": "IP fever case (age < 1 year)",
                                    "period": dhis_rows.rows[i][1],
                                    "value": dhis_rows.rows[i][2]
                                });
                                ip_fever_agel.push(Number(dhis_rows.rows[i][2]));

                            } else if (dhis_rows.rows[i][0] == "b2RCQBQGScR") {
                                ip_fever_gender.ip_fever_age_6to12.push({
                                    "name": "IP fever case (age 6-12 yrs)",
                                    "period": dhis_rows.rows[i][1],
                                    "value": dhis_rows.rows[i][2]
                                });
                                ip_fever_ageg6to12.push(Number(dhis_rows.rows[i][2]));

                            } else if (dhis_rows.rows[i][0] == "tGevnp0W5lQ") {
                                ip_fever_gender.ip_fever_age_1to5.push({
                                    "name": "IP fever case (age 1-5 yrs)",
                                    "period": dhis_rows.rows[i][1],
                                    "value": dhis_rows.rows[i][2]
                                });
                                ip_fever_age1to5.push(Number(dhis_rows.rows[i][2]));

                            } else {
                                //                           ip_fever.ip_fever_total.push({
                                //                               "name":"IP fever case (total)",
                                //                               "period" :dhis_rows.rows[i][1],
                                //                               "value"  : dhis_rows.rows[i][2]
                                //                           });
                                ip_fever_total_data.push(dhis_rows.rows[i][2]);
                            }
                        }
                    }
                    x_categories.reverse();
                    ip_fever_age12.reverse();
                    ip_fever_age1to5.reverse();
                    ip_fever_ageg6to12.reverse();
                    ip_fever_agel.reverse();
                    generatechart_ipfever_age(x_categories, ip_fever_age12, ip_fever_agel, ip_fever_age1to5,
                            ip_fever_ageg6to12);
                },
                error: function (response) {

                }
            });

            $.ajax({
                async: false,
                type: "GET",
                dataType: "json",
                contentType: "application/json",
                url: '../api/25/analytics.json?dimension=dx:rtJChfVTmu7;LbnFL8X21GT&dimension=pe:' + last7days +
                '&filter=ou:leMGqLV90eH&displayProperty=NAME',
                success: function (dhis_rows) {
                    x_categories = [];
                    for (var j = 0; j < dhis_rows.metaData.pe.length; j++) {
                        x_categories.push(dhis_rows.metaData.pe[j]);
                    }
                    for (var i = 0; i < dhis_rows.rows.length; i++) {
                        if (dhis_rows.rows[i][0] == "rtJChfVTmu7") {
                            //                            ip_fever_disease.ip_fever_denguepush({
                            //                                "name":"Dengue case",
                            //                                "period" :dhis_rows.rows[i][1],
                            //                                "value"  : dhis_rows.rows[i][2]
                            //                            });

                            ip_fever_dengue_cases.push(Number(dhis_rows.rows[i][2]));

                        } else if (dhis_rows.rows[i][0] == "LbnFL8X21GT") {
                            //                           ip_fever_disease.ip_fever_scrub.push({
                            //                               "name":"Scrub typhus case",
                            //                               "period" :dhis_rows.rows[i][1],
                            //                               "value"  : dhis_rows.rows[i][2]
                            //                           });
                            ip_fever_scrub_cases.push(Number(dhis_rows.rows[i][2]));

                        }
                    }


                    generatechart_ipfever_disease(x_categories, ip_fever_dengue_cases, ip_fever_scrub_cases);
                },
                error: function (response) {

                }
            });

            $.ajax({
                async: false,
                type: "GET",
                dataType: "json",
                contentType: "application/json",
                url: '../api/25/analytics.json?dimension=dx:yldg0WX82FD&dimension=pe:' + last7days +
                '&dimension=ou:leMGqLV90eH&displayProperty=NAME',
                success: function (dhis_rows) {
                    x_categories = [];
                    for (var j = 0; j < dhis_rows.metaData.pe.length; j++) {
                        x_categories.push(dhis_rows.metaData.pe[j]);

                    }
                    for (var i = 0; i < dhis_rows.rows.length; i++) {

                        if (dhis_rows.rows[i][0] == "yldg0WX82FD") {
                            //                           op_cases.op_fever_cases({
                            //                               "name":"Outpatient fever case",
                            //                               "period" :dhis_rows.rows[i][1],
                            //                               "value"  : dhis_rows.rows[i][2]
                            //                           });


                            //opcases.push(Number(dhis_rows.rows[i][3]));
                            opcases.ouperiod.push(dhis_rows.rows[i][1]);
                            opcases.ouval.push(Number(dhis_rows.rows[i][3]));
                        }
                    }
//                    for(var i=0;i<x_categories.length;i++)
//                    {
//                        if(opcases.ouperiod.includes(x_categories[i]))
//                        {
//
//                        }
//                        else
//                        {
//                            opcases.ouval.push(0);
//                            opcases.ouperiod.push(x_categories[i]);
//                        }
//                    }
                    opcases.ouval.reverse();
                    opcases.ouperiod.reverse();

                    linechart_op(opcases.ouperiod, opcases.ouval);
                },
                error: function (response) {

                }
            });

            $.ajax({
                async: false,
                type: "GET",
                dataType: "json",
                contentType: "application/json",
                url: '../api/25/analytics.json?dimension=dx:kI1lGixi5a5&dimension=pe:' + last7days +
                '&filter=ou:leMGqLV90eH&displayProperty=NAME',
                success: function (dhis_rows) {
                    x_categories = [];
                    for (var i = 0; i < dhis_rows.metaData.pe.length; i++) {
                        x_categories.push(dhis_rows.metaData.pe[i]);
                    }
                    for (var i = 0; i < dhis_rows.rows.length; i++) {
                        if (dhis_rows.rows[i][0] == "kI1lGixi5a5") {
                            //                           ip_cases.ip_fever_cases({
                            //                               "name":"Inpatient fever case",
                            //                               "period" :dhis_rows.rows[i][1],
                            //                               "value"  : dhis_rows.rows[i][2]
                            //                           });

                            ipcases.push(Number(dhis_rows.rows[i][2]));
                            //                            x_categories.push(dhis_rows.rows[i][1]);
                        }
                    }
//                    x_categories.reverse();
                    ipcases.reverse();

                    linechart_ip(x_categories, ipcases);
                },
                error: function (response) {

                }
            });
            ///
            $.ajax({
                async: false,
                type: "GET",
                dataType: "json",
                contentType: "application/json",
                url: '../api/25/analytics.json?dimension=dx:BZW0y6OUSVS&dimension=pe:' + last7days +
                '&filter=ou:leMGqLV90eH&displayProperty=NAME',
                success: function (dhis_rows) {
                    x_categories = [];
                    for (var i = 0; i < dhis_rows.metaData.pe.length; i++) {
                        x_categories.push(dhis_rows.metaData.pe[i]);
                    }

                    for (var i = 0; i < dhis_rows.rows.length; i++) {
                        if (dhis_rows.rows[i][0] == "BZW0y6OUSVS") {

                            labconfirmedcases.push(Number(dhis_rows.rows[i][2]));

                        }
                    }


                    linechart_fever(x_categories, labconfirmedcases);
                },
                error: function (response) {

                }
            });


            $.getJSON("../api/organisationUnits?filter=level:eq:5&fields=id,name,coordinates&paging=false", function (response) {

                addOrgUnits(getCoordinatesFromOus(response.organisationUnits), style);

            });

            $.getJSON("../api/organisationUnits?filter=level:eq:6&fields=id,name,coordinates&paging=false", function (response) {

                addOrgUnits1(getCoordinatesFromOus(response.organisationUnits), style);

            });
            $.getJSON("../api/organisationUnits?filter=level:eq:7&fields=id,name,coordinates&paging=false", function (response) {

                addOrgUnits2(getCoordinatesFromOus(response.organisationUnits), style);

            });

            function addOrgUnits1(blockCoords, style) {
                var mp = {
                    "type": "Feature",
                    "geometry": {
                        "type": "MultiPolygon",
                        "coordinates": blockCoords
                    },
                    "properties": {
                        "name": "MultiPolygon",
                        key: "block"
                    }
                };
                L.geoJson(mp, {
                    style: function () {
                        return {
                            color: "gray",
                            opacity: 0.75,
                            dashArray: '5, 5',
                            weight: 3

                        }
                    }
                }).addTo(map1);
            }

            function addOrgUnits2(blockCoords, style) {
                var mp = {
                    "type": "Feature",
                    "geometry": {
                        "type": "MultiPolygon",
                        "coordinates": blockCoords
                    },
                    "properties": {
                        "name": "MultiPolygon",
                        key: "block"
                    }
                };
                L.geoJson(mp, {
                    style: function () {
                        return {
                            color: "gray",
                            opacity: 0.75,

                        }
                    }
                }).addTo(map1);
            }

            function addOrgUnits(blockCoords, style) {
                var mp = {
                    "type": "Feature",
                    "geometry": {
                        "type": "MultiPolygon",
                        "coordinates": blockCoords
                    },
                    "properties": {
                        "name": "MultiPolygon",
                        key: "block"
                    }
                };
                //bindtooltip to polygon

//                mp.bindTooltip("My polygon",
//                    {permanent: true, direction:"center"}
//                ).openTooltip();

                L.geoJson(mp, {
                    style: function () {
                        return {
                            color: "black",
                            opacity: 0.75,
                            fillColor: "blue",
                            fillOpacity: 0.1,
                            dashArray: '5, 5',
                            weight: 3

                        }
                    }
                }).addTo(map1);

                var markers = new L.FeatureGroup();
                map1.removeLayer(markers);
                markers.clearLayers();
                //           ../api/analytics/events/query/X2XfE0rYiwk.json?stage=apqU6esBuwV&dimension=pe:LAST_12_MONTHS&dimension=ou:WXW1rhM9hgR&dimension=ALvy8yTD1Np&dimension=gPGTS8eGa4i&dimension=oqTYHlWrWBh&dimension=oDg3FLcVw0R&dimension=J6uckqQfkyc&displayProperty=NAME

                function getCustomIcon(path) {
                    return new L.Icon({
                        //  iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png',
                        iconUrl: path,
                        //  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
                        iconSize: [20, 20],
                        iconAnchor: [6, 1],
                        popupAnchor: [1, -34],
                    });

                }

                function getCustomIcon1(path) {
                    return new L.Icon({
                        //  iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png',
                        iconUrl: path,
                        //  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
                        iconSize: [20, 15],
                        iconAnchor: [4, 2],
                        popupAnchor: [2, -25],
                    });

                }

                function getCustomIcon2(path) {
                    return new L.Icon({
                        //  iconUrl: 'https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png',
                        iconUrl: path,
                        //  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
                        iconSize: [10, 10],
                        iconAnchor: [3, 1],
                        popupAnchor: [3, -18],
                    });

                }

                $.getJSON(
                        "../api/trackedEntityInstances.json?ou=mnbTnDyJ37p&ouMode=DESCENDANTS&paging=false&program=mcnt7nqNrNw&programStartDate="+previousdy_7_+"&programEndDate="+previousdy1_,
                        function (data) {
                            for (var i = 0; i < data.trackedEntityInstances.length; i++) {

                                for (var j = 0; j < data.trackedEntityInstances[i].attributes.length; j++) {
                                    if ((data.trackedEntityInstances[i].attributes[j].attribute == "vCeMi4DtfEC" && data
                                                    .trackedEntityInstances[i].attributes[j].valueType == "TRUE_ONLY") &&(data.trackedEntityInstances[i].attributes[j].attribute == "k0L2KR4ZrU2" &&
                                            data.trackedEntityInstances[i].attributes[j].valueType == "TRUE_ONLY") ) {

                                        var village_name;
                                        $.ajax({
                                            async: false,
                                            type: "GET",
                                            dataType: "json",
                                            contentType: "application/json",
                                            url: '../api/organisationUnits/' + data.trackedEntityInstances[i].orgUnit + '.json?fields=name,id',
                                            success: function (data) {

                                                village_name=data.name;
                                            }
                                        });
                                        for (var k = 0; k < data.trackedEntityInstances[i].attributes.length; k++) {
                                            if (data.trackedEntityInstances[i].attributes[k].attribute == "sanq4S5uYdb") {
                                                var coordinate = jQuery.parseJSON(data.trackedEntityInstances[i].attributes[
                                                        k].value);
                                                console.log("5afi", coordinate.latitude);
                                                var marker = L.marker([coordinate.latitude, coordinate.longitude], {
                                                    icon: getCustomIcon1(afi_5)
                                                }).bindTooltip(village_name,
                                                        {
                                                            permanent: true,
                                                            direction: 'right'

                                                        });
                                                markers.addLayer(marker);

                                            }


                                        }

                                    }
                                    else if(data.trackedEntityInstances[i].attributes[j].attribute == "vCeMi4DtfEC" && data
                                                    .trackedEntityInstances[i].attributes[j].valueType == "TRUE_ONLY")
                                    {
                                        var village_name;
                                        $.ajax({
                                            async: false,
                                            type: "GET",
                                            dataType: "json",
                                            contentType: "application/json",
                                            url: '../api/organisationUnits/' + data.trackedEntityInstances[i].orgUnit + '.json?fields=name,id',
                                            success: function (data) {

                                                village_name=data.name;
                                            }
                                        });
                                        for (var k = 0; k < data.trackedEntityInstances[i].attributes.length; k++) {
                                            if (data.trackedEntityInstances[i].attributes[k].attribute == "sanq4S5uYdb") {
                                                var coordinate = jQuery.parseJSON(data.trackedEntityInstances[i].attributes[
                                                        k].value);
                                                //  var marker = L.marker([coordinate.latitude,coordinate.longitude], {radius:5,fillColor: "#FF0000",color:"#FF0000"}).addTo(map1).bindPopup("</br><strong>Organisation unit:</strong>");
                                                console.log("afi", coordinate.latitude);
                                                var marker = L.marker([coordinate.latitude, coordinate.longitude], {
                                                    icon: getCustomIcon(afi_3)
                                                }).bindTooltip(village_name,
                                                    {
                                                        permanent: true,
                                                        direction: 'right'
                                                    });
                                                markers.addLayer(marker);
                                            }


                                        }
                                    }
                                    else if (data.trackedEntityInstances[i].attributes[j].attribute == "k0L2KR4ZrU2" &&
                                            data.trackedEntityInstances[i].attributes[j].valueType == "TRUE_ONLY") {
                                        var village_name;
                                        $.ajax({
                                            async: false,
                                            type: "GET",
                                            dataType: "json",
                                            contentType: "application/json",
                                            url: '../api/organisationUnits/' + data.trackedEntityInstances[i].orgUnit + '.json?fields=name,id',
                                            success: function (data) {

                                                village_name=data.name;
                                            }
                                        });
                                        for (var k = 0; k < data.trackedEntityInstances[i].attributes.length; k++) {
                                            if (data.trackedEntityInstances[i].attributes[k].attribute == "sanq4S5uYdb") {
                                                var coordinate = jQuery.parseJSON(data.trackedEntityInstances[i].attributes[
                                                        k].value);
                                                var marker = L.marker([coordinate.latitude, coordinate.longitude], {
                                                    icon: getCustomIcon1(afi_5)
                                                }).bindTooltip(village_name,
                                                    {
                                                        permanent: true,
                                                        direction: 'right'
                                                    });
                                                markers.addLayer(marker);

                                            }


                                        }

                                    }
                                    else if (data.trackedEntityInstances[i].attributes[j].attribute == "nMC9jWaMUTA" &&
                                            data.trackedEntityInstances[i].attributes[j].valueType == "TRUE_ONLY") {
                                        var village_name;
                                        $.ajax({
                                            async: false,
                                            type: "GET",
                                            dataType: "json",
                                            contentType: "application/json",
                                            url: '../api/organisationUnits/' + data.trackedEntityInstances[i].orgUnit + '.json?fields=name,id',
                                            success: function (data) {

                                                village_name=data.name;
                                            }
                                        });
                                        for (var k = 0; k < data.trackedEntityInstances[i].attributes.length; k++) {
                                            if (data.trackedEntityInstances[i].attributes[k].attribute == "sanq4S5uYdb") {
                                                var coordinate = jQuery.parseJSON(data.trackedEntityInstances[i].attributes[
                                                        k].value);
                                                var marker = L.marker([coordinate.latitude, coordinate.longitude], {
                                                    icon: getCustomIcon2(lab_1)
                                                }).bindTooltip(village_name,
                                                    {
                                                        permanent: true,
                                                        direction: 'right'
                                                    });
                                                markers.addLayer(marker);

                                            }


                                        }
                                    }

                                    else if (data.trackedEntityInstances[i].attributes[j].attribute == "sBmb7HfvAau" &&
                                            data.trackedEntityInstances[i].attributes[j].value == "MANUAL") {
                                        var village_name;
                                        $.ajax({
                                            async: false,
                                            type: "GET",
                                            dataType: "json",
                                            contentType: "application/json",
                                            url: '../api/organisationUnits/' + data.trackedEntityInstances[i].orgUnit + '.json?fields=name,id',
                                            success: function (data) {

                                                village_name=data.name;
                                            }
                                        });
                                        for (var k = 0; k < data.trackedEntityInstances[i].attributes.length; k++) {
                                            if (data.trackedEntityInstances[i].attributes[k].attribute == "sanq4S5uYdb") {
                                                var coordinate = jQuery.parseJSON(data.trackedEntityInstances[i].attributes[
                                                        k].value);
                                                var marker = L.marker([coordinate.latitude, coordinate.longitude]).bindTooltip(village_name,
                                                    {
                                                        permanent: true,
                                                        direction: 'right'
                                                    });
                                                markers.addLayer(marker);

                                            }


                                        }
                                    }
                                    map1.addLayer(markers);


                                }

                            }

                        });

            }

            function getCoordinatesFromOus(ous) {

                var ouCoords = [];
                for (var key in ous) {
                    if (ous[key].coordinates) {
                        var coords = JSON.parse(ous[key].coordinates);
                        ouCoords.push(coords[0]);
                    }
                }
                return ouCoords;
            }


            //       var tableapi1 = "../api/analytics/events/query/X2XfE0rYiwk.json?stage=apqU6esBuwV&dimension=pe:"+previousdy1+"&dimension=ou:WXW1rhM9hgR&dimension=J6uckqQfkyc&displayProperty=NAME";
            //        var tableapi1 = "../api/analytics/events/query/X2XfE0rYiwk.json?stage=apqU6esBuwV&dimension=pe:201704&dimension=ou:WXW1rhM9hgR&dimension=J6uckqQfkyc&displayProperty=NAME";
            //.._new/api/25/analytics.json?dimension=dx:e6qQDlAI6Ip&dimension=pe:201704;THIS_MONTH&dimension=ou:LEVEL-5;MsT9tgwdP6O&displayProperty=NAME
            //http://139.162.61.147/nieodk_new/api/analytics/events/aggregate/c9LK7wM2Xmp.json?stage=ZGmVJcrAdCg&dimension=pe:20170403;20170404;20170405;20170406;20170407;20170408;20170409;20170410;20170411&dimension=ou:qLF0yxbuu3J;oQiIF11GRkq;OlpHeG8wg5G;p8owHNW7a5M;liRnUNvwzJ8;JBcbCk9PPhd;LJTJSWhgvfV;IeAhonT5eOy;x9VXjsVqjzY;jO1VAyfm7Iu;cKaijVEUvuL;fPJTpLPYkCU;hpC6Vx7stxf&filter=K7NJ8bJ2FGO&filter=gkeo5Y1FXI0&filter=kt5ERcpzDUb&filter=TgSqfxROLds&filter=uyC3A25ESDb&outputType=EVENT&displayProperty=NAME
            //http://139.162.61.147/nieodk_new/api/analytics/events/aggregate/c9LK7wM2Xmp.json?stage=ZGmVJcrAdCg&dimension=pe:20170405;20170406;20170407;20170408;20170409;20170410;20170411&dimension=ou:hpC6Vx7stxf;oQiIF11GRkq;cKaijVEUvuL;p8owHNW7a5M;qLF0yxbuu3J;x9VXjsVqjzY;OlpHeG8wg5G;fPJTpLPYkCU;liRnUNvwzJ8;LJTJSWhgvfV;IeAhonT5eOy;JBcbCk9PPhd;jO1VAyfm7Iu&outputType=EVENT&displayProperty=NAME
            //        $.getJSON("../api/analytics/events/query/c9LK7wM2Xmp.json?stage=ZGmVJcrAdCg&dimension=pe:"+last7days+"&dimension=ou:LgELCKWvRP1&dimension=K7NJ8bJ2FGO&displayProperty=NAME", function (odfjson1,id) {
            //      /
            //http://139.162.61.147/nieodk_new/api/analytics/events/query/c9LK7wM2Xmp.json?stage=ZGmVJcrAdCg&dimension=pe:20170407;20170408;20170409;20170405;20170406;20170403;20170404&dimension=ou:LEVEL-5;leMGqLV90eH&dimension=K7NJ8bJ2FGO&displayProperty=NAME
            //http://139.162.61.147/nieodk_new/api/analytics/events/aggregate/c9LK7wM2Xmp.json?stage=ZGmVJcrAdCg&dimension=pe:20170405;20170406;20170407;20170408;20170409;20170410;20170411&dimension=ou:LEVEL-5;leMGqLV90eH&filter=K7NJ8bJ2FGO&outputType=EVENT&displayProperty=NAME


            $.getJSON("../api/analytics/events/aggregate/Ml0ZNj9APN0.json?stage=iWcQ5lxmsy4&dimension=pe:" + last7days +
                    "&dimension=ou:LEVEL-5;mnbTnDyJ37p&outputType=EVENT&displayProperty=NAME",
                    function (odfjson1, id) {
                        var map = [],
                                count;
                        for (var i = 0; i < odfjson1.rows.length; i++) {
                            if (!map[odfjson1.rows[i][1]]) {
                                map[odfjson1.rows[i][1]] = [];
                            }
                            map[odfjson1.rows[i][1]].push(odfjson1.rows[i]);
                        }

                        for (var j = 0; j < Object.keys(map).length; j++) {
                            count = 0;
                            $.ajax({
                                async: false,
                                type: "GET",
                                dataType: "json",
                                contentType: "application/json",
                                url: '../api/organisationUnits/' + Object.keys(map)[j] + '.json?fields=name,id',
                                success: function (data) {

                                    taluk_count_07.orgname.push(data.name);
                                }
                            });


                            for (var i = 0; i < Object.values(map)[j].length; i++) {
                                count = Number(count) + Number(Object.values(map)[j][i][2]);

                            }
                            taluk_count_07.orgcount.push(Math.round(count / 7));

                        }
                        if(taluk_count_07.orgname.length<14)
                        {
                            taluk_count_07.orgname.push("Puzhal");
                            taluk_count_07.orgcount.push(0);
                        }
                       else
                        {

                        }
                        $.ajax({
                            async: false,
                            type: "GET",
                            dataType: "json",
                            contentType: "application/json",
                            url: '../api/analytics/events/aggregate/Ml0ZNj9APN0.json?stage=iWcQ5lxmsy4&dimension=pe:' + last30days +
                            '&dimension=ou:LEVEL-5;mnbTnDyJ37p&outputType=EVENT&displayProperty=NAME',
                            success: function (odfjson1, id) {
                                var map = [],
                                        count = 0;
                                for (var i = 0; i < odfjson1.rows.length; i++) {
                                    if (!map[odfjson1.rows[i][1]]) {
                                        map[odfjson1.rows[i][1]] = [];
                                    }
                                    map[odfjson1.rows[i][1]].push(odfjson1.rows[i]);
                                }

                                for (var j = 0; j < Object.keys(map).length; j++) {


                                    $.ajax({
                                        async: false,
                                        type: "GET",
                                        dataType: "json",
                                        contentType: "application/json",
                                        url: '../api/organisationUnits/' + Object.keys(map)[j] +
                                        '.json?fields=name,id',
                                        success: function (data) {

                                            taluk_count_30.orgname.push(data.name);
                                        }
                                    });
                                    //                    $.getJSON("../api/organisationUnits/"+Object.keys(map)[j]+".json?fields=name,id", function (item,data) {
                                    //
                                    //
                                    //                    });


                                    for (var i = 0; i < Object.values(map)[j].length; i++) {
                                        count = Number(count) + Number(Object.values(map)[j][i][2]);

                                    }
                                    taluk_count_30.orgcount.push(Math.round(count / 30));
                                    count = 0;
                                    //                    taluk_count_30.orgcount.push(Object.values(map)[j].length);
                                }
                            },
                            error: function (response) {
                            }
                        });
//                        $.getJSON("../api/analytics/events/aggregate/Ml0ZNj9APN0.json?stage=iWcQ5lxmsy4&dimension=pe:" + last30days +
//                                "&dimension=ou:LEVEL-5;mnbTnDyJ37p&outputType=EVENT&displayProperty=NAME",
//                                function (odfjson1, id) {
//                                    var map = [],
//                                            count = 0;
//                                    for (var i = 0; i < odfjson1.rows.length; i++) {
//                                        if (!map[odfjson1.rows[i][1]]) {
//                                            map[odfjson1.rows[i][1]] = [];
//                                        }
//                                        map[odfjson1.rows[i][1]].push(odfjson1.rows[i]);
//                                    }
//
//                                    for (var j = 0; j < Object.keys(map).length; j++) {
//
//
//                                        $.ajax({
//                                            async: false,
//                                            type: "GET",
//                                            dataType: "json",
//                                            contentType: "application/json",
//                                            url: '../api/organisationUnits/' + Object.keys(map)[j] +
//                                            '.json?fields=name,id',
//                                            success: function (data) {
//
//                                                taluk_count_30.orgname.push(data.name);
//                                            }
//                                        });
//                                        //                    $.getJSON("../api/organisationUnits/"+Object.keys(map)[j]+".json?fields=name,id", function (item,data) {
//                                        //
//                                        //
//                                        //                    });
//
//
//                                        for (var i = 0; i < Object.values(map)[j].length; i++) {
//                                            count = Number(count) + Number(Object.values(map)[j][i][2]);
//
//                                        }
//                                        taluk_count_30.orgcount.push(Math.round(count / 30));
//                                        count = 0;
//                                        //                    taluk_count_30.orgcount.push(Object.values(map)[j].length);
//                                    }
//
//                                });

//                        $.getJSON("../api/analytics/events/aggregate/Ml0ZNj9APN0.json?stage=iWcQ5lxmsy4&dimension=pe:"+today_fortable+"&dimension=ou:LEVEL-5;mnbTnDyJ37p&outputType=EVENT&displayProperty=NAME",
//                                function (odfjson1, id) {
//                                    var map = [],
//                                            count = 0;
//                                    for (var i = 0; i < odfjson1.rows.length; i++) {
//                                        if (!map[odfjson1.rows[i][1]]) {
//                                            map[odfjson1.rows[i][1]] = [];
//                                        }
//                                        map[odfjson1.rows[i][1]].push(odfjson1.rows[i]);
//                                    }
//
//                                    for (var j = 0; j < Object.keys(map).length; j++) {
//
//
//                                        $.ajax({
//                                            async: false,
//                                            type: "GET",
//                                            dataType: "json",
//                                            contentType: "application/json",
//                                            url: '../api/organisationUnits/' + Object.keys(map)[j] +
//                                            '.json?fields=name,id',
//                                            success: function (data) {
//
//                                                taluk_count_01.orgname.push(data.name);
//                                            }
//                                        });
//
//                                        for (var i = 0; i < Object.values(map)[j].length; i++) {
//                                            count = Number(count) + Number(Object.values(map)[j][i][2]);
//
//                                        }
//                                        taluk_count_01.orgcount.push(Math.round(count));
//                                        count = 0;
//                                        //                    taluk_count_30.orgcount.push(Object.values(map)[j].length);
//                                    }
//
//                                    generatetable(today_,taluk_count_07, taluk_count_30, taluk_count_01);
//                                });
                        $.ajax({
                            async: false,
                            type: "GET",
                            dataType: "json",
                            contentType: "application/json",
                            url: '../api/analytics/events/aggregate/Ml0ZNj9APN0.json?stage=iWcQ5lxmsy4&dimension=pe:'+today_fortable+'&dimension=ou:LEVEL-5;mnbTnDyJ37p&outputType=EVENT&displayProperty=NAME',
                            success: function (odfjson1, id) {
                                var map = [],
                                        count = 0;
                                for (var i = 0; i < odfjson1.rows.length; i++) {
                                    if (!map[odfjson1.rows[i][1]]) {
                                        map[odfjson1.rows[i][1]] = [];
                                    }
                                    map[odfjson1.rows[i][1]].push(odfjson1.rows[i]);
                                }

                                for (var j = 0; j < Object.keys(map).length; j++) {


                                    $.ajax({
                                        async: false,
                                        type: "GET",
                                        dataType: "json",
                                        contentType: "application/json",
                                        url: '../api/organisationUnits/' + Object.keys(map)[j] +
                                        '.json?fields=name,id',
                                        success: function (data) {

                                            taluk_count_01.orgname.push(data.name);
                                        }
                                    });

                                    for (var i = 0; i < Object.values(map)[j].length; i++) {
                                        count = Number(count) + Number(Object.values(map)[j][i][2]);

                                    }
                                    taluk_count_01.orgcount.push(Math.round(count));
                                    count = 0;
                                    //                    taluk_count_30.orgcount.push(Object.values(map)[j].length);
                                }

                                generatetable(today_,taluk_count_07, taluk_count_30, taluk_count_01);
                            },
                            error: function (response) {
                            }
                        });

                    });


        }
    function generatetable(today_,taluk_count_07, taluk_count_30, taluk_count_01) {
        var tablerow = "";
        for (var tab = 0; tab < taluk_count_07.orgname.length; tab++) {

            if (taluk_count_01.orgname.includes(taluk_count_07.orgname[tab])) {
            }
            else {
                taluk_count_01.orgname.push(taluk_count_07.orgname[tab]);
                taluk_count_01.orgcount.push(0);
            }


            if (taluk_count_01.orgcount[tab] == "undefined" || taluk_count_01.orgcount[tab] == "" || taluk_count_01.orgcount[tab] == null) {

                taluk_count_01.orgcount[tab] = "-";
            }
            if (taluk_count_07.orgcount[tab] == "undefined" || taluk_count_07.orgcount[tab] == "" || taluk_count_07.orgcount[tab] == null) {

                taluk_count_07.orgcount[tab] = "-";
            }
            if (taluk_count_30.orgcount[tab] == "undefined" || taluk_count_30.orgcount[tab] == "" || taluk_count_30.orgcount[tab] == null) {
                taluk_count_30.orgcount[tab] = "-";
            }

        }
        for (var tab = 0; tab < taluk_count_07.orgname.length; tab++) {

             for(var i=0;i<taluk_count_01.orgname.length;i++)
             {
                 if(taluk_count_07.orgname[tab]==taluk_count_01.orgname[i])
                 {
                     tablerow += "<tr style='padding-bottom: 1em;'><td style='text-align:left;'>" + parseInt(parseInt(tab)+1)  + "</td><td style='text-align:left;'>" +
                         taluk_count_07.orgname[tab] + "</td><td style='text-align:left;'>" + taluk_count_01.orgcount[i] +
                         "</td><td style='text-align:left;'>" + taluk_count_07.orgcount[tab] +
                         "</td><td style='text-align:left;'>" + taluk_count_30.orgcount[tab] + "</td></tr>";
                     taluk_chart_data.push(Math.round(taluk_count_07.orgcount[tab] - taluk_count_30.orgcount[tab]));
                     taluk_chart_data_name.push((taluk_count_07.orgname[tab]));

                     if(taluk_count_01.orgcount[i]=="-"){taluk_count_01.orgcount[i]=0;}
                     if(taluk_count_07.orgcount[tab]=="-"){taluk_count_07.orgcount[tab]=0;}
                     if(taluk_count_30.orgcount[tab]=="-"){taluk_count_30.orgcount[tab]=0;}
                     total_1day +=parseInt(taluk_count_01.orgcount[i]);
                     total_7day +=parseInt(taluk_count_07.orgcount[tab]);
                     total_30day+=parseInt(taluk_count_30.orgcount[tab]);
                 }
                 else
                 {

                 }
             }



        }
        var _7day=total_1day.toString();
        var _1day=total_7day.toString();
        var _30day=total_30day.toString();

//        removeSpecialChars(total_7day.toString());
//        removeSpecialChars(total_1day.toString());
//        removeSpecialChars(total_30day.toString());

        _7day.replace(/[^a-zA-Z ]/g, "");
        _1day.replace(/[^a-zA-Z ]/g, "");
        _30day.replace(/[^a-zA-Z ]/g, "");

        console.log(_7day);
        console.log(_1day);
        console.log(_30day);
        //remove -/
        function removeSpecialChars(str) {
            return str.replace(/(?!\w|\s)./g, '')
                    .replace(/\s+/g, ' ')
                    .replace(/^(\s*)([\W\w]*)(\b\s*$)/g, '$2');
        }


        var tableheading =
            "<tr><td style='text-align:left;'> S.No  </td><td style='text-align:left;'>Name of the Block </td><td style='text-align:left;'>" +
            "IP-"+today_+

            "</td><td style='text-align:left;'>Last 7 Days (Average)</td><td style='text-align:left;'>Last 30 Days(Average)</td></tr>";
        //to DO add a Total at the end of row
        var table_total =
            "<tr><td style='text-align:left;'> Total </td><td style='text-align:left;'> </td><td style='text-align:left;'>" + total_1day+
            "</td><td style='text-align:left;'>"+total_7day+"</td><td style='text-align:left;'>"+total_30day+"</td></tr>";

        var table = "<table style='margin-left: 12%; width: 80%;height: 40%;margin-bottom:5%;margin-top:5%;'>" + tableheading + tablerow +table_total
            "</table>";
        document.getElementById("summary").innerHTML = table;

        generatechart_taluk(taluk_chart_data);
    }

    function generatechart_taluk(taluk_chart_data) {
        taluk_chart_data.reverse();
        taluk_chart_data_name.reverse();
        Highcharts.chart('sumamry_chart', {
            chart: {
                type: 'bar'
            },
            title: {
                text: 'Difference of last 7 days average and last 30 days average'
            },
            xAxis: [{
                categories: taluk_chart_data_name,
                reversed: false,
                labels: {
                    step: 1,
                    style: {
                        fontSize: '12px'
                    }
                }
            }, { // mirror axis on right side
                opposite: true,
                reversed: false,
                categories: "",
                linkedTo: 0,
                labels: {
                    step: 1
                }
            }],
            yAxis: {
                allowDecimals: false,
                title: {
                    text: null
                },
                plotLines: [{
                    color: 'black',
                    width: 2,
                    value: 0
                }],
                labels: {
                    style: {
                        padding: '70%'
                    },
                    formatter: function () {
                        return Math.abs(this.value) + '';
                    },


                },

            },

            plotOptions: {
                bar: {
                    zones: [{
                        value: 0, // Values up to 10 (not including) ...
                        color: 'red', // ... have the color blue.
                        label:'Negative -----'
                    },{
                        color: 'blue' ,// Values from 10 (including) and up have the color red
                        label:'Positive -----'
                    }]
                }
            },

            tooltip: {
                formatter: function () {
                    return '<b>' + this.series.name + ', age ' + this.point.category + '</b><br/>' +
                        'Population: ' + Highcharts.numberFormat(Math.abs(this.point.y), 0);
                }
            },

            series: [{
                dataLabels: {
                    enabled: true,
                    color: 'black'
                },
                name: "IP Difference",
                data: taluk_chart_data
            }]
        });

//        Highcharts.chart('sumamry_chart', {
//            chart: {
//                type: 'column'
//            },
//            title: {
//                text: 'Difference of Last 7 & 30 Days(average)'
//            },
//            xAxis: {
//                categories: taluk_chart_data_name
//            },
//            credits: {
//                enabled: false
//            },
//            series: [{
//                name: "IP Difference",
//                data: taluk_chart_data
//            }]
//        });

    }

    function generatechart_ipfever_male_female(x_categories, ip_fever_male_data, ip_fever_female_data) {
        Highcharts.chart('container', {
            chart: {
                type: 'column'
            },
            title: {
                text: 'IP Fever Cases'
            },
            xAxis: {
                categories: x_categories,
                max: 6,
                labels: {
                    enabled: false
                },
            },
            yAxis: {
                min: 0,
                title: {
                    text: 'Fever Cases by Gender'
                },
                plotOptions: {
                    bar: {
                        dataLabels: {
                            enabled: true
                        }
                    }
                }
            },
            plotOptions: {
                series: {
                    dataLabels: {
                        enabled: true,
                    }
                }
            },

            tooltip: {
                pointFormat: '<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b> ({point.percentage:.0f}%)<br/>',
                shared: true
            },
            plotOptions: {
                column: {
                    stacking: 'percent'
                }
            },
            series: [{
                dataLabels: {
                    enabled: true,
                    color: 'black'
                },
                name: "Male",
                data: ip_fever_male_data
            }, {
                dataLabels: {
                    enabled: true,
                    color: 'red'
                },
                name: "Female",
                data: ip_fever_female_data
            }]
        });
    }

    function generatechart_ipfever_age(x_categories, ip_fever_age12, ip_fever_agel, ip_fever_age1to5,
                                       ip_fever_ageg6to12) {
        Highcharts.chart('container1', {
            chart: {
                type: 'column'
            },
            title: {
                text: 'IP Fever Cases by Age'
            },
            xAxis: {
                categories: x_categories,
                max: 6,
                labels: {
                    enabled: false
                },
            },
            yAxis: {
                min: 0,
                title: {
                    text: 'Fever Cases'
                },
                plotOptions: {
                    bar: {
                        dataLabels: {
                            enabled: true
                        }
                    }
                }
            },

            tooltip: {
                pointFormat: '<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b> ({point.percentage:.0f}%)<br/>',
                shared: true
            },
            plotOptions: {
                dataLabels: {
                    enabled: true,
                },
                column: {
                    stacking: 'percent'
                }
            },
            series: [{
                dataLabels: {
                    enabled: true,
                    color: 'black'
                },
                name: "IP fever case (age > 12 yrs)",
                data: ip_fever_age12
            }, {
                dataLabels: {
                    enabled: true,
                    color: 'green'
                },
                name: "IP fever case (age 6-12 yrs)",
                data: ip_fever_ageg6to12
            }, {
                dataLabels: {
                    enabled: true,
                    color: 'red'
                },
                name: "IP fever case (age 1-5 yrs)",
                data: ip_fever_age1to5
            }, {
                dataLabels: {
                    enabled: true,
                    color: 'blue'
                },
                name: "IP fever case (age < 1 year)",
                data: ip_fever_agel
            }]
        });
    }

    function generatechart_ipfever_disease(x_categories, ip_fever_dengue_cases, ip_fever_scrub_cases) {
        Highcharts.chart('container2', {
            chart: {
                type: 'column'
            },
            title: {
                text: 'IP Fever Cases By Disease'
            },
            xAxis: {
                categories: x_categories,
                min: 0,
                max: 6
            },
            column: {
                minPointLength: 7
            },
            yAxis: {
                min: 0,
                title: {
                    text: 'Fever Cases'
                },
            },
            tooltip: {
                pointFormat: '<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b> ({point.percentage:.0f}%)<br/>',
                shared: true
            },
            plotOptions: {
                dataLabels: {
                    enabled: true,
                },
                column: {
                    stacking: 'percent'
                }
            },
            series: [{
                dataLabels: {
                    enabled: true,
                    color: 'black'
                },
                name: "Dengue",
                data: ip_fever_dengue_cases
            }, {
                dataLabels: {
                    enabled: true,
                    color: 'blue'
                },
                name: "Scrub",
                data: ip_fever_scrub_cases
            }]
        });
    }

    function linechart_op(x_categories, opcases) {
        var target = 0;
        var oplast30days = '../api/25/analytics.json?dimension=dx:yldg0WX82FD&dimension=pe:' + last30days +
            '&filter=ou:leMGqLV90eH&displayProperty=NAME'

        //http://139.162.61.147/nieodk_new/api/25/analytics.json?dimension=dx:UZosWdLr0UC&dimension=pe:20170506;20170507;20170508;20170509;20170510;20170505;20170504;20170503;20170502;20170512;20170511;20170514;20170513;20170515;20170516;20170519;20170520;20170521;20170522;20170523;20170524;20170525;20170526;20170518;20170517;20170501;20170531;20170530;20170529;20170528;20170527&filter=ou:mnbTnDyJ37p&displayProperty=NAME
        $.ajax({
            async: false,
            type: "GET",
            dataType: "json",
            contentType: "application/json",
            url: '../api/25/analytics.json?dimension=dx:yldg0WX82FD&dimension=pe:' + last30days +
            '&filter=ou:leMGqLV90eH&displayProperty=NAME',
            success: function (data_op) {
                for (var i = 0; i < data_op.rows.length; i++) {
                    target += parseInt(data_op.rows[i][2]);

                }
                target = target / 30;

            },
            error: function (response) {
            }
        });
        Highcharts.chart('container_op', {

            title: {
                text: 'OP Cases'
            },

            subtitle: {
                text: 'OP Cases'
            },
            xAxis: {
                categories: x_categories,
                min: 0,
                max: 6,
                labels: {
                    enabled: false
                }
            },
            yAxis: {
                title: {
                    text: 'OP Cases'
                },
                plotLines: [{
                    value: target,
                    color: 'green',
                    dashStyle: 'shortdash',
                    width: 2,
                    label: {
                        text: 'Last 30 Days Target'
                    }
                }]
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'middle'
            },
            series: [{
                dataLabels: {
                    enabled: true,
                    color: 'black'
                },
                name: 'OP Cases',
                data: opcases
            }]

        });

    }

    function linechart_ip(x_categories, ipcases) {
        var target = 0;
        var iplast30 = '../api/analytics.json?dimension=dx:kI1lGixi5a5&dimension=pe:' + last30days +
            '&filter=ou:leMGqLV90eH&displayProperty=NAME';

        $.ajax({
            async: false,
            type: "GET",
            dataType: "json",
            contentType: "application/json",
            url: iplast30,
            success: function (data_op) {

                for (var i = 0; i < data_op.rows.length; i++) {
                    target += parseInt(data_op.rows[i][2]);

                }

                target = target / 30;

            },
            error: function (response) {

            }
        });

        Highcharts.chart('container_ip', {

            title: {
                text: 'IP Cases'
            },

            subtitle: {
                text: 'IP Cases'
            },
            xAxis: {
                categories: x_categories,
                min: 0,
                max: 6,
                labels: {
                    enabled: false
                }
            },
            yAxis: {
                title: {
                    text: 'IP Cases'
                },
                plotLines: [{
                    value: target,
                    color: 'green',
                    dashStyle: 'shortdash',
                    width: 2,
                    label: {
                        text: 'Last 30 Days  Target'
                    }
                }]
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'middle'
            },
            series: [{
                dataLabels: {
                    enabled: true,
                    color: 'black'
                },
                name: 'IP Cases',
                data: ipcases
            }]

        });

    }

    //http://139.162.61.147/nieodk_new/api/25/analytics.json?dimension=dx:CwwhAcIkrSq&dimension=pe:20170331;20170330;20170329;20170328;20170327;20170326;20170325;20170324;20170323;20170322;20170321;20170319;20170320;20170318;20170317;20170316;20170315;20170312;20170313;20170314;20170311;20170&filter=ou:mnbTnDyJ37p&displayProperty=NAME
    function linechart_fever(x_categories, labconfirmedcases) {
        var target = 0;
        var oplast30days = '../api/25/analytics.json?dimension=dx:CwwhAcIkrSq&dimension=pe:' + last30days +
            '&filter=ou:mnbTnDyJ37p&displayProperty=NAME'

        $.ajax({
            async: false,
            type: "GET",
            dataType: "json",
            contentType: "application/json",
            url: oplast30days,
            success: function (data_op) {
                for (var i = 0; i < data_op.rows.length; i++) {
                    target += parseInt(data_op.rows[i][2]);

                }
                //            document.getElementById("demo").innerHTML = "AFI Inpatient admission (n= " + tar + " )";
                target = target / 30;

            },
            error: function (response) {

            }
        });

        Highcharts.chart('container_fever', {

            title: {
                text: 'Lab Confirmed Cases'
            },

            xAxis: {
                categories: x_categories,
                min: 0,
                max: 6,
                labels: {
                    enabled: true
                }
            },
            yAxis: {
                title: {
                    text: 'Lab Confirmed Cases'
                },
                plotLines: [{
                    value: target,
                    color: 'green',
                    dashStyle: 'shortdash',
                    width: 2,
                    label: {
                        text: 'Last 30 Days  Target'
                    }
                }]
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'middle'
            },

            series: [{
                dataLabels: {
                    enabled: true,
                    color: 'black'
                },
                name:'Lab Cases',
                data: labconfirmedcases,
                pointStart: x_categories,
                min: 0,
                max: 6
            }]

        });
    }
	
	
	var loadReports = function(previousdy_7_,previousdy1_,last7days){
	
		$.ajax({
                async: false,
                type: "GET",
                dataType: "json",
                contentType: "application/json",
                url:'../api/trackedEntityInstances.json?program=mcnt7nqNrNw&ouMode=ALL&fields=*&programStartDate='+previousdy_7_+'&programEndDate='+previousdy1_+'&paging=false',
                success: function (data) {
		 
		 for(var i=0;i<data.trackedEntityInstances.length;i++) {
		  var tei= data.trackedEntityInstances[i].trackedEntityInstance;
					$.ajax({
                async: false,
                type: "GET",
                dataType: "json",
                contentType: "application/json",
                url:'../api/trackedEntityInstances/'+tei+'.json?fields=*',
                success: function (data) {

                ou = data.orgUnit;
				
                    if(data.attributes.length!=0) {
					 var printDisplay=""
                        for(var i=0;i<data.attributes.length;i++) {
                        if (data.attributes[i].displayName == "Cluster ID") {
                            clusterId = data.attributes[i].value;
                        }
                        if (data.attributes[i].displayName == "Cluster Type") {
                            clusterType = data.attributes[i].value;
                        }
						if (data.attributes[i].displayName == " 3 AFI cases (last 5 days)") {
                            if(data.attributes[i].value=="true"){
								printDisplay = printDisplay +";" +data.attributes[i].displayName;
							}
                        }
						if (data.attributes[i].displayName == " 5 AFI cases (last 7 days)") {
                            if(data.attributes[i].value=="true"){
								printDisplay = printDisplay +";" +data.attributes[i].displayName;
							}
                        }
						if (data.attributes[i].displayName == "Lab confirmed case") {
                            if(data.attributes[i].value=="true"){
								printDisplay = printDisplay +";" +data.attributes[i].displayName;
							}
                        }
                        if (data.attributes[i].attribute == "sBmb7HfvAau") {
                            if(data.attributes[i].value=="MANUAL"){
								printDisplay = printDisplay +";" +data.attributes[i].value;
							}
                        }
						if (data.attributes[i].displayName == "CasesUIDs") {
                            patients = data.attributes[i].value;
                        }
                    }
                        }
                    else{
                        clusterId="None";
                        clusterType="None";
                    }
					
					patientsArray = patients.split(';');
                    
					
					$.ajax({
                async: false,
                type: "GET",
                dataType: "json",
                contentType: "application/json",
                url:'../api/26/analytics/events/query/Ml0ZNj9APN0.json?dimension=pe:THIS_YEAR&dimension=ou:mnbTnDyJ37p&dimension=xUhbNO2bQCz&dimension=pa6AUJ4s9li&dimension=xq2RxjLDbev&dimension=KSaU2NSe3ga&dimension=XYhSJWeyxQL&dimension=GIGDIz8ivwS&dimension=KQFdmU5Oqz6&dimension=IeAaU6tgIFl&dimension=mYQBPHZugDx&dimension=glBt6kk3AXS&dimension=nOCIVMD4lOv&dimension=vN0BoElifvC&dimension=IXnRY4BQtQZ&dimension=jwmIajW8wa4&dimension=z4NPqwhOjDH&dimension=xvEO66y1BB4&dimension=ojqkjOup797&dimension=GJsrYvDPJG1&dimension=pQLz5yJ0AJQ&dimension=aWM069T9jXj&dimension=eezUUL7VZMd&stage=iWcQ5lxmsy4&displayProperty=NAME&outputType=EVENT&paging=false',
                success: function (data5) {
				
				if(printDisplay == ""){}
				else{
				
					var rowcluster = "<tr class='clusterHead'><td colspan='4'>Cluster Type :</td><td colspan='4'>"+ clusterType +"</td><td colspan = '4'>"+printDisplay+"</td></tr>";
					$('.reporttable').append(rowcluster);
										var index=1;
                    for(var h = 0; h < patientsArray.length; h++){
                        var kk=0;
                        for(var ii = 0; ii < data5.rows.length; ii++){
                            if(data5.rows[ii][0] == patientsArray[h]){
										Pname = data5.rows[ii][8];
										Pgender = data5.rows[ii][9];
										Page = data5.rows[ii][10];
										Pstreet = data5.rows[ii][11];
										Pdoor = data5.rows[ii][12] + data5.rows[ii][13];
                                        Phabitation = data5.rows[ii][14];
                                        Pvillage = data5.rows[ii][15];
                                        Pmob = data5.rows[ii][16];
                                        Ponset = data5.rows[ii][17];
                                        Pdate = data5.rows[ii][18];
                                        phc = data5.rows[ii][19];
								
										for (var jj = 20; jj < data5.rows[ii].length; jj++) {
											if (data5.rows[ii][jj] == "positive") {
												Plab[kk] = data5.headers[jj].column;
												kk++;
											}
										}
							}
						}
										if (Plab.length == 0) {
											Plab[0] = "none";
										}
						
						var newAge = Math.round(Page);
						var newStreet = Pstreet.split('-')[0];
						var newDoor = Pdoor + newStreet;
						var newVil = Pvillage.split('-')[1];
						var newHab = Phabitation.split('-')[0];
						if(phc != ""){
						phc = phc.split('-')[1];
							if(phc == 'undefined' || phc == null){
								phc= "";
							}
						}
						
						if(Ponset == 'eDFSS_IPD_V3'){Ponset = 'IPD'}
						else{Ponset = 'OPD'}
						
                        var newRow = $("<tr class='newRow'><td class='tdrow' colspan='1'>"+index+"</td><td class='tdrow' colspan='1'>"+Pname+"</td><td class='tdrow' colspan='1'>"+newAge+"</td><td class='tdrow' colspan='1'>"+Pgender+"</td><td class='tdrow' colspan='1'>"+newDoor+"</td><td class='tdrow' colspan='1'>"+newHab+"</td><td class='tdrow' colspan='1'>"+newVil+"</td><td class='tdrow' colspan='1'>"+Pmob+"</td><td class='tdrow' colspan='1'>"+Ponset+"</td><td class='tdrow' colspan='1'>"+Pdate+"</td><td class='tdrow' colspan='1'>"+Plab+"</td><td class='tdrow' colspan='1'>"+phc+"</td></tr>");
                        $('.reporttable').append(newRow);
                        index++;

                        }
						}
						}
						});
                        },
						error:function(data)
						{
						}
						});
				}
		  }
		  });
	};

</script>
<script type="text/javascript">
    var tei, url, ou, index = 1;
    var clusterId, clusterType = "None";
    var district = "None",
        hud = "None",
        block = "None",
        phc = "None",
        rrt = "None";
    var population = 0,
        houseCount = 0;
    var Pname, Page, Pgender, Pdoor, Phab, Pvillage, Pmob, Ponset, Pdate, Plab = [],
        Ptei, Pins;
    var data44, data55, data;
    var Week1, Week2;


    var getDate = function () {
        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth() + 1; //January is 0!
        var yyyy = today.getFullYear();

        if (dd < 10) {
            dd = '0' + dd
        }

        if (mm < 10) {
            mm = '0' + mm
        }

        today = mm + '/' + dd + '/' + yyyy;
        return today;
    };

    var getWeek = function () {
        var curr = new Date; // get current date
        var first = curr.getDate() - curr.getDay() - 4; // First day is the day of the month - the day of the week
        var last = first + 6; // last day is the first day + 6
        var startDate = new Date(curr.setDate(first));
        Week1 = "" + (startDate.getMonth() + 1) + "/" + startDate.getDate() + "/" + startDate.getFullYear();
        var endDate = new Date(curr.setDate(last));
        Week2 = "" + (endDate.getMonth() + 1) + "/" + endDate.getDate() + "/" + endDate.getFullYear();

        return;

    };

    var displayReport = function () {

        $.ajax({
            async: false,
            type: "GET",
            dataType: "json",
            contentType: "application/json",
            url: '../api/trackedEntityInstances.json?fields=*&program=wXXVzDXRLMe&ouMode=ALL',
            success: function (data7) {

                buildReport(data7, 0);
            }
        });
    };



    var buildReport = function (data7, increment) {

        if (increment >= data7.trackedEntityInstances.length) {
            return;
        } else {
            tei = data7.trackedEntityInstances[increment].trackedEntityInstance;
            clusterId = "", Pname = "", Page = "", Pgender = "", Pdoor = "", Phab = "", Pvillage = "", Pmob =
                "", Ponset = "", Pdate = "", Plab = [], Ptei = "", Pins = "";
            data = getData11(tei);
            data55 = getData5();
            data44 = getData4();
            printHeader(increment);
            printTable(data, data55, data44, increment, 0);
            buildReport(data7, increment + 1);
        }
    };

    var getData11 = function (tei) {
        rrt = "";
        $.ajax({
            async: false,
            type: "GET",
            dataType: "json",
            contentType: "application/json",
            url: '../api/trackedEntityInstances/' + tei + '.json?fields=*&ouMode=ALL',
            success: function (data11) {

                if (data11.attributes.length != 0) {
                    for (var i = 0; i < data11.attributes.length; i++) {
                        if (data11.attributes[i].displayName == "Cluster ID") {
                            clusterId = data11.attributes[i].value;
                        }
                        if (data11.attributes[i].displayName == "Cluster type") {
                            clusterType = data11.attributes[i].value;
                        }
                        if (data11.attributes[i].displayName == " 3 AFI cases (last 5 days)") {
                            rrt = rrt + data11.attributes[i].displayName;
                        }
                        if (data11.attributes[i].displayName == " 5 AFI cases (last 7 days)") {
                            rrt = rrt + data11.attributes[i].displayName;
                        }
                        if (data11.attributes[i].displayName == "1 Lab confirmed case") {
                            rrt = rrt + data11.attributes[i].displayName;
                        }
                    }

                } else {
                    clusterId = "None";
                    clusterType = "None";
                }
                data = data11;
            }
        });
        return data;
    };

    var getData4 = function () {
        $.ajax({
            async: false,
            type: "GET",
            dataType: "json",
            contentType: "application/json",
            url: '../api/analytics/events/query/X2XfE0rYiwk.json?stage=apqU6esBuwV&dimension=pe:' +
            last7days +
            '&dimension=ou:WXW1rhM9hgR&dimension=A4xv2IGIidc&dimension=u4Im7YWqdL6&dimension=leMIOD9cjVL&dimension=bcNxz9ZI7Zi&dimension=wFiHJnAmAyK&dimension=wZbg3yGKcNu&dimension=QGtJOccfJJO&dimension=CPrDolo2qSh&dimension=DKXiHk6FrtK&dimension=wvVoqUUWHnI&dimension=HpKD5NQqDqX&dimension=xYO8HkDDW3N&dimension=J6uckqQfkyc&dimension=mEWZIvuQWwe&dimension=GWQL3jsnuaM&dimension=ysgOCWco2Gw&dimension=wCHzBwjAwn4&displayProperty=NAME',
            success: function (data4) {
                data44 = data4;

            }
        });
        return data44;
    };
    var getData5 = function () {
        $.ajax({
            async: false,
            type: "GET",
            dataType: "json",
            contentType: "application/json",
            url: '../api/analytics/events/query/X2XfE0rYiwk.json?stage=apqU6esBuwV&dimension=pe:' +
            last7days +
            '&dimension=ou:WXW1rhM9hgR&dimension=DKXiHk6FrtK&dimension=CPrDolo2qSh&dimension=wvVoqUUWHnI&dimension=leMIOD9cjVL&dimension=HpKD5NQqDqX&dimension=bcNxz9ZI7Zi&dimension=J6uckqQfkyc&dimension=mEWZIvuQWwe&dimension=wZbg3yGKcNu&dimension=QGtJOccfJJO&dimension=A4xv2IGIidc&dimension=wFiHJnAmAyK&dimension=WUoOh92Rftx&dimension=n6kP82CbJUh&dimension=FfvWigqXGOt&dimension=HmIhUj55Q9i&dimension=p3Ozgnoorit&dimension=YmnPLo5tyYv&dimension=f91ufC0PCuy&dimension=ZFxhXoEh3xb&dimension=r5Pg7EcNbE2&dimension=y8701JIOBhm&dimension=ceSYgw6p45I&dimension=GWQL3jsnuaM&&dimension=ysgOCWco2Gw&displayProperty=NAME',
            success: function (data5) {
                data55 = data5;

            }
        });
        return data55;
    };

    var printHeader = function (aaa) {
        var todayDate = getDate();
        getWeek();

        var Divid =
            "<div class='headingg' width='100%' style='border:1px solid black;background-color:yellow'><div style='width:25%;float:left'>Cluster ID: " +
            clusterId + "</div><div style='width:25%;float:left'>Confirmed Case: " + rrt +
            "</div><div style='width:25%;float:left'>Date: " + todayDate +
            "</div><div style='width:25%;float:left'>Period: " + Week1 + "-" + Week2 + "</div></div>";
        $('.patientdata').append(Divid);
        var heading = "<table id='reporttable_" + aaa +
            "' class='reporttableC'><thead><tr style='background-color:#81969B;border:1px solid black'>" +
            "<th class = 'tablerows' colspan='1' >Date of Admission</th>" +
            "<th class = 'tablerows' colspan='1' >Block</th>" +
            "<th class = 'tablerows' colspan='1' >Village</th>" +
            "<th class = 'tablerows' colspan='1' >Name</th>" +
            "<th class = 'tablerows' colspan='1' >Age(in years)</th>" +
            "<th class = 'tablerows' colspan='1' >Sex(M/F)</th>" +
            "<th class = 'tablerows' colspan='1' >Door number, Street Name</th>" +
            "<th class = 'tablerows' colspan='1' >Mobile Number</th>" +
            "<th class = 'tablerows' colspan='1' >Reported Institution</th>" +
            "<th class = 'tablerows' colspan='1' >Lab Diagnosis</th>" +
            "</thead>" +
            "</table><br><br><br>";
        $('.patientdata').append(heading);

    };

    var printTable = function (data, data55, data44, v, aa) {

        if (aa >= data.relationships.length) {
            return;
        } else {
            for (var hh = 0; hh < data.relationships[aa].relative.attributes.length; hh++) {

                if (data.relationships[aa].relative.attributes[hh].displayName == "TEI-UID") {
                    Ptei = data.relationships[aa].relative.attributes[hh].value;
                }

            }
            var d = 0,
                diag = [];
            for (var ii = 0; ii < data55.rows.length; ii++) {
                if (data55.rows[ii][32] == Ptei) {
                    for (var k = 20; k < 32; k++) {
                        if (data55.rows[ii][k] == "Positive") {
                            diag[d] = data55.headers[k].column;
                            d++;
                        }
                    }
                }
            }
            if (diag.length == 0) {
                diag[0] = "none";
            }

            for (var l = 0; l < data44.rows.length; l++) {
                if (data44.rows[l][23] == Ptei) {
                    Pname = data44.rows[l][16];
                    Pdoor = data44.rows[l][18] + " " + data44.rows[l][22];
                    Pgender = data44.rows[l][10];
                    Page = data44.rows[l][8];
                    Phab = data44.rows[l][20];
                    Pdate = data44.rows[l][9];
                    Pmob = data44.rows[l][12];
                    Pins = data44.rows[l][14];
                    Pvillage = data44.rows[l][21];
                }
            }
            var phab = Phab.split('-')[0];

            var newRow = $("<tr><td class='tdrow' colspan='1'>" + Pdate + "</td><td class='tdrow' colspan='1'>" +
                phab + "</td><td class='tdrow' colspan='1'>" + Pvillage +
                "</td><td class='tdrow' colspan='1'>" + Pname + "</td><td class='tdrow' colspan='1'>" +
                Page + "</td><td class='tdrow' colspan='1'>" + Pgender +
                "</td><td class='tdrow' colspan='1'>" + Pdoor + "</td><td class='tdrow' colspan='1'>" +
                Pmob + "</td><td class='tdrow' colspan='1'>" + Pins + "</td><td class='tdrow' colspan='1'>" +
                diag + "</td></tr>");
            $('#reporttable_' + v).append(newRow);
            index++;
            printTable(data, data55, data44, v, aa + 1);
        }

    };
</script>
<!--<div class="header">-->
<!--<img src="../api/documents/mPwj5WDZrQ5/data" alt="logo" />-->
<!--<h1><center> <b><font size="20">ELectronic Daily Fever Surveillance System, Tiruvallur District</font></b></center></h1>-->
<!--</div>-->
<!--<div class="header1">-->
<!--<img src="../api/documents/oiOL0uwJrMI/data" alt="logo" />-->
<!--</div>-->
<!--<div style="display:flex">-->
    <!--<div class="input-group date" id='date' style="margin: 8px">-->
        <!--<input type='date' id="datepicker1" style="border: 1px solid black;text-align: center;border-radius: 25px;" />-->
        <!--</span>-->
    <!--</div>-->
    <!--<div>-->
        <!--<input type="button" onClick="loadDataX();displayReport();" value="Go" style="width:50px; margin: 8px;" class="btn btn-success"-->
        <!--/>-->
    <!--</div>-->
<!--</div>-->

    <!--<div class="input-group date" id='date' style="margin: 8px">-->
        <!--<input type='text' id="datepicker1" class="form-control"  />-->
      <!--<span class="input-group-addon">-->
      <!--<span class="fa fa-calendar"></span>-->
   <!--</span>-->
    <!--</div>-->


    <div id="notPrint"><b>Select Date : </b><input type="date" id ="datepicker" required>    <input type="button" onClick="loadDataX()" value="Go" /></div>
 <div id="printing">   <div class="header">
        <img src="../api/documents/PRa74yvj2VL/data" alt="logo" />
        <h1 style="display: inline;text-align: center;margin-left: 10%">Electronic Daily Fever Surveillance System, Tiruvallur District</h1>
        <img src="../api/documents/KyVqC2KDKXO/data" style="float: right;" />
    </div>


<!--<div style="max-width:1200px;">-->
    <!--<div style="width:400px;"><img src="../api/documents/DX8yS8OnrKM/data"></div>-->
    <!--<div style="width:800px;">-->
        <!--<h1><strong>Electronic Daily Fever Surveillance System, Tiruvallur District</strong></h1>-->
    <!--</div>-->
    <!--<div style="width:400px;"><img src="../api/documents/YsjzeylV4CF/data"></div>-->
<!--</div>-->



<!--<table frame="box">-->
    <!--<tr>-->
        <!--<th><p style="display: inline" id="report"></p></th>-->
        <!--<th><p style="display: inline" id="date"></th>-->
        <!--<th><p style="display: inline" id="period"></th>-->
    <!--</tr>-->
<!--</table>-->
<table style="width: 100%">
    <tbody>
    <tr>
        <td style="width: 20%;margin-left: 25%">
            <table frame="box">
                <tr>
                    <th><p style="display: inline" id="report"></p></th>
                </tr>
                <tr>
                    <th><p style="display: inline" id="datet"></p></th>
                </tr>
                <tr>
                    <th><p style="display: inline" id="period"></p></th>
                </tr>
            </table>
        </td>
        <td>
            <!--<img src="../api/documents/Rv149MnoF9k/data" id="legend" style="width:150px;height:150px;">-->
        </td>

        <td style="width: 80%">
            <div id="overContainer">

                <div id="map1" style="width:1000px; height:470px;margin-left: 1%;margin-right:10%" ></div>
            </div>
        </td>
    </tr>
    </tbody>
</table>

  


<table style="width: 100%">
    <tbody>
    <tr>
        <td style="width: 50%">
            <div id="summary" ></div>
        </td>
        <td style="width: 50%;">
            <div id="sumamry_chart" style="height: 330px"></div>
        </td>
    </tr>
    </tbody>
</table>

<div id="table3">
<table style="width:90%;margin:auto" class="table3" >
    <tbody>
    <tr>

        <td style="width:50%;">
            <H1></H1>
            <div id="container_op" style="width: 600px;  height: 200px; margin: 0 auto; "></div>
        </td>
        <td style="width:50%;">
            <H1></H1>
            <div id="container" style="width: 600px;  height: 200px; margin: 0 auto; "></div>
        </td>
    </tr>
    </tbody>
</table>
</div>
<table style="width:90%;margin:auto" class="table3">
    <tbody>
    <tr>

        <td style="width:50%;">
            <H1></H1>
            <div id="container_ip" style="width: 600px;  height: 200px; margin: 0 auto; " class="empty-table"></div>
        </td>
        <td style="width:50%;">
            <H1></H1>
            <div id="container1" style="width: 600px;  height: 200px; margin: 0 auto; " class="empty-table"></div>
        </td>
    </tr>
    </tbody>
</table>

<table style="width:90%;margin:auto" class="table3">
    <tbody>
    <tr>

        <td style="width:50%;">
            <H1></H1>
            <div id="container_fever" style="width: 600px;  height: 200px; margin: 0 auto; " class="empty-table"></div>
        </td>
        <td style="width:50%;">
            <H1></H1>
            <div id="container2" style="width: 600px;  height: 200px; margin: 0 auto; " class="empty-table"></div>
        </td>
    </tr>
    </tbody>
</table><br><br><br><br><br><br><br><br><br><br><br><br>


<div id="patientdata">
        <p class="Cheading"><b>Line list of case patients :</b></p><br>
        <table class="reporttable">
            <thead>	<tr style='background-color:#81969B;border:1px solid black'>
                <th class = 'tablerows' colspan='1' >S.No.</th>
                <th class = 'tablerows' colspan='1' >Name</th>
                <th class = 'tablerows' colspan='1' >Age(in years)</th>
                <th class = 'tablerows' colspan='1' >Gender</th>
                <th class = 'tablerows' colspan='1' >Door, Street Name</th>
                <th class = 'tablerows' colspan='1' >Habitation</th>
                <th class = 'tablerows' colspan='1' >Village</th>
                <th class = 'tablerows' colspan='1' >Mobile Number</th>
                <th class = 'tablerows' colspan='1' >Onset of AFI/ADD</th>
                <th class = 'tablerows' colspan='1' >Date of Admission</th>
                <th class = 'tablerows' colspan='1' >Lab Results</th>
                <th class = 'tablerows' colspan='1' >Reported Institution</th>
            </thead>
        </table>
    </div>
<!--<div class="patientdata">-->
<!--<p class="Cheading"><b>Line list of case patients :</b></p><br>-->

<!--</div>-->
</div>
</body>

</html>
