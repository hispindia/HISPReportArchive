<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css"
    integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">

<style>
    table {
        border-collapse: collapse;
    }

    thead>tr>td {
        font-weight: bold;
    }

    tbody>tr>td {
        font-weight: bold;
    }

    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button {
        opacity: 1;
    }

    /* Center the loader  */
    #loader {
        position: absolute;
        left: 50%;
        top: 50%;
        z-index: 1;
        width: 150px;
        height: 150px;
        margin: -75px 0 0 -75px;
        border: 16px solid #f3f3f3;
        border-radius: 50%;
        border-top: 16px solid #34B4DB;
        width: 120px;
        height: 120px;
        -webkit-animation: spin 2s linear infinite;
        animation: spin 2s linear infinite;
    }

    @-webkit-keyframes spin {
        0% {
            -webkit-transform: rotate(0deg);
        }

        100% {
            -webkit-transform: rotate(360deg);
        }
    }

    @keyframes spin {
        0% {
            transform: rotate(0deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }

    /* Add animation to "page content" */

    .animate-bottom {
        position: relative;
        -webkit-animation-name: animatebottom;
        -webkit-animation-duration: 1s;
        animation-name: animatebottom;
        animation-duration: 1s
    }

    @-webkit-keyframes animatebottom {
        from {
            bottom: -100px;
            opacity: 0
        }

        to {
            bottom: 0px;
            opacity: 1
        }
    }

    @keyframes animatebottom {
        from {
            bottom: -100px;
            opacity: 0
        }

        to {
            bottom: 0;
            opacity: 1
        }
    }

    #printing {

        text-align: center;
    }



    .nepali-date-picker {
        background: #ffffff none repeat scroll 0 0;
        border: 1px solid #cccccc;
        box-shadow: 0 5px 15px -5px rgba(0, 0, 0, 0.506);
        box-sizing: border-box;
        color: #333333;
        display: block;
        font-family: "Helvetica Neue", "Helvetica", "Arial", sans-serif;
        padding: 8px;
        position: absolute;
        z-index: 9999;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }

    .nepali-date-picker table {
        background-color: transparent;
        border-collapse: collapse;
        width: 100%;
        max-width: 100%;
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        border: 2px solid rgba(129, 120, 120, 0.17);
    }

    .nepali-date-picker table thead {
        background: #dedede;
    }

    .nepali-date-picker table th {
        color: #999;
        cursor: default;
        font-weight: 700;
        text-align: center;
        cursor: default;
    }

    .nepali-date-picker table th {
        background: #f1f1f1 none repeat scroll 0 0;
    }

    .nepali-date-picker table thead td {
        color: #8b8686;
        font-weight: bold;
    }

    .nepali-date-picker table td {
        border: 1px solid rgba(154, 150, 150, 0.46);
        color: #666666;
        padding: 0;
        width: 35px;
        text-align: center;
        font-size: 14px;
    }

    .nepali-date-picker table tbody td {
        cursor: pointer;
    }

    .nepali-date-picker table tbody td.current-month-date:hover {
        background-color: #718fcd;
        color: white;
        font-weight: bold;
    }

    .nepali-date-picker table td.other-month-date,
    .nepali-date-picker table td.current-month-date.disable {
        color: #cccccc;
        cursor: default;
    }

    .nepali-date-picker table tbody td.current-month-date.disable:hover {
        background-color: inherit;
        color: #cccccc;
        font-weight: normal;
    }

    .nepali-date-picker .icon {
        opacity: 0.5;
        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAeCAYAAADaW7vzAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Q0NBRjI1NjM0M0UwMTFFNDk4NkFGMzJFQkQzQjEwRUIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Q0NBRjI1NjQ0M0UwMTFFNDk4NkFGMzJFQkQzQjEwRUIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpDQ0FGMjU2MTQzRTAxMUU0OTg2QUYzMkVCRDNCMTBFQiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDQ0FGMjU2MjQzRTAxMUU0OTg2QUYzMkVCRDNCMTBFQiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PoNEP54AAAIOSURBVHja7Jq9TsMwEMcxrZD4WpBYeKUCe+kTMCACHZh4BFfHO/AAIHZGFhYkBBsSEqxsLCAgXKhbXYOTxh9pfJVP+qutnZ5s/5Lz2Y5I03QhWji2GIcgAokWgfCxNvcOCCGKqiSqhUp0laHOne05vdEyGMfkdxJDVjgwDlEQgYQBgx+ULJaWSXXS6r/ER5FBVR8VfGftTKcITNs+a1XpcFoExREIDF14AVIFxgQUS+h520cdud6wNkC0UBw6BCO/HoCYwBhD8QCkQ/x1mwDyD4plh4D6DDV0TAGyo4HcawLIBBSLDkHeH0Mg2yVP3l4TQMZQDDsEOl/MgHQqhMNuE0D+oBh0CIr8MAKyazBH9WyBuKxDWgbXfjNf32TZ1KWm/Ap1oSk/R53UtQ5xTh3LUlMmT8gt6g51Q9p+SobxgJQ/qmsfZhWywGFSl0yBjCLJCMgXail3b7+rumdVJ2YRss4cN+r6qAHDkPWjPjdJCF4n9RmAD/V9A/Wp4NQassDjwlB6XBiCxcJQWmZZb8THFilfy/lfrTvLghq2TqTHrRMTKNJ0sIhdo15RT+RpyWwFdY96UZ/LdQKBGjcXpcc1AlSFEfLmouD+1knuxBDUVrvOBmoOC/rEcN7OQxKVeJTCiAdUzUJhA2Oez9QTkp72OTVcxDcXY8iKNkxGAJXmJCOQwOa6dhyXsOa6XwEGAKdeb5ET3rQdAAAAAElFTkSuQmCC");
    }

    .nepali-date-picker .icon:hover {
        opacity: 1;
    }

    .nepali-date-picker .prev-btn.icon {
        background-position: 80px center;
        float: left;
        height: 30px;
        width: 20px;
    }

    .current-month-date.active,
    .drop-down-content li.active {
        background-color: #7bde77;
        color: white;
        font-weight: bold;
    }

    .nepali-date-picker .next-btn.icon {
        background-position: 0 center;
        float: right;
        height: 30px;
        width: 20px;
    }

    .nepali-date-picker .today-btn.icon {
        background-position: 130px center;
        display: block;
        float: left;
        height: 30px;
        margin: 0 15px;
        width: 20px;
    }

    .nepali-date-picker .current-month-txt {
        color: #545b54;
        cursor: pointer;
        display: inline-block;
        font-weight: bold;
        line-height: 30px;
        padding-right: 20px;
        position: relative;
        text-align: right;
        width: 80px;
    }

    .nepali-date-picker .current-year-txt {
        color: #545b54;
        font-weight: bold;
        padding-right: 20px;
        cursor: pointer;
        position: relative;
        display: inline-block;
        line-height: 30px;
    }

    .nepali-date-picker .current-year-txt:hover,
    .nepali-date-picker .current-month-txt:hover {
        text-decoration: underline;
    }

    .nepali-date-picker .calendar-controller i.icon-drop-down {
        background-position: 12px -15px;
        height: 30px;
        position: absolute;
        width: 20px;
    }

    .nepali-date-picker .drop-down-content {
        background-color: #ffffff;
        border: 1px solid #cccccc;
        box-shadow: 0 3px 3px 0 rgba(0, 0, 0, 0.32);
        display: none;
        height: 99px;
        padding: 5px;
        position: absolute;
        width: 100%;
        /*overflow: hidden;*/
    }


    .nepali-date-picker .scrollbar-wrapper {
        border-left: 1px solid rgba(204, 204, 204, 0.2);
        height: 100%;
        position: absolute;
        right: 0;
        top: 0;
        width: 15px;
    }

    .scrollbar {
        background-color: black;
        border-radius: 2.5px;
        display: block;
        height: 100%;
        opacity: 0.5;
        position: absolute;
        right: 6.5px;
        width: 5px;
    }

    .nepali-date-picker .drop-down-content .option-wrapper {
        height: 100%;
        overflow-x: hidden;
        overflow-y: scroll;
        padding: 0;
        position: relative;
    }

    .nepali-date-picker .drop-down-content ul {
        list-style: outside none none;
        margin: 0;
        padding: 0 5px 0 0;
    }


    .drop-down-content li {
        border-bottom: 1px solid rgba(159, 153, 153, 0.39);
        font-size: 16px;
        font-weight: normal;
        line-height: 20px;
        text-align: right;
    }

    .drop-down-content li:hover {
        background: #718fcd;
    }


    .drop-down-content li:last-child {
        border-bottom: medium none;
    }

    ::-webkit-scrollbar {
        width: 13px;
        height: 13px;
    }

    ::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.1);
    }

    ::-webkit-scrollbar-thumb {
        background: rgba(0, 0, 0, 0.5);
    }
</style>
<script>var calendarFunctions = {}; !function ($) { var calendarData = { bsMonths: ["बैशाख", "जेठ", "असार", "साउन", "भदौ", "असोज", "कार्तिक", "मंसिर", "पौष", "माघ", "फागुन", "चैत"], bsDays: ["आइत", "सोम", "मंगल", "बुध", "बिही", "शुक्र", "शनि"], nepaliNumbers: ["०", "१", "२", "३", "४", "५", "६", "७", "८", "९"], bsMonthUpperDays: [[30, 31], [31, 32], [31, 32], [31, 32], [31, 32], [30, 31], [29, 30], [29, 30], [29, 30], [29, 30], [29, 30], [30, 31]], extractedBsMonthData: [[0, 1, 1, 22, 1, 3, 1, 1, 1, 3, 1, 22, 1, 3, 1, 3, 1, 22, 1, 3, 1, 19, 1, 3, 1, 1, 3, 1, 2, 2, 1, 3, 1], [1, 2, 2, 2, 2, 2, 2, 1, 3, 1, 3, 1, 2, 2, 2, 3, 2, 2, 2, 1, 3, 1, 3, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 3, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 3, 1, 2, 2, 2, 2, 2, 1, 1, 1, 2, 2, 2, 2, 2, 1, 3, 1, 1, 2], [0, 1, 2, 1, 3, 1, 3, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 1, 3, 1, 3, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 3, 1, 3, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 3, 1, 3, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 3, 1, 1, 2], [1, 2, 1, 3, 1, 3, 1, 3, 1, 3, 1, 3, 1, 3, 1, 3, 1, 3, 1, 3, 1, 3, 1, 3, 1, 3, 1, 3, 1, 2, 2, 2, 1, 3, 1, 3, 1, 3, 1, 3, 1, 3, 1, 2, 2, 2, 1, 3, 1, 3, 1, 3, 1, 3, 1, 3, 1, 3, 2, 2, 1, 3, 1, 2, 2, 2, 1, 2], [59, 1, 26, 1, 28, 1, 2, 1, 12], [0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 3, 1, 3, 1, 3, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 3, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 3, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 5, 1, 1, 2, 2, 1, 3, 1, 2, 1, 2], [0, 12, 1, 3, 1, 3, 1, 5, 1, 11, 1, 3, 1, 3, 1, 18, 1, 3, 1, 3, 1, 18, 1, 3, 1, 3, 1, 27, 1, 2], [1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 3, 1, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 15, 2, 4], [0, 1, 2, 2, 2, 2, 1, 3, 1, 3, 1, 3, 1, 2, 2, 2, 3, 2, 2, 2, 1, 3, 1, 3, 1, 3, 1, 2, 2, 2, 2, 2, 2, 2, 1, 3, 1, 3, 1, 3, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 3, 1, 3, 1, 2, 2, 2, 15, 2, 4], [1, 1, 3, 1, 3, 1, 14, 1, 3, 1, 1, 1, 3, 1, 14, 1, 3, 1, 3, 1, 3, 1, 18, 1, 3, 1, 3, 1, 3, 1, 14, 1, 3, 15, 1, 2, 1, 1], [0, 1, 1, 3, 1, 3, 1, 10, 1, 3, 1, 3, 1, 1, 1, 3, 1, 3, 1, 10, 1, 3, 1, 3, 1, 3, 1, 3, 1, 14, 1, 3, 1, 3, 1, 3, 1, 3, 1, 10, 1, 20, 1, 1, 1], [1, 2, 2, 1, 3, 1, 3, 1, 3, 1, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 1, 3, 1, 3, 1, 3, 1, 2, 2, 2, 2, 2, 2, 2, 1, 3, 1, 3, 1, 3, 1, 3, 1, 2, 2, 2, 2, 2, 2, 2, 1, 3, 1, 3, 1, 20, 3]], minBsYear: 1970, maxBsYear: 2100, minAdDateEqBsDate: { ad: { year: 1913, month: 3, date: 13 }, bs: { year: 1970, month: 1, date: 1 } } }, validationFunctions = { validateRequiredParameters: function (requiredParameters) { $.each(requiredParameters, function (key, value) { if ("undefined" == typeof value || null === value) throw new ReferenceError("Missing required parameters: " + Object.keys(requiredParameters).join(", ")) }) }, validateBsYear: function (bsYear) { if ("number" != typeof bsYear || null === bsYear) throw new TypeError("Invalid parameter bsYear value"); if (bsYear < calendarData.minBsYear || bsYear > calendarData.maxBsYear) throw new RangeError("Parameter bsYear value should be in range of " + calendarData.minBsYear + " to " + calendarData.maxBsYear) }, validateAdYear: function (adYear) { if ("number" != typeof adYear || null === adYear) throw new TypeError("Invalid parameter adYear value"); if (adYear < calendarData.minBsYear - 57 || adYear > calendarData.maxBsYear - 57) throw new RangeError("Parameter adYear value should be in range of " + (calendarData.minBsYear - 57) + " to " + (calendarData.maxBsYear - 57)) }, validateBsMonth: function (bsMonth) { if ("number" != typeof bsMonth || null === bsMonth) throw new TypeError("Invalid parameter bsMonth value"); if (bsMonth < 1 || bsMonth > 12) throw new RangeError("Parameter bsMonth value should be in range of 1 to 12") }, validateAdMonth: function (adMonth) { if ("number" != typeof adMonth || null === adMonth) throw new TypeError("Invalid parameter adMonth value"); if (adMonth < 1 || adMonth > 12) throw new RangeError("Parameter adMonth value should be in range of 1 to 12") }, validateBsDate: function (bsDate) { if ("number" != typeof bsDate || null === bsDate) throw new TypeError("Invalid parameter bsDate value"); if (bsDate < 1 || bsDate > 32) throw new RangeError("Parameter bsDate value should be in range of 1 to 32") }, validateAdDate: function (adDate) { if ("number" != typeof adDate || null === adDate) throw new TypeError("Invalid parameter adDate value"); if (adDate < 1 || adDate > 31) throw new RangeError("Parameter adDate value should be in range of 1 to 31") }, validatePositiveNumber: function (numberParameters) { $.each(numberParameters, function (key, value) { if ("number" != typeof value || null === value || value < 0) throw new ReferenceError("Invalid parameters: " + Object.keys(numberParameters).join(", ")); if ("yearDiff" === key && value > calendarData.maxBsYear - calendarData.minBsYear + 1) throw new RangeError("Parameter yearDiff value should be in range of 0 to " + (calendarData.maxBsYear - calendarData.minBsYear + 1)) }) } }; $.extend(calendarFunctions, { getNepaliNumber: function (number) { if ("undefined" == typeof number) throw new Error("Parameter number is required"); if ("number" != typeof number || number < 0) throw new Error("Number should be positive integer"); var prefixNum = Math.floor(number / 10), suffixNum = number % 10; return 0 !== prefixNum ? calendarFunctions.getNepaliNumber(prefixNum) + calendarData.nepaliNumbers[suffixNum] : calendarData.nepaliNumbers[suffixNum] }, getNumberByNepaliNumber: function (nepaliNumber) { if ("undefined" == typeof nepaliNumber) throw new Error("Parameter nepaliNumber is required"); if ("string" != typeof nepaliNumber) throw new Error("Parameter nepaliNumber should be in string"); for (var number = 0, i = 0; i < nepaliNumber.length; i++) { var numIndex = calendarData.nepaliNumbers.indexOf(nepaliNumber.charAt(i)); if (numIndex === -1) throw new Error("Invalid nepali number"); number = 10 * number + numIndex } return number }, getBsMonthInfoByBsDate: function (bsYear, bsMonth, bsDate, dateFormatPattern) { if (validationFunctions.validateRequiredParameters({ bsYear: bsYear, bsMonth: bsMonth, bsDate: bsDate }), validationFunctions.validateBsYear(bsYear), validationFunctions.validateBsMonth(bsMonth), validationFunctions.validateBsDate(bsDate), null === dateFormatPattern) dateFormatPattern = "%D, %M %d, %y"; else if ("string" != typeof dateFormatPattern) throw new TypeError("Invalid parameter dateFormatPattern value"); var daysNumFromMinBsYear = calendarFunctions.getTotalDaysNumFromMinBsYear(bsYear, bsMonth, bsDate), adDate = new Date(calendarData.minAdDateEqBsDate.ad.year, calendarData.minAdDateEqBsDate.ad.month, calendarData.minAdDateEqBsDate.ad.date - 1); adDate.setDate(adDate.getDate() + daysNumFromMinBsYear); var bsMonthFirstAdDate = calendarFunctions.getAdDateByBsDate(bsYear, bsMonth, 1), bsMonthDays = calendarFunctions.getBsMonthDays(bsYear, bsMonth); bsDate = bsDate > bsMonthDays ? bsMonthDays : bsDate; var eqAdDate = calendarFunctions.getAdDateByBsDate(bsYear, bsMonth, bsDate), weekDay = eqAdDate.getDay() + 1, formattedDate = calendarFunctions.bsDateFormat(dateFormatPattern, bsYear, bsMonth, bsDate); return { bsYear: bsYear, bsMonth: bsMonth, bsDate: bsDate, weekDay: weekDay, formattedDate: formattedDate, adDate: eqAdDate, bsMonthFirstAdDate: bsMonthFirstAdDate, bsMonthDays: bsMonthDays } }, getAdDateByBsDate: function (bsYear, bsMonth, bsDate) { validationFunctions.validateRequiredParameters({ bsYear: bsYear, bsMonth: bsMonth, bsDate: bsDate }), validationFunctions.validateBsYear(bsYear), validationFunctions.validateBsMonth(bsMonth), validationFunctions.validateBsDate(bsDate); var daysNumFromMinBsYear = calendarFunctions.getTotalDaysNumFromMinBsYear(bsYear, bsMonth, bsDate), adDate = new Date(calendarData.minAdDateEqBsDate.ad.year, calendarData.minAdDateEqBsDate.ad.month, calendarData.minAdDateEqBsDate.ad.date - 1); return adDate.setDate(adDate.getDate() + daysNumFromMinBsYear), adDate }, getTotalDaysNumFromMinBsYear: function (bsYear, bsMonth, bsDate) { if (validationFunctions.validateRequiredParameters({ bsYear: bsYear, bsMonth: bsMonth, bsDate: bsDate }), validationFunctions.validateBsYear(bsYear), validationFunctions.validateBsMonth(bsMonth), validationFunctions.validateBsDate(bsDate), bsYear < calendarData.minBsYear || bsYear > calendarData.maxBsYear) return null; for (var daysNumFromMinBsYear = 0, diffYears = bsYear - calendarData.minBsYear, month = 1; month <= 12; month++)daysNumFromMinBsYear += month < bsMonth ? calendarFunctions.getMonthDaysNumFormMinBsYear(month, diffYears + 1) : calendarFunctions.getMonthDaysNumFormMinBsYear(month, diffYears); return daysNumFromMinBsYear += bsYear > 2085 && bsYear < 2088 ? bsDate - 2 : 2085 === bsYear && bsMonth > 5 ? bsDate - 2 : 2081 === bsYear && 3 === bsMonth ? bsDate + 1 : 2081 === bsYear && 12 === bsMonth ? bsDate - 1 : bsYear > 2088 ? bsDate - 4 : 2088 === bsYear && bsMonth > 5 ? bsDate - 4 : bsDate }, getMonthDaysNumFormMinBsYear: function (bsMonth, yearDiff) { validationFunctions.validateRequiredParameters({ bsMonth: bsMonth, yearDiff: yearDiff }), validationFunctions.validateBsMonth(bsMonth), validationFunctions.validatePositiveNumber({ yearDiff: yearDiff }); var yearCount = 0, monthDaysFromMinBsYear = 0; if (0 === yearDiff) return 0; for (var bsMonthData = calendarData.extractedBsMonthData[bsMonth - 1], i = 0; i < bsMonthData.length; i++)if (0 !== bsMonthData[i]) { var bsMonthUpperDaysIndex = i % 2; if (!(yearDiff > yearCount + bsMonthData[i])) { monthDaysFromMinBsYear += calendarData.bsMonthUpperDays[bsMonth - 1][bsMonthUpperDaysIndex] * (yearDiff - yearCount), yearCount = yearDiff - yearCount; break } yearCount += bsMonthData[i], monthDaysFromMinBsYear += calendarData.bsMonthUpperDays[bsMonth - 1][bsMonthUpperDaysIndex] * bsMonthData[i] } return monthDaysFromMinBsYear }, getBsMonthDays: function (bsYear, bsMonth) { validationFunctions.validateRequiredParameters({ bsYear: bsYear, bsMonth: bsMonth }), validationFunctions.validateBsYear(bsYear), validationFunctions.validateBsMonth(bsMonth); for (var yearCount = 0, totalYears = bsYear + 1 - calendarData.minBsYear, bsMonthData = calendarData.extractedBsMonthData[bsMonth - 1], i = 0; i < bsMonthData.length; i++)if (0 !== bsMonthData[i]) { var bsMonthUpperDaysIndex = i % 2; if (yearCount += bsMonthData[i], totalYears <= yearCount) return 2085 === bsYear && 5 === bsMonth || 2088 === bsYear && 5 === bsMonth ? calendarData.bsMonthUpperDays[bsMonth - 1][bsMonthUpperDaysIndex] - 2 : 2081 === bsYear && 2 === bsMonth ? calendarData.bsMonthUpperDays[bsMonth - 1][bsMonthUpperDaysIndex + 1] : 2081 === bsYear && 3 === bsMonth ? calendarData.bsMonthUpperDays[bsMonth - 1][bsMonthUpperDaysIndex - 1] : 2081 === bsYear && 11 === bsMonth ? calendarData.bsMonthUpperDays[bsMonth - 1][bsMonthUpperDaysIndex] - 1 : 2081 === bsYear && 12 === bsMonth ? calendarData.bsMonthUpperDays[bsMonth - 1][bsMonthUpperDaysIndex] + 1 : calendarData.bsMonthUpperDays[bsMonth - 1][bsMonthUpperDaysIndex] } return null }, getBsDateByAdDate: function (adYear, adMonth, adDate) { validationFunctions.validateRequiredParameters({ adYear: adYear, adMonth: adMonth, adDate: adDate }), validationFunctions.validateAdYear(adYear), validationFunctions.validateAdMonth(adMonth), validationFunctions.validateAdDate(adDate); var bsYear = adYear + 57, bsMonth = (adMonth + 9) % 12; bsMonth = 0 === bsMonth ? 12 : bsMonth; var bsDate = 1; if (adMonth < 4) bsYear -= 1; else if (4 === adMonth) { var bsYearFirstAdDate = calendarFunctions.getAdDateByBsDate(bsYear, 1, 1); adDate < bsYearFirstAdDate.getDate() && (bsYear -= 1) } var bsMonthFirstAdDate = calendarFunctions.getAdDateByBsDate(bsYear, bsMonth, 1); if (adDate >= 1 && adDate < bsMonthFirstAdDate.getDate()) { bsMonth = 1 !== bsMonth ? bsMonth - 1 : 12; var bsMonthDays = calendarFunctions.getBsMonthDays(bsYear, bsMonth); bsDate = bsMonthDays - (bsMonthFirstAdDate.getDate() - adDate) + 1 } else bsDate = adDate - bsMonthFirstAdDate.getDate() + 1; return { bsYear: bsYear, bsMonth: bsMonth, bsDate: bsDate } }, getBsYearByAdDate: function (adYear, adMonth, adDate) { validationFunctions.validateRequiredParameters({ adYear: adYear, adMonth: adMonth, adDate: adDate }), validationFunctions.validateAdYear(adYear), validationFunctions.validateAdMonth(adMonth), validationFunctions.validateAdDate(adDate); var bsDate = calendarFunctions.getBsDateByAdDate(adYear, adMonth, adDate); return bsDate.bsYear }, getBsMonthByAdDate: function (adYear, adMonth, adDate) { validationFunctions.validateRequiredParameters({ adYear: adYear, adMonth: adMonth, adDate: adDate }), validationFunctions.validateAdYear(adYear), validationFunctions.validateAdMonth(adMonth), validationFunctions.validateAdDate(adDate); var bsDate = calendarFunctions.getBsDateByAdDate(adYear, adMonth, adDate); return bsDate.bsMonth }, bsDateFormat: function (dateFormatPattern, bsYear, bsMonth, bsDate) { validationFunctions.validateRequiredParameters({ dateFormatPattern: dateFormatPattern, bsYear: bsYear, bsMonth: bsMonth, bsDate: bsDate }), validationFunctions.validateBsYear(bsYear), validationFunctions.validateBsMonth(bsMonth), validationFunctions.validateBsDate(bsDate); var eqAdDate = calendarFunctions.getAdDateByBsDate(bsYear, bsMonth, bsDate), weekDay = eqAdDate.getDay() + 1, formattedDate = dateFormatPattern; return formattedDate = formattedDate.replace(/%d/g, calendarFunctions.getNepaliNumber(bsDate)), formattedDate = formattedDate.replace(/%y/g, calendarFunctions.getNepaliNumber(bsYear)), formattedDate = formattedDate.replace(/%m/g, calendarFunctions.getNepaliNumber(bsMonth)), formattedDate = formattedDate.replace(/%M/g, calendarData.bsMonths[bsMonth - 1]), formattedDate = formattedDate.replace(/%D/g, calendarData.bsDays[weekDay - 1]) }, parseFormattedBsDate: function (dateFormat, dateFormattedText) { validationFunctions.validateRequiredParameters({ dateFormat: dateFormat, dateFormattedText: dateFormattedText }); for (var diffTextNum = 0, extractedFormattedBsDate = { bsYear: null, bsMonth: null, bsDate: null, bsDay: null }, i = 0; i < dateFormat.length; i++)if ("%" === dateFormat.charAt(i)) { var valueOf = dateFormat.substring(i, i + 2), endChar = dateFormat.charAt(i + 2), tempText = dateFormattedText.substring(i + diffTextNum), endIndex = "" !== endChar ? tempText.indexOf(endChar) : tempText.length, value = tempText.substring(0, endIndex); "%y" === valueOf ? (extractedFormattedBsDate.bsYear = calendarFunctions.getNumberByNepaliNumber(value), diffTextNum += value.length - 2) : "%d" === valueOf ? (extractedFormattedBsDate.bsDate = calendarFunctions.getNumberByNepaliNumber(value), diffTextNum += value.length - 2) : "%D" === valueOf ? (extractedFormattedBsDate.bsDay = calendarData.bsDays.indexOf(value) + 1, diffTextNum += value.length - 2) : "%m" === valueOf ? (extractedFormattedBsDate.bsMonth = calendarFunctions.getNumberByNepaliNumber(value), diffTextNum += value.length - 2) : "%M" === valueOf && (extractedFormattedBsDate.bsMonth = calendarData.bsMonths.indexOf(value) + 1, diffTextNum += value.length - 2) } if (!extractedFormattedBsDate.bsDay) { var eqAdDate = calendarFunctions.getAdDateByBsDate(extractedFormattedBsDate.bsYear, extractedFormattedBsDate.bsMonth, extractedFormattedBsDate.bsDate); extractedFormattedBsDate.bsDay = eqAdDate.getDay() + 1 } return extractedFormattedBsDate } }), $.fn.nepaliDatePicker = function (options) { var datePickerPlugin = { options: $.extend({ dateFormat: "%D, %M %d, %y", closeOnDateSelect: !0, defaultDate: "", minDate: null, maxDate: null, yearStart: calendarData.minBsYear, yearEnd: calendarData.maxBsYear }, options), init: function ($element) { $element.prop("readonly", !0); var $nepaliDatePicker = $('<div class="nepali-date-picker">'); $("body").append($nepaliDatePicker), "" !== $element.val() ? datePickerPlugin.renderFormattedSpecificDateCalendar($nepaliDatePicker, datePickerPlugin.options.dateFormat, $element.val()) : datePickerPlugin.renderCurrentMonthCalendar($nepaliDatePicker), datePickerPlugin.addEventHandler($element, $nepaliDatePicker), datePickerPlugin.addCommonEventHandler($nepaliDatePicker) }, addCommonEventHandler: function () { var $datePickerWrapper = $(".nepali-date-picker"); $(document).click(function (event) { var $targetElement = $(event.target); $targetElement.is($(".nepali-date-picker")) || ($datePickerWrapper.hide(), $datePickerWrapper.find(".drop-down-content").hide()) }) }, addEventHandler: function ($element, $nepaliDatePicker) { $element.click(function () { if ($(".nepali-date-picker").is(":visible")) return void $(".nepali-date-picker").hide(); var inputFieldPosition = $(this).offset(); return $nepaliDatePicker.css({ top: inputFieldPosition.top + $(this).outerHeight(!0), left: inputFieldPosition.left }), $element.val() && datePickerPlugin.renderFormattedSpecificDateCalendar($nepaliDatePicker, datePickerPlugin.options.dateFormat, $element.val()), $nepaliDatePicker.show(), datePickerPlugin.eventFire($element, $nepaliDatePicker, "show"), !1 }), $nepaliDatePicker.on("click", ".next-btn", function (event) { event.preventDefault(); var preCalendarData = { bsYear: $nepaliDatePicker.data().bsYear, bsMonth: $nepaliDatePicker.data().bsMonth, bsDate: $nepaliDatePicker.data().bsDate }; return datePickerPlugin.renderNextMonthCalendar($nepaliDatePicker), datePickerPlugin.triggerChangeEvent($element, $nepaliDatePicker, preCalendarData), $nepaliDatePicker.show(), !1 }), $nepaliDatePicker.on("click", ".prev-btn", function (event) { event.preventDefault(); var preCalendarData = { bsYear: $nepaliDatePicker.data().bsYear, bsMonth: $nepaliDatePicker.data().bsMonth, bsDate: $nepaliDatePicker.data().bsDate }; datePickerPlugin.renderPreviousMonthCalendar($nepaliDatePicker); $nepaliDatePicker.data(); return datePickerPlugin.triggerChangeEvent($element, $nepaliDatePicker, preCalendarData), $nepaliDatePicker.show(), !1 }), $nepaliDatePicker.on("click", ".today-btn", function (event) { event.preventDefault(); var preCalendarData = { bsYear: $nepaliDatePicker.data().bsYear, bsMonth: $nepaliDatePicker.data().bsMonth, bsDate: $nepaliDatePicker.data().bsDate }; datePickerPlugin.renderCurrentMonthCalendar($nepaliDatePicker); $nepaliDatePicker.data(); return datePickerPlugin.triggerChangeEvent($element, $nepaliDatePicker, preCalendarData), $nepaliDatePicker.show(), !1 }), $nepaliDatePicker.on("click", ".current-year-txt, .current-month-txt", function () { if ($(this).find(".drop-down-content").is(":visible")) $(this).find(".drop-down-content").hide(); else { $nepaliDatePicker.find(".drop-down-content").hide(), $(this).find(".drop-down-content").show(); var $optionWrapper = $(this).find(".option-wrapper"); $optionWrapper.scrollTop(0); var scrollTopTo = $optionWrapper.find(".active").position().top; $optionWrapper.scrollTop(scrollTopTo) } return !1 }), $nepaliDatePicker.on("click", ".current-month-date", function () { if (!$(this).hasClass("disable")) { var datePickerData = $nepaliDatePicker.data(), bsYear = datePickerData.bsYear, bsMonth = datePickerData.bsMonth, preDate = datePickerData.bsDate, bsDate = $(this).data("date"), dateText = calendarFunctions.bsDateFormat(datePickerPlugin.options.dateFormat, bsYear, bsMonth, bsDate); return $element.val(dateText), datePickerPlugin.setCalendarDate($nepaliDatePicker, bsYear, bsMonth, bsDate), datePickerPlugin.renderMonthCalendar($nepaliDatePicker), preDate !== bsDate && datePickerPlugin.eventFire($element, $nepaliDatePicker, "dateChange"), datePickerPlugin.eventFire($element, $nepaliDatePicker, "dateSelect"), datePickerPlugin.options.closeOnDateSelect ? $nepaliDatePicker.hide() : $nepaliDatePicker.show(), !1 } }), $nepaliDatePicker.on("click", ".drop-down-content li", function () { var $dropDown = $(this).parents(".drop-down-content"); $dropDown.data("value", $(this).data("value")), $dropDown.attr("data-value", $(this).data("value")); var preCalendarData = { bsYear: $nepaliDatePicker.data().bsYear, bsMonth: $nepaliDatePicker.data().bsMonth, bsDate: $nepaliDatePicker.data().bsDate }, bsMonth = $nepaliDatePicker.find(".month-drop-down").data("value"), bsYear = $nepaliDatePicker.find(".year-drop-down").data("value"), bsDate = preCalendarData.bsDate; datePickerPlugin.setCalendarDate($nepaliDatePicker, bsYear, bsMonth, bsDate), datePickerPlugin.renderMonthCalendar($nepaliDatePicker); $nepaliDatePicker.data(); return datePickerPlugin.triggerChangeEvent($element, $nepaliDatePicker, preCalendarData), $nepaliDatePicker.show(), !1 }) }, triggerChangeEvent: function ($element, $nepaliDatePicker, preCalendarData) { var calendarData = $nepaliDatePicker.data(); preCalendarData.bsYear !== calendarData.bsYear && datePickerPlugin.eventFire($element, $nepaliDatePicker, "yearChange"), preCalendarData.bsMonth !== calendarData.bsMonth && datePickerPlugin.eventFire($element, $nepaliDatePicker, "monthChange"), preCalendarData.bsDate !== calendarData.bsDate && datePickerPlugin.eventFire($element, $nepaliDatePicker, "dateChange") }, eventFire: function ($element, $nepaliDatePicker, eventType) { switch (eventType) { case "generate": $element.trigger({ type: eventType, message: "Nepali date picker initialize", datePickerData: $nepaliDatePicker.data(), time: new Date }); break; case "show": $element.trigger({ type: eventType, message: "Show nepali date picker", datePickerData: $nepaliDatePicker.data(), time: new Date }); break; case "close": $element.trigger({ type: eventType, message: "close nepali date picker", datePickerData: $nepaliDatePicker.data(), time: new Date }); break; case "dateSelect": $element.trigger({ type: eventType, message: "Select date", datePickerData: $nepaliDatePicker.data(), time: new Date }); break; case "dateChange": $element.trigger({ type: eventType, message: "Change date", datePickerData: $nepaliDatePicker.data(), time: new Date }); break; case "monthChange": $element.trigger({ type: eventType, message: "Change month", datePickerData: $nepaliDatePicker.data(), time: new Date }); break; case "yearChange": $element.trigger({ type: eventType, message: "Change year", datePickerData: $nepaliDatePicker.data(), time: new Date }) } }, setCalendarDate: function ($nepaliDatePicker, bsYear, bsMonth, BsDate) { $nepaliDatePicker.data(calendarFunctions.getBsMonthInfoByBsDate(bsYear, bsMonth, BsDate, datePickerPlugin.options.dateFormat)) }, renderMonthCalendar: function ($nepaliDatePicker) { $nepaliDatePicker.find(".calendar-wrapper").remove(), $nepaliDatePicker.append(datePickerPlugin.getCalendar($nepaliDatePicker)).hide() }, getCalendar: function ($nepaliDatePicker) { var calendarWrapper = $('<div class="calendar-wrapper">'); calendarWrapper.append(datePickerPlugin.getCalendarController($nepaliDatePicker)); var calendarTable = $("<table>"); return calendarTable.append(datePickerPlugin.getCalendarHeader()), calendarTable.append(datePickerPlugin.getCalendarBody($nepaliDatePicker)), calendarWrapper.append(calendarTable), calendarWrapper }, getCalendarController: function ($nepaliDatePicker) { var calendarController = $("<div class='calendar-controller'>"); return calendarController.append('<a href="javascript:void(0);" class="prev-btn icon" title="prev"></a>'), calendarController.append('<a href="javascript:void(0);" class="today-btn icon" title=""></a>'), calendarController.append(datePickerPlugin.getMonthDropOption($nepaliDatePicker)), calendarController.append(datePickerPlugin.getYearDropOption($nepaliDatePicker)), calendarController.append('<a href="javascript:void(0);" class="next-btn icon" title="next"></a>'), calendarController }, getMonthDropOption: function ($nepaliDatePicker) { var datePickerData = $nepaliDatePicker.data(), $monthSpan = $('<div class="current-month-txt">'); $monthSpan.text(calendarData.bsMonths[datePickerData.bsMonth - 1]), $monthSpan.append('<i class="icon icon-drop-down">'); for (var data = [], i = 0; i < 12; i++)data.push({ label: calendarData.bsMonths[i], value: i + 1 }); var $monthDropOption = datePickerPlugin.getCustomSelectOption(data, datePickerData.bsMonth).addClass("month-drop-down"); return $monthSpan.append($monthDropOption), $monthSpan }, getYearDropOption: function ($nepaliDatePicker) { var datePickerData = $nepaliDatePicker.data(), $yearSpan = $('<div class="current-year-txt">'); $yearSpan.text(calendarFunctions.getNepaliNumber(datePickerData.bsYear)), $yearSpan.append('<i class="icon icon-drop-down">'); for (var data = [], i = datePickerPlugin.options.yearStart; i <= datePickerPlugin.options.yearEnd; i++)data.push({ label: calendarFunctions.getNepaliNumber(i), value: i }); var $yearDropOption = datePickerPlugin.getCustomSelectOption(data, datePickerData.bsYear).addClass("year-drop-down"); return $yearSpan.append($yearDropOption), $yearSpan }, getCustomSelectOption: function (datas, activeValue) { var $dropDown = $('<div class="drop-down-content" data-value="' + activeValue + '">'), $dropDownWrapper = $('<div class="option-wrapper">'), $ul = $("<ul>"); return $.each(datas, function (index, data) { $ul.append('<li data-value="' + data.value + '">' + data.label + "</li>") }), $dropDownWrapper.append($ul), $ul.find('li[data-value="' + activeValue + '"]').addClass("active"), $dropDown.append($dropDownWrapper), $dropDown }, getCalendarHeader: function () { for (var calendarHeader = $("<thead>"), tableRow = $("<tr>"), i = 0; i < 7; i++)tableRow.append("<td>" + calendarData.bsDays[i] + "</td>"); return calendarHeader.append(tableRow), calendarHeader }, getCalendarBody: function ($nepaliDatePicker) { var datePickerData = $nepaliDatePicker.data(), weekCoverInMonth = Math.ceil((datePickerData.bsMonthFirstAdDate.getDay() + datePickerData.bsMonthDays) / 7), preMonth = datePickerData.bsMonth - 1 !== 0 ? datePickerData.bsMonth - 1 : 12, preYear = 12 === preMonth ? datePickerData.bsYear - 1 : datePickerData.bsYear, preMonthDays = preYear >= calendarData.minBsYear ? calendarFunctions.getBsMonthDays(preYear, preMonth) : 30, minBsDate = null, maxBsDate = null; null !== datePickerPlugin.options.minDate && (minBsDate = calendarFunctions.parseFormattedBsDate(datePickerPlugin.options.dateFormat, datePickerPlugin.options.minDate)), null !== datePickerPlugin.options.maxDate && (maxBsDate = calendarFunctions.parseFormattedBsDate(datePickerPlugin.options.dateFormat, datePickerPlugin.options.maxDate)); for (var calendarBody = $("<tbody>"), i = 0; i < weekCoverInMonth; i++) { for (var tableRow = $("<tr>"), k = 1; k <= 7; k++) { var calendarDate = 7 * i + k - datePickerData.bsMonthFirstAdDate.getDay(), isCurrentMonthDate = !0; if (calendarDate <= 0 ? (calendarDate = preMonthDays + calendarDate, isCurrentMonthDate = !1) : calendarDate > datePickerData.bsMonthDays && (calendarDate -= datePickerData.bsMonthDays, isCurrentMonthDate = !1), isCurrentMonthDate) { var $td = $('<td class="current-month-date" data-date="' + calendarDate + '" data-weekDay="' + (k - 1) + '">' + calendarFunctions.getNepaliNumber(calendarDate) + "</td>"); calendarDate == datePickerData.bsDate && $td.addClass("active"), datePickerPlugin.disableIfOutOfRange($td, datePickerData, minBsDate, maxBsDate, calendarDate), tableRow.append($td) } else tableRow.append('<td class="other-month-date">' + calendarFunctions.getNepaliNumber(calendarDate) + "</td>") } calendarBody.append(tableRow) } return calendarBody }, disableIfOutOfRange: function ($td, datePickerData, minBsDate, maxBsDate, calendarDate) { return null !== minBsDate && (datePickerData.bsYear < minBsDate.bsYear ? $td.addClass("disable") : datePickerData.bsYear === minBsDate.bsYear && datePickerData.bsMonth < minBsDate.bsMonth ? $td.addClass("disable") : datePickerData.bsYear === minBsDate.bsYear && datePickerData.bsMonth === minBsDate.bsMonth && calendarDate < minBsDate.bsDate && $td.addClass("disable")), null !== maxBsDate && (datePickerData.bsYear > maxBsDate.bsYear ? $td.addClass("disable") : datePickerData.bsYear === maxBsDate.bsYear && datePickerData.bsMonth > maxBsDate.bsMonth ? $td.addClass("disable") : datePickerData.bsYear === maxBsDate.bsYear && datePickerData.bsMonth === maxBsDate.bsMonth && calendarDate > maxBsDate.bsDate && $td.addClass("disable")), $td }, renderCurrentMonthCalendar: function ($nepaliDatePicker) { var currentDate = new Date, currentBsDate = calendarFunctions.getBsDateByAdDate(currentDate.getFullYear(), currentDate.getMonth() + 1, currentDate.getDate()), bsYear = currentBsDate.bsYear, bsMonth = currentBsDate.bsMonth, bsDate = currentBsDate.bsDate; datePickerPlugin.setCalendarDate($nepaliDatePicker, bsYear, bsMonth, bsDate), datePickerPlugin.renderMonthCalendar($nepaliDatePicker) }, renderPreviousMonthCalendar: function ($nepaliDatePicker) { var datePickerData = $nepaliDatePicker.data(), prevMonth = datePickerData.bsMonth - 1 > 0 ? datePickerData.bsMonth - 1 : 12, prevYear = 12 !== prevMonth ? datePickerData.bsYear : datePickerData.bsYear - 1, prevDate = datePickerData.bsDate; return prevYear < datePickerPlugin.options.yearStart || prevYear > datePickerPlugin.options.yearEnd ? null : (datePickerPlugin.setCalendarDate($nepaliDatePicker, prevYear, prevMonth, prevDate), void datePickerPlugin.renderMonthCalendar($nepaliDatePicker)) }, renderNextMonthCalendar: function ($nepaliDatePicker) { var datePickerData = $nepaliDatePicker.data(), nextMonth = datePickerData.bsMonth + 1 <= 12 ? datePickerData.bsMonth + 1 : 1, nextYear = 1 !== nextMonth ? datePickerData.bsYear : datePickerData.bsYear + 1, nextDate = datePickerData.bsDate; return nextYear < datePickerPlugin.options.yearStart || nextYear > datePickerPlugin.options.yearEnd ? null : (datePickerPlugin.setCalendarDate($nepaliDatePicker, nextYear, nextMonth, nextDate), void datePickerPlugin.renderMonthCalendar($nepaliDatePicker)) }, renderFormattedSpecificDateCalendar: function ($nepaliDatePicker, dateFormat, dateFormattedText) { var datePickerDate = calendarFunctions.parseFormattedBsDate(dateFormat, dateFormattedText); datePickerPlugin.setCalendarDate($nepaliDatePicker, datePickerDate.bsYear, datePickerDate.bsMonth, datePickerDate.bsDate), datePickerPlugin.renderMonthCalendar($nepaliDatePicker) } }; return this.each(function () { var $element = $(this); datePickerPlugin.init($element) }), datePickerPlugin.addCommonEventHandler(), this } }(jQuery, calendarFunctions);</script>
<a id="dlink" style="display:none;"></a>
<button type="button" class="btn btn-primary btn-sm" style="vertical-align: middle;"
    onclick="printContent('printing')"><span class="glyphicon glyphicon-print" style="font-size: 15px;"></span> &nbsp;
    Print
</button>

<button type="button" class="btn btn-success btn-sm" style="vertical-align: middle;" id="btnExport"
    onclick="tableToExcel('dataTable', 'HMIS 7.8 HIV Prevention - NSP Register', 'HMIS 7.8 HIV Prevention - NSP Register')"><span
        class="glyphicon glyphicon-download-alt" style="font-size: 15px;"></span>Download As Excel</button>
<div align="center">
    <div style="width: 50%; margin: 0 auto;">
        <table class="table table-borderless table-striped">
            <tr style="border: 1px solid #DDDDDD;">
                <td style="font-size: 15px;padding-top: 15px;">
                    <label for="dateFormat"><strong>Select Date Fomart : </strong></label>
                </td>
                <td style="width: 60%;">

                    <select id="dateFormat" onchange="showCalendar()" class="form-control">
                        <option selected hidden> Please Select a Calendar Format</option>
                        <option value="gc">English calendar</option>
                        <option value="vc">Nepali calendar</option>
                    </select>
                </td>
            </tr>
        </table>
    </div>
</div>
<div id="loader" style="display: none"></div>
<div id='state'>
    <div style="width: 50%; margin-left:25%;">
        <table class="table table-borderless table-striped">
            <tr style="border: 1px solid #DDDDDD;">
                <td style="font-size: 15px;padding-top: 15px;">
                    <strong>Start Month : </strong>
                </td>
                <td style="width: 60%;">
                    <input type="text" class="date form-control" id="start-date">
                    <input type="date" class="form-control" id="start-date-gc">
                </td>
            </tr>
            <tr>
                <td style="font-size: 15px;padding-top: 15px;">
                    <strong>End Month : </strong>
                </td>
                <td style="width: 60%;">
                    <input type="text" class="date form-control" id="end-date">
                    <input type="date" class="form-control" id="end-date-gc">
                </td>
            </tr>
            <tr>
                <td colspan="2"><button onClick="submitData()" class="btn btn-primary" id="tap">Submit</button></td>
            </tr>
        </table>
    </div>
    <div id="printing" class="animate-bottom">
        <div id='state'>
            <table border="1" id="dataTable" class="table  table-hover text-center" cellspacing="6" cellpadding="4"
                style="border-collapse: collapse; text-align: center;">
                <thead>
                    <tr style="font-weight:800; text-align:center;">
                        <td colspan="43" style="border:1px solid black;background:#ADD8E6;">HMIS 7.8 HIV Prevention -
                            NSP Register</td>
                    </tr>
                    <tr style="font-weight:800; text-align:center;">
                        <td id="facility" colspan="43" style="border:1px solid black;background:#ADD8E6;"></td>
                    </tr>
                    <tr style="font-weight:800; text-align:center;">
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">S.N.</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Date</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Partner</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Automated Serial Number</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Client Code</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Last Name</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Client Type</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Case Type</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Date of birth</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Age</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Sex</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Syringe Out 1ML(Pcs)</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Syringe Out 2ML(Pcs)</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Syringe Out 3ML(Pcs)</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Syringe Out 5ML(Pcs)</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Syringe In 1ML(Pcs)</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Syringe In 2ML(Pcs)</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Syringe In 3ML(Pcs)</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Syringe In 5ML(Pcs)</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">No of Alcohol Swab (Pcs)
                        </td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">No of Condom (Pcs)</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">No of IEC Material (Pcs)
                        </td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">PHC Services</td>
                        <td colspan="9" style="border:1px solid black;background:#ADD8E6;">Education Information
                        </td>
                        <td colspan="10" style="border:1px solid black;background:#ADD8E6;">Refrerral</td>
                        <td rowspan="2" style="border:1px solid black;background:#ADD8E6;">Remarks</td>
                    </tr>
                    <tr style="font-weight:800; text-align:center;">
                        <td style="border:1px solid black;background:#ADD8E6;">Abcess</td>
                        <td style="border:1px solid black;background:#ADD8E6;">Harm Reduction</td>
                        <td style="border:1px solid black;background:#ADD8E6;">Hepatitis B</td>
                        <td style="border:1px solid black;background:#ADD8E6;">Hepatitis C</td>
                        <td style="border:1px solid black;background:#ADD8E6;">HIV/AIDS</td>
                        <td style="border:1px solid black;background:#ADD8E6;">Overdose</td>
                        <td style="border:1px solid black;background:#ADD8E6;">Safer Injecting</td>
                        <td style="border:1px solid black;background:#ADD8E6;">STI</td>
                        <td style="border:1px solid black;background:#ADD8E6;">Others</td>

                        <td style="border:1px solid black;background:#ADD8E6;">CHBC</td>
                        <td style="border:1px solid black;background:#ADD8E6;">Detox/Rehab</td>
                        <td style="border:1px solid black;background:#ADD8E6;">Hepatitis B</td>
                        <td style="border:1px solid black;background:#ADD8E6;">Hepatitis C</td>
                        <td style="border:1px solid black;background:#ADD8E6;">STI</td>
                        <td style="border:1px solid black;background:#ADD8E6;">HIV Testing</td>
                        <td style="border:1px solid black;background:#ADD8E6;">TB Diagnosis and Treatment</td>
                        <td style="border:1px solid black;background:#ADD8E6;">Medical</td>
                        <td style="border:1px solid black;background:#ADD8E6;">Others</td>
                        <td style="border:1px solid black;background:#ADD8E6;">Others (Specify)</td>

                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>
</div>
<script>

    var selectedOrgUnit = dhis2.report.organisationUnit;
    document.getElementById("state").style.display = "none";
    function showCalendar() {
        let calendar = document.getElementById("dateFormat").value;
        if (calendar == "gc") {
            document.getElementById("start-date-gc").style.display = "block";
            document.getElementById("end-date-gc").style.display = "block";
            document.getElementById("start-date").style.display = "none";
            document.getElementById("end-date").style.display = "none";
        } else {
            document.getElementById("start-date-gc").style.display = "none";
            document.getElementById("end-date-gc").style.display = "none";
            document.getElementById("start-date").style.display = "block";
            document.getElementById("end-date").style.display = "block";
        }

        document.getElementById("state").style.display = "block";
    }
    var currentDate = new Date();
    var currentNepaliDate = calendarFunctions.getBsDateByAdDate(currentDate.getFullYear(), currentDate.getMonth() + 1, currentDate.getDate());
    var formatedNepaliDate = calendarFunctions.bsDateFormat("%y-%m-%d", currentNepaliDate.bsYear, currentNepaliDate.bsMonth, currentNepaliDate.bsDate);
    $(".date").val(formatedNepaliDate);
    $(".date").nepaliDatePicker({
        dateFormat: "%y-%m-%d",
        closeOnDateSelect: true,
        maxDate: formatedNepaliDate
    });
    var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]
    $('#dataTable').hide();
    $('#loader').hide();
    async function submitData() {
        $('#dataTable').hide();
        // var StartDate = document.getElementById("start-date").value;
        // var EndDate = document.getElementById("end-date").value;
        // var d = StartDate.split('-')
        // var e = EndDate.split('-')
        // var sYear = calendarFunctions.getNumberByNepaliNumber(d[0])
        // var sMonth = calendarFunctions.getNumberByNepaliNumber(d[1])
        // var sDay = calendarFunctions.getNumberByNepaliNumber(d[2])
        // var eYear = calendarFunctions.getNumberByNepaliNumber(e[0])
        // var eMonth = calendarFunctions.getNumberByNepaliNumber(e[1])
        // var eDay = calendarFunctions.getNumberByNepaliNumber(e[2])
        // var sdate = calendarFunctions.getAdDateByBsDate(sYear, sMonth, sDay)
        // var startDate = sdate.getFullYear() + '-' + (sdate.getMonth() + 1) + '-' + sdate.getDate();
        // var edate = calendarFunctions.getAdDateByBsDate(eYear, eMonth, eDay)
        // var endDate = edate.getFullYear() + '-' + (edate.getMonth() + 1) + '-' + edate.getDate();
        // console.log(startDate, endDate);

        let startDate = "", endDate = "";
        let calendar = document.getElementById("dateFormat").value;
        if (calendar == "gc") {
            let StartDate = document.getElementById("start-date-gc").value;
            let EndDate = document.getElementById("end-date-gc").value;
            startDate = StartDate;
            endDate = EndDate;
        } else {
            let StartDate = document.getElementById("start-date").value;
            let EndDate = document.getElementById("end-date").value;
            let d = StartDate.split('-')
            let e = EndDate.split('-')
            let sYear = calendarFunctions.getNumberByNepaliNumber(d[0])
            let sMonth = calendarFunctions.getNumberByNepaliNumber(d[1])
            let sDay = calendarFunctions.getNumberByNepaliNumber(d[2])
            let eYear = calendarFunctions.getNumberByNepaliNumber(e[0])
            let eMonth = calendarFunctions.getNumberByNepaliNumber(e[1])
            let eDay = calendarFunctions.getNumberByNepaliNumber(e[2])
            let sdate = calendarFunctions.getAdDateByBsDate(sYear, sMonth, sDay)
            startDate = sdate.getFullYear() + '-' + (sdate.getMonth() + 1) + '-' + sdate.getDate();
            let edate = calendarFunctions.getAdDateByBsDate(eYear, eMonth, eDay)
            endDate = edate.getFullYear() + '-' + (edate.getMonth() + 1) + '-' + edate.getDate();

        }
        var month = [startDate, endDate];
        if (!startDate || !endDate || new Date(startDate) > new Date(endDate)) {
            alert("Please Select dates Correctly!");
            return;
        } else {
            // document.getElementById("dataTable").style.visibility = "hidden";
            // document.getElementById("facility").innerHTML = selectedOrgUnit.name + " ( " + startDate + " to " + endDate + " )"
            // document.getElementById("loader").style.display = "block";
            document.getElementById("facility").innerHTML = selectedOrgUnit.name + " ( " + startDate + " to " + endDate + " )"
            $('#loader').show();
            var organisationUnits = await orgUnitChildren();

            async function orgUnitChildren() {
                var saveChildrenGroup = {};
                var resSaveChildrenGroup = await (await fetch("../../organisationUnitGroups/cTjJqVCtVGs.json?fields=id,name,organisationUnits[id,name]&paging=false")).json();
                resSaveChildrenGroup.organisationUnits.forEach(ou => saveChildrenGroup[ou.id] = true)

                var orgUnitChildren = [];
                var url = '../../organisationUnits/' + selectedOrgUnit.id + '.json?paging=false&fields=id,name,level';

                let response = await fetch('../../organisationUnitLevels.json');
                var orgUnitLevel = await response.json();

                for (let i = 0; i < orgUnitLevel.organisationUnitLevels.length; i++) url += ',children[id,name,level';
                url += ']';

                response = await fetch(url);
                var data = await response.json();

                treeDown(data);

                function treeDown(arr) {
                    var key = arr;
                    if (key.children.length) for (let i = 0; i < key.children.length; i++)  treeDown(key.children[i]);
                    if (saveChildrenGroup[key.id]) orgUnitChildren.push(key.id);
                }
                return orgUnitChildren;
            }
            debugger;
            var sn = 0;
            var tableData = ''
            var totals = [];
            for (i = 0; i < 32; i++) totals[i] = 0;
            for (let orgUnit of organisationUnits) {
                var url = '../../analytics/events/query/L78QzNqadTV.json?paging=false&startDate=' + month["0"] + '&endDate=' + month["1"] + '&dimension=ou:' + orgUnit + '&dimension=pULhHeN8TUj&dimension=drKkLxaGFwv&dimension=gVGIL7DJp4b&dimension=goEnnJeZzyf.ewOQbQgHCK0&dimension=goEnnJeZzyf.O4e8XhePNPJ&dimension=goEnnJeZzyf.VtrGj3jL6yw&dimension=goEnnJeZzyf.OXLrzn2xEjA&dimension=goEnnJeZzyf.MjLhr1qIHZp&dimension=fOVzjBOZdvQ&dimension=U9uQVlPfT8G&dimension=TN7r3ws7IG9&dimension=goEnnJeZzyf.OZ5icXVrwks&dimension=goEnnJeZzyf.UIVkcnNRSlq&dimension=goEnnJeZzyf.cWku9dlnbA8&dimension=goEnnJeZzyf.dageiqlKnIy&dimension=goEnnJeZzyf.NeObC0WprX6&dimension=goEnnJeZzyf.tJssCUudncd&dimension=goEnnJeZzyf.clMD2ouqbMm&dimension=goEnnJeZzyf.qJNa0mhix75&dimension=goEnnJeZzyf.G9wgYktIqyO&dimension=goEnnJeZzyf.oZtGVLUzuIy&dimension=goEnnJeZzyf.Rr9KtIWFcky&dimension=goEnnJeZzyf.hsaJZstwK6w&dimension=goEnnJeZzyf.asnW666VTcT&dimension=goEnnJeZzyf.vVswkLzwsLD&dimension=goEnnJeZzyf.lDuVoG71o1p&dimension=goEnnJeZzyf.kRvFIyagi96&dimension=goEnnJeZzyf.KoCS3gUscnQ&dimension=goEnnJeZzyf.KnXOlX34Grk&dimension=goEnnJeZzyf.FIES1hlQl91&dimension=goEnnJeZzyf.eASJTK5r2yP&dimension=goEnnJeZzyf.zGZN8drCD66&dimension=goEnnJeZzyf.W78DQNfWW9X&dimension=goEnnJeZzyf.S7Pz5uDJCag&dimension=goEnnJeZzyf.m0WnTlLzYJD&dimension=goEnnJeZzyf.GE9EFdBzhOT&dimension=goEnnJeZzyf.CVWHRwVK1W9&dimension=goEnnJeZzyf.Opjv0BnS6ex&dimension=goEnnJeZzyf.qvmrxmoTLAx&dimension=goEnnJeZzyf.zhhkY9g5yJC&dimension=goEnnJeZzyf.j82UzcH5twn&dimension=goEnnJeZzyf.KQ4bsj3tsk2&dimension=goEnnJeZzyf.vGs0hiPd0XS&stage=goEnnJeZzyf&displayProperty=NAME&outputType=EVENT&desc=eventdate';
                var idIndex = {};
                var value = '';
                $.ajax({
                    type: "GET",
                    async: false,
                    url: url,
                    data: JSON,
                    success: function (res) {
                        res.headers.forEach((header, index) => idIndex[header.name] = index);
                        value = res.rows;
                    }
                })



                for (let val of value) {
                    let clientType = '';
                    clientType += val[idIndex['goEnnJeZzyf.ewOQbQgHCK0']] ? 'Non-User (PWID)' : '';
                    clientType += val[idIndex['goEnnJeZzyf.O4e8XhePNPJ']] ? 'Drug user (PWID)' : '';
                    clientType += val[idIndex['goEnnJeZzyf.VtrGj3jL6yw']] ? 'Transit user (PWID)' : '';
                    clientType += val[idIndex['goEnnJeZzyf.OXLrzn2xEjA']] ? 'Ex-User (PWID)' : '';
                    var row = '<tr>';
                    row += '<td>' + (++sn) + '</td>'

                    row += '<td>' + val[idIndex['eventdate']].slice(0, 10) + '</td>'
                    row += '<td>' + val[idIndex['ouname']] + '</td>';
                    row += '<td>' + val[idIndex['pULhHeN8TUj']] + '</td>';
                    row += '<td>' + val[idIndex['drKkLxaGFwv']] + '</td>';
                    row += '<td>' + val[idIndex['gVGIL7DJp4b']] + '</td>';
                    row += '<td>' + clientType + '</td>';
                    row += '<td>' + val[idIndex['goEnnJeZzyf.MjLhr1qIHZp']] + '</td>';
                    row += '<td>' + (val[idIndex['fOVzjBOZdvQ']] ? val[idIndex['fOVzjBOZdvQ']].split(' ')[0] : "") + '</td>';
                    row += Number(val[idIndex['U9uQVlPfT8G']]) ? '<td>' + Number(val[idIndex['U9uQVlPfT8G']]) + '</td>' : '<td></td>';
                    row += '<td>' + val[idIndex['TN7r3ws7IG9']] + '</td>';
                    row += val[idIndex['goEnnJeZzyf.OZ5icXVrwks']] ? '<td>' + Number(val[idIndex['goEnnJeZzyf.OZ5icXVrwks']]) + '</td>' : '<td></td>';
                    row += val[idIndex['goEnnJeZzyf.UIVkcnNRSlq']] ? '<td>' + Number(val[idIndex['goEnnJeZzyf.UIVkcnNRSlq']]) + '</td>' : '<td></td>';
                    row += val[idIndex['goEnnJeZzyf.cWku9dlnbA8']] ? '<td>' + Number(val[idIndex['goEnnJeZzyf.cWku9dlnbA8']]) + '</td>' : '<td></td>';
                    row += val[idIndex['goEnnJeZzyf.dageiqlKnIy']] ? '<td>' + Number(val[idIndex['goEnnJeZzyf.dageiqlKnIy']]) + '</td>' : '<td></td>';
                    row += val[idIndex['goEnnJeZzyf.NeObC0WprX6']] ? '<td>' + Number(val[idIndex['goEnnJeZzyf.NeObC0WprX6']]) + '</td>' : '<td></td>';
                    row += val[idIndex['goEnnJeZzyf.tJssCUudncd']] ? '<td>' + Number(val[idIndex['goEnnJeZzyf.tJssCUudncd']]) + '</td>' : '<td></td>';
                    row += val[idIndex['goEnnJeZzyf.clMD2ouqbMm']] ? '<td>' + Number(val[idIndex['goEnnJeZzyf.clMD2ouqbMm']]) + '</td>' : '<td></td>';
                    row += val[idIndex['goEnnJeZzyf.qJNa0mhix75']] ? '<td>' + Number(val[idIndex['goEnnJeZzyf.qJNa0mhix75']]) + '</td>' : '<td></td>';
                    row += val[idIndex['goEnnJeZzyf.G9wgYktIqyO']] ? '<td>' + Number(val[idIndex['goEnnJeZzyf.G9wgYktIqyO']]) + '</td>' : '<td></td>';
                    row += val[idIndex['goEnnJeZzyf.oZtGVLUzuIy']] ? '<td>' + Number(val[idIndex['goEnnJeZzyf.oZtGVLUzuIy']]) + '</td>' : '<td></td>';
                    row += val[idIndex['goEnnJeZzyf.Rr9KtIWFcky']] ? '<td>' + Number(val[idIndex['goEnnJeZzyf.Rr9KtIWFcky']]) + '</td>' : '<td></td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.hsaJZstwK6w']] === "" ? '' : (val[idIndex['goEnnJeZzyf.hsaJZstwK6w']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.asnW666VTcT']] === "" ? '' : (val[idIndex['goEnnJeZzyf.asnW666VTcT']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.vVswkLzwsLD']] === "" ? '' : (val[idIndex['goEnnJeZzyf.vVswkLzwsLD']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.lDuVoG71o1p']] === "" ? '' : (val[idIndex['goEnnJeZzyf.lDuVoG71o1p']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.kRvFIyagi96']] === "" ? '' : (val[idIndex['goEnnJeZzyf.kRvFIyagi96']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.KoCS3gUscnQ']] === "" ? '' : (val[idIndex['goEnnJeZzyf.KoCS3gUscnQ']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.KnXOlX34Grk']] === "" ? '' : (val[idIndex['goEnnJeZzyf.KnXOlX34Grk']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.FIES1hlQl91']] === "" ? '' : (val[idIndex['goEnnJeZzyf.FIES1hlQl91']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.eASJTK5r2yP']] === "" ? '' : (val[idIndex['goEnnJeZzyf.eASJTK5r2yP']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + val[idIndex['goEnnJeZzyf.zGZN8drCD66']] + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.W78DQNfWW9X']] === "" ? '' : (val[idIndex['goEnnJeZzyf.W78DQNfWW9X']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.S7Pz5uDJCag']] === "" ? '' : (val[idIndex['goEnnJeZzyf.S7Pz5uDJCag']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.m0WnTlLzYJD']] === "" ? '' : (val[idIndex['goEnnJeZzyf.m0WnTlLzYJD']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.GE9EFdBzhOT']] === "" ? '' : (val[idIndex['goEnnJeZzyf.GE9EFdBzhOT']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.CVWHRwVK1W9']] === "" ? '' : (val[idIndex['goEnnJeZzyf.CVWHRwVK1W9']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.Opjv0BnS6ex']] === "" ? '' : (val[idIndex['goEnnJeZzyf.Opjv0BnS6ex']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.qvmrxmoTLAx']] === "" ? '' : (val[idIndex['goEnnJeZzyf.qvmrxmoTLAx']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.zhhkY9g5yJC']] === "" ? '' : (val[idIndex['goEnnJeZzyf.zhhkY9g5yJC']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + (val[idIndex['goEnnJeZzyf.j82UzcH5twn']] === "" ? '' : (val[idIndex['goEnnJeZzyf.j82UzcH5twn']] === "0" ? "No" : "Yes")) + '</td>';
                    row += '<td>' + val[idIndex['goEnnJeZzyf.KQ4bsj3tsk2']] + '</td>';
                    row += '<td>' + val[idIndex['goEnnJeZzyf.vGs0hiPd0XS']] + '</td>';
                    row += "</tr>"
                    tableData += row;

                    totals[0] += (val[idIndex['goEnnJeZzyf.OZ5icXVrwks']] && val[idIndex['goEnnJeZzyf.OZ5icXVrwks']] != "NaN" ? Number(val[idIndex['goEnnJeZzyf.OZ5icXVrwks']]) : 0);
                    totals[1] += (val[idIndex['goEnnJeZzyf.UIVkcnNRSlq']] && val[idIndex['goEnnJeZzyf.UIVkcnNRSlq']] != "NaN" ? Number(val[idIndex['goEnnJeZzyf.UIVkcnNRSlq']]) : 0);
                    totals[2] += (val[idIndex['goEnnJeZzyf.cWku9dlnbA8']] && val[idIndex['goEnnJeZzyf.cWku9dlnbA8']] != "NaN" ? Number(val[idIndex['goEnnJeZzyf.cWku9dlnbA8']]) : 0);
                    totals[3] += (val[idIndex['goEnnJeZzyf.dageiqlKnIy']] && val[idIndex['goEnnJeZzyf.dageiqlKnIy']] != "NaN" ? Number(val[idIndex['goEnnJeZzyf.dageiqlKnIy']]) : 0);
                    totals[4] += (val[idIndex['goEnnJeZzyf.NeObC0WprX6']] && val[idIndex['goEnnJeZzyf.NeObC0WprX6']] != "NaN" ? Number(val[idIndex['goEnnJeZzyf.NeObC0WprX6']]) : 0);
                    totals[5] += (val[idIndex['goEnnJeZzyf.tJssCUudncd']] && val[idIndex['goEnnJeZzyf.tJssCUudncd']] != "NaN" ? Number(val[idIndex['goEnnJeZzyf.tJssCUudncd']]) : 0);
                    totals[6] += (val[idIndex['goEnnJeZzyf.clMD2ouqbMm']] && val[idIndex['goEnnJeZzyf.clMD2ouqbMm']] != "NaN" ? Number(val[idIndex['goEnnJeZzyf.clMD2ouqbMm']]) : 0);
                    totals[7] += (val[idIndex['goEnnJeZzyf.qJNa0mhix75']] && val[idIndex['goEnnJeZzyf.qJNa0mhix75']] != "NaN" ? Number(val[idIndex['goEnnJeZzyf.qJNa0mhix75']]) : 0);
                    totals[8] += (val[idIndex['goEnnJeZzyf.G9wgYktIqyO']] && val[idIndex['goEnnJeZzyf.G9wgYktIqyO']] != "NaN" ? Number(val[idIndex['goEnnJeZzyf.G9wgYktIqyO']]) : 0);
                    totals[9] += (val[idIndex['goEnnJeZzyf.oZtGVLUzuIy']] && val[idIndex['goEnnJeZzyf.oZtGVLUzuIy']] != "NaN" ? Number(val[idIndex['goEnnJeZzyf.oZtGVLUzuIy']]) : 0);
                    totals[10] += (val[idIndex['goEnnJeZzyf.Rr9KtIWFcky']] && val[idIndex['goEnnJeZzyf.Rr9KtIWFcky']] != "NaN" ? Number(val[idIndex['goEnnJeZzyf.Rr9KtIWFcky']]) : 0);
                    totals[11] += (val[idIndex['goEnnJeZzyf.hsaJZstwK6w']] == '1' ? 1 : 0)
                    totals[12] += (val[idIndex['goEnnJeZzyf.asnW666VTcT']] == '1' ? 1 : 0);
                    totals[13] += (val[idIndex['goEnnJeZzyf.vVswkLzwsLD']] == '1' ? 1 : 0);
                    totals[14] += (val[idIndex['goEnnJeZzyf.lDuVoG71o1p']] == '1' ? 1 : 0);
                    totals[15] += (val[idIndex['goEnnJeZzyf.kRvFIyagi96']] == '1' ? 1 : 0);
                    totals[16] += (val[idIndex['goEnnJeZzyf.KoCS3gUscnQ']] == '1' ? 1 : 0);
                    totals[17] += (val[idIndex['goEnnJeZzyf.KnXOlX34Grk']] == '1' ? 1 : 0);
                    totals[18] += (val[idIndex['goEnnJeZzyf.FIES1hlQl91']] == '1' ? 1 : 0);
                    totals[19] += (val[idIndex['goEnnJeZzyf.eASJTK5r2yP']] == '1' ? 1 : 0);
                    totals[20] += (val[idIndex['goEnnJeZzyf.zGZN8drCD66']] ? 1 : 0);
                    totals[21] += (val[idIndex['goEnnJeZzyf.W78DQNfWW9X']] == '1' ? 1 : 0);
                    totals[22] += (val[idIndex['goEnnJeZzyf.S7Pz5uDJCag']] == '1' ? 1 : 0);
                    totals[23] += (val[idIndex['goEnnJeZzyf.m0WnTlLzYJD']] == '1' ? 1 : 0);
                    totals[24] += (val[idIndex['goEnnJeZzyf.GE9EFdBzhOT']] == '1' ? 1 : 0);
                    totals[25] += (val[idIndex['goEnnJeZzyf.CVWHRwVK1W9']] == '1' ? 1 : 0);
                    totals[26] += (val[idIndex['goEnnJeZzyf.Opjv0BnS6ex']] == '1' ? 1 : 0);
                    totals[27] += (val[idIndex['goEnnJeZzyf.qvmrxmoTLAx']] == '1' ? 1 : 0);
                    totals[28] += (val[idIndex['goEnnJeZzyf.zhhkY9g5yJC']] == '1' ? 1 : 0);
                    totals[29] += (val[idIndex['goEnnJeZzyf.j82UzcH5twn']] == '1' ? 1 : 0);
                    totals[30] += (val[idIndex['goEnnJeZzyf.KQ4bsj3tsk2']] ? 1 : 0);
                    totals[31] += (val[idIndex['goEnnJeZzyf.vGs0hiPd0XS']] ? 1 : 0);
                    debugger;

                }
            }
            tableData += '<tr><td style="background-color:rgba(0, 0, 0, 0.05);" colspan = "3">Totals</td>';
            for (let i = 0; i < 8; i++) tableData += '<td style="background-color:rgba(0, 0, 0, 0.05);"></td>';
            totals.forEach(total => tableData += `<td style="background-color:rgba(0, 0, 0, 0.05);">${total}</td>`);
            tableData += '</tr>';

            document.getElementById("tableBody").innerHTML = tableData;

            $('#dataTable').show();
            $('#loader').hide();
        }
    }
    var tableToExcel = (function () {
        var uri = 'data:application/vnd.ms-excel;base64,'
            , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
            , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
            , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
        return function (table, name, filename) {
            if (!table.nodeType) table = document.getElementById(table)
            var ctx = { worksheet: name || 'Worksheet', table: table.innerHTML }
            document.getElementById("dlink").href = uri + base64(format(template, ctx));
            document.getElementById("dlink").download = filename + "-" + selectedOrgUnit.name + ".xls";
            document.getElementById("dlink").click();
        }
    })()

    function printContent(el) {
        var restorepage = document.body.innerHTML;
        var printcontent = document.getElementById(el).innerHTML;
        document.body.innerHTML = printcontent;
        window.print();
        document.body.innerHTML = restorepage;
    }
</script>