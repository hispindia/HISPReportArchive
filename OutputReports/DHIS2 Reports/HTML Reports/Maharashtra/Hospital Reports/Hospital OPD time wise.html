<script type="text/javascript" src="javascript/DownloadAsExcel.js"></script>
<script>
    //JavaScript code goes here

    var periods = dhis2.report.periods;
    var period = periods[0];
    var orgUnit = dhis2.report.organisationUnit;
    var check=0;
    var hospitalsID = [];
    var orgUnitUIDs = "";

    var index1 = 0;
    var index2 = 0;
    var index3 = 0;

    var cirNames = [];
    var cirIDs = [];

    var districtIDs = [];
    var districtNames = [];

    var hospitalIDs = [];
    var hospitalNames = [];

    //Two arrays to keep the name and ID's of relevant hospital groups in a circle
    var orgNames = [];
    var orgIDs = [];
    //var deUIDs = "";
    var noOfCircles;

    var orgUnitChildren;
    //two variables to keep total of organisation unit children and no of hospitals
    var noOfHospitals;
    var noOfOrgUnitChildren;
    var noOfDistricts;
    var districtCircle = [];
    var hospitalDistrict = [];

    var noOfHospitalss;

    var tableDX = [
        {
            dxName: "MNMChildren",
            dxId: "UROqXtz4l0L.xD6lmYsuXEF+zja1VSMWp8m.xD6lmYsuXEF+Fd69CR15Kb7.xD6lmYsuXEF+QZj31W8iDqf.xD6lmYsuXEF+woC5n7JpeRd.xD6lmYsuXEF+P5l9reCQSos.xD6lmYsuXEF+DtmsvisQUha.xD6lmYsuXEF+P0Ytk0RKmbJ.xD6lmYsuXEF+kv9nGOpOXM0.xD6lmYsuXEF+Mx6a0AMHygn.xD6lmYsuXEF+qsjP4WtWNeM.xD6lmYsuXEF+yQwGoCoEz6n.xD6lmYsuXEF+oXVvdpkoOpQ.xD6lmYsuXEF+JxWv1puiWhd.xD6lmYsuXEF+LUZhLRGRtpL.xD6lmYsuXEF+iAtRrU8AZBQ.xD6lmYsuXEF"

        },
        {
            dxName: "MNMAdolescense",
            dxId: "UROqXtz4l0L.q7GreYKqtJr+zja1VSMWp8m.q7GreYKqtJr+Fd69CR15Kb7.q7GreYKqtJr+QZj31W8iDqf.q7GreYKqtJr+woC5n7JpeRd.q7GreYKqtJr+P5l9reCQSos.q7GreYKqtJr+DtmsvisQUha.q7GreYKqtJr+P0Ytk0RKmbJ.q7GreYKqtJr+kv9nGOpOXM0.q7GreYKqtJr+Mx6a0AMHygn.q7GreYKqtJr+qsjP4WtWNeM.q7GreYKqtJr+yQwGoCoEz6n.q7GreYKqtJr+oXVvdpkoOpQ.q7GreYKqtJr+JxWv1puiWhd.q7GreYKqtJr+LUZhLRGRtpL.q7GreYKqtJr+iAtRrU8AZBQ.q7GreYKqtJr"

        },
        {
            dxName: "MNMAdult",
            dxId: "UROqXtz4l0L.jp5eEmKFg6c+zja1VSMWp8m.jp5eEmKFg6c+Fd69CR15Kb7.jp5eEmKFg6c+QZj31W8iDqf.jp5eEmKFg6c+woC5n7JpeRd.jp5eEmKFg6c+P5l9reCQSos.jp5eEmKFg6c+DtmsvisQUha.jp5eEmKFg6c+P0Ytk0RKmbJ.jp5eEmKFg6c+kv9nGOpOXM0.jp5eEmKFg6c+Mx6a0AMHygn.jp5eEmKFg6c+qsjP4WtWNeM.jp5eEmKFg6c+yQwGoCoEz6n.jp5eEmKFg6c+oXVvdpkoOpQ.jp5eEmKFg6c+JxWv1puiWhd.jp5eEmKFg6c+LUZhLRGRtpL.jp5eEmKFg6c+iAtRrU8AZBQ.jp5eEmKFg6c"

        },
        {
            dxName: "MNMSenior",
            dxId: "UROqXtz4l0L.NtrO4vkAnz4+zja1VSMWp8m.NtrO4vkAnz4+Fd69CR15Kb7.NtrO4vkAnz4+QZj31W8iDqf.NtrO4vkAnz4+woC5n7JpeRd.NtrO4vkAnz4+P5l9reCQSos.NtrO4vkAnz4+DtmsvisQUha.NtrO4vkAnz4+P0Ytk0RKmbJ.NtrO4vkAnz4+kv9nGOpOXM0.NtrO4vkAnz4+Mx6a0AMHygn.NtrO4vkAnz4+qsjP4WtWNeM.NtrO4vkAnz4+yQwGoCoEz6n.NtrO4vkAnz4+oXVvdpkoOpQ.NtrO4vkAnz4+JxWv1puiWhd.NtrO4vkAnz4+LUZhLRGRtpL.NtrO4vkAnz4+iAtRrU8AZBQ.NtrO4vkAnz4"

        },
        {
            dxName: "MNFChildren",
            dxId: "UROqXtz4l0L.qlprr8RvGRX+zja1VSMWp8m.qlprr8RvGRX+Fd69CR15Kb7.qlprr8RvGRX+QZj31W8iDqf.qlprr8RvGRX+DPimQ948Cdl.qlprr8RvGRX+RL6zDOxipUf.qlprr8RvGRX+woC5n7JpeRd.qlprr8RvGRX+P5l9reCQSos.qlprr8RvGRX+DtmsvisQUha.qlprr8RvGRX+P0Ytk0RKmbJ.qlprr8RvGRX+kv9nGOpOXM0.qlprr8RvGRX+Mx6a0AMHygn.qlprr8RvGRX+qsjP4WtWNeM.qlprr8RvGRX+yQwGoCoEz6n.qlprr8RvGRX+oXVvdpkoOpQ.qlprr8RvGRX+JxWv1puiWhd.qlprr8RvGRX+LUZhLRGRtpL.qlprr8RvGRX+iAtRrU8AZBQ.qlprr8RvGRX"

        },
        {
            dxName: "MNFAdolescense",
            dxId: "UROqXtz4l0L.Bmnh0pn7Wyh+zja1VSMWp8m.Bmnh0pn7Wyh+Fd69CR15Kb7.Bmnh0pn7Wyh+QZj31W8iDqf.Bmnh0pn7Wyh+DPimQ948Cdl.Bmnh0pn7Wyh+RL6zDOxipUf.Bmnh0pn7Wyh+woC5n7JpeRd.Bmnh0pn7Wyh+P5l9reCQSos.Bmnh0pn7Wyh+DtmsvisQUha.Bmnh0pn7Wyh+P0Ytk0RKmbJ.Bmnh0pn7Wyh+kv9nGOpOXM0.Bmnh0pn7Wyh+Mx6a0AMHygn.Bmnh0pn7Wyh+qsjP4WtWNeM.Bmnh0pn7Wyh+yQwGoCoEz6n.Bmnh0pn7Wyh+oXVvdpkoOpQ.Bmnh0pn7Wyh+JxWv1puiWhd.Bmnh0pn7Wyh+LUZhLRGRtpL.Bmnh0pn7Wyh+iAtRrU8AZBQ.Bmnh0pn7Wyh"

        },
        {
            dxName: "MNFAdult",
            dxId: "UROqXtz4l0L.GweI6PQcSuA+zja1VSMWp8m.GweI6PQcSuA+Fd69CR15Kb7.GweI6PQcSuA+QZj31W8iDqf.GweI6PQcSuA+DPimQ948Cdl.GweI6PQcSuA+RL6zDOxipUf.GweI6PQcSuA+woC5n7JpeRd.GweI6PQcSuA+P5l9reCQSos.GweI6PQcSuA+DtmsvisQUha.GweI6PQcSuA+P0Ytk0RKmbJ.GweI6PQcSuA+kv9nGOpOXM0.GweI6PQcSuA+Mx6a0AMHygn.GweI6PQcSuA+qsjP4WtWNeM.GweI6PQcSuA+yQwGoCoEz6n.GweI6PQcSuA+oXVvdpkoOpQ.GweI6PQcSuA+JxWv1puiWhd.GweI6PQcSuA+LUZhLRGRtpL.GweI6PQcSuA+iAtRrU8AZBQ.GweI6PQcSuA"

        },
        {
            dxName: "MNFSenior",
            dxId: "UROqXtz4l0L.UZJ3ufiwuZX+zja1VSMWp8m.UZJ3ufiwuZX+Fd69CR15Kb7.UZJ3ufiwuZX+QZj31W8iDqf.UZJ3ufiwuZX+DPimQ948Cdl.UZJ3ufiwuZX+RL6zDOxipUf.UZJ3ufiwuZX+woC5n7JpeRd.UZJ3ufiwuZX+P5l9reCQSos.UZJ3ufiwuZX+DtmsvisQUha.UZJ3ufiwuZX+P0Ytk0RKmbJ.UZJ3ufiwuZX+kv9nGOpOXM0.UZJ3ufiwuZX+Mx6a0AMHygn.UZJ3ufiwuZX+qsjP4WtWNeM.UZJ3ufiwuZX+yQwGoCoEz6n.UZJ3ufiwuZX+oXVvdpkoOpQ.UZJ3ufiwuZX+JxWv1puiWhd.UZJ3ufiwuZX+LUZhLRGRtpL.UZJ3ufiwuZX+iAtRrU8AZBQ.UZJ3ufiwuZX"

        },
        {
            dxName: "MNTransgender",
            dxId: "OQo3vMLMozg.TVKsg3FE6Ox+N3QS8dseYgK.TVKsg3FE6Ox+pCIgAYbtdcD.TVKsg3FE6Ox+Hr8AuSy4YKS.TVKsg3FE6Ox+VpUGS0bfeMz.TVKsg3FE6Ox+NxYhMBENJnt.TVKsg3FE6Ox+aJ2iu7DSTE3.TVKsg3FE6Ox+CmD9190sTk3.TVKsg3FE6Ox+W5gQjYOpiMz.TVKsg3FE6Ox+EEfp3VGHuII.TVKsg3FE6Ox+kX15I1Xgw3K.TVKsg3FE6Ox+XIq5kSZFIxc.TVKsg3FE6Ox+tYjYIQMBOWg.TVKsg3FE6Ox+YaCaSx5WgeP.TVKsg3FE6Ox+NCn69WVzGmS.TVKsg3FE6Ox+ecJ1sFcbOaw.TVKsg3FE6Ox+TuVCB3F7Tos.TVKsg3FE6Ox+zWZyXSK9DNk.TVKsg3FE6Ox"

        },
        {
            dxName: "MOMChildren",
            dxId: "UROqXtz4l0L.GMMLAxjnI2E+zja1VSMWp8m.GMMLAxjnI2E+Fd69CR15Kb7.GMMLAxjnI2E+QZj31W8iDqf.GMMLAxjnI2E+woC5n7JpeRd.GMMLAxjnI2E+P5l9reCQSos.GMMLAxjnI2E+DtmsvisQUha.GMMLAxjnI2E+P0Ytk0RKmbJ.GMMLAxjnI2E+kv9nGOpOXM0.GMMLAxjnI2E+Mx6a0AMHygn.GMMLAxjnI2E+qsjP4WtWNeM.GMMLAxjnI2E+yQwGoCoEz6n.GMMLAxjnI2E+oXVvdpkoOpQ.GMMLAxjnI2E+JxWv1puiWhd.GMMLAxjnI2E+LUZhLRGRtpL.GMMLAxjnI2E+iAtRrU8AZBQ.GMMLAxjnI2E"

        },
        {
            dxName: "MOMAdolescence",
            dxId: "UROqXtz4l0L.u8bv8gqLJPb+zja1VSMWp8m.u8bv8gqLJPb+Fd69CR15Kb7.u8bv8gqLJPb+QZj31W8iDqf.u8bv8gqLJPb+woC5n7JpeRd.u8bv8gqLJPb+P5l9reCQSos.u8bv8gqLJPb+DtmsvisQUha.u8bv8gqLJPb+P0Ytk0RKmbJ.u8bv8gqLJPb+kv9nGOpOXM0.u8bv8gqLJPb+Mx6a0AMHygn.u8bv8gqLJPb+qsjP4WtWNeM.u8bv8gqLJPb+yQwGoCoEz6n.u8bv8gqLJPb+oXVvdpkoOpQ.u8bv8gqLJPb+JxWv1puiWhd.u8bv8gqLJPb+LUZhLRGRtpL.u8bv8gqLJPb+iAtRrU8AZBQ.u8bv8gqLJPb"

        },


        {
            dxName: "MOMAdult",
            dxId: "UROqXtz4l0L.VOpajE9t9Hj+zja1VSMWp8m.VOpajE9t9Hj+Fd69CR15Kb7.VOpajE9t9Hj+QZj31W8iDqf.VOpajE9t9Hj+woC5n7JpeRd.VOpajE9t9Hj+P5l9reCQSos.VOpajE9t9Hj+DtmsvisQUha.VOpajE9t9Hj+P0Ytk0RKmbJ.VOpajE9t9Hj+kv9nGOpOXM0.VOpajE9t9Hj+Mx6a0AMHygn.VOpajE9t9Hj+qsjP4WtWNeM.VOpajE9t9Hj+yQwGoCoEz6n.VOpajE9t9Hj+oXVvdpkoOpQ.VOpajE9t9Hj+JxWv1puiWhd.VOpajE9t9Hj+LUZhLRGRtpL.VOpajE9t9Hj+iAtRrU8AZBQ.VOpajE9t9Hj"

        },

        {
            dxName: "MOMSenior",
            dxId: "UROqXtz4l0L.V6J0RnDCUN3+zja1VSMWp8m.V6J0RnDCUN3+Fd69CR15Kb7.V6J0RnDCUN3+QZj31W8iDqf.V6J0RnDCUN3+woC5n7JpeRd.V6J0RnDCUN3+P5l9reCQSos.V6J0RnDCUN3+DtmsvisQUha.V6J0RnDCUN3+P0Ytk0RKmbJ.V6J0RnDCUN3+kv9nGOpOXM0.V6J0RnDCUN3+Mx6a0AMHygn.V6J0RnDCUN3+qsjP4WtWNeM.V6J0RnDCUN3+yQwGoCoEz6n.V6J0RnDCUN3+oXVvdpkoOpQ.V6J0RnDCUN3+JxWv1puiWhd.V6J0RnDCUN3+LUZhLRGRtpL.V6J0RnDCUN3+iAtRrU8AZBQ.V6J0RnDCUN3"

        },


        {
            dxName: "MOFChildren",
            dxId: "UROqXtz4l0L.E9P7UuT7XZx+zja1VSMWp8m.E9P7UuT7XZx+Fd69CR15Kb7.E9P7UuT7XZx+QZj31W8iDqf.E9P7UuT7XZx+DPimQ948Cdl.E9P7UuT7XZx+RL6zDOxipUf.E9P7UuT7XZx+woC5n7JpeRd.E9P7UuT7XZx+P5l9reCQSos.E9P7UuT7XZx+DtmsvisQUha.E9P7UuT7XZx+P0Ytk0RKmbJ.E9P7UuT7XZx+kv9nGOpOXM0.E9P7UuT7XZx+Mx6a0AMHygn.E9P7UuT7XZx+qsjP4WtWNeM.E9P7UuT7XZx+yQwGoCoEz6n.E9P7UuT7XZx+oXVvdpkoOpQ.E9P7UuT7XZx+JxWv1puiWhd.E9P7UuT7XZx+LUZhLRGRtpL.E9P7UuT7XZx+iAtRrU8AZBQ.E9P7UuT7XZx"

        },

        {
            dxName: "MOFAdolescence",
            dxId: "UROqXtz4l0L.Xzn4EkzgqnN+zja1VSMWp8m.Xzn4EkzgqnN+Fd69CR15Kb7.Xzn4EkzgqnN+QZj31W8iDqf.Xzn4EkzgqnN+DPimQ948Cdl.Xzn4EkzgqnN+RL6zDOxipUf.Xzn4EkzgqnN+woC5n7JpeRd.Xzn4EkzgqnN+P5l9reCQSos.Xzn4EkzgqnN+DtmsvisQUha.Xzn4EkzgqnN+P0Ytk0RKmbJ.Xzn4EkzgqnN+kv9nGOpOXM0.Xzn4EkzgqnN+Mx6a0AMHygn.Xzn4EkzgqnN+qsjP4WtWNeM.Xzn4EkzgqnN+yQwGoCoEz6n.Xzn4EkzgqnN+oXVvdpkoOpQ.Xzn4EkzgqnN+JxWv1puiWhd.Xzn4EkzgqnN+LUZhLRGRtpL.Xzn4EkzgqnN+iAtRrU8AZBQ.Xzn4EkzgqnN"

        },
        {
            dxName: "MOFAdult",
            dxId: "UROqXtz4l0L.xst6skw6Jis+zja1VSMWp8m.xst6skw6Jis+Fd69CR15Kb7.xst6skw6Jis+QZj31W8iDqf.xst6skw6Jis+DPimQ948Cdl.xst6skw6Jis+RL6zDOxipUf.xst6skw6Jis+woC5n7JpeRd.xst6skw6Jis+P5l9reCQSos.xst6skw6Jis+DtmsvisQUha.xst6skw6Jis+P0Ytk0RKmbJ.xst6skw6Jis+kv9nGOpOXM0.xst6skw6Jis+Mx6a0AMHygn.xst6skw6Jis+qsjP4WtWNeM.xst6skw6Jis+yQwGoCoEz6n.xst6skw6Jis+oXVvdpkoOpQ.xst6skw6Jis+JxWv1puiWhd.xst6skw6Jis+LUZhLRGRtpL.xst6skw6Jis+iAtRrU8AZBQ.xst6skw6Jis"

        },
        {
            dxName: "MOFSenior",
            dxId: "UROqXtz4l0L.eJd6lKrVOD9+zja1VSMWp8m.eJd6lKrVOD9+Fd69CR15Kb7.eJd6lKrVOD9+QZj31W8iDqf.eJd6lKrVOD9+DPimQ948Cdl.eJd6lKrVOD9+RL6zDOxipUf.eJd6lKrVOD9+woC5n7JpeRd.eJd6lKrVOD9+P5l9reCQSos.eJd6lKrVOD9+DtmsvisQUha.eJd6lKrVOD9+P0Ytk0RKmbJ.eJd6lKrVOD9+kv9nGOpOXM0.eJd6lKrVOD9+Mx6a0AMHygn.eJd6lKrVOD9+qsjP4WtWNeM.eJd6lKrVOD9+yQwGoCoEz6n.eJd6lKrVOD9+oXVvdpkoOpQ.eJd6lKrVOD9+JxWv1puiWhd.eJd6lKrVOD9+LUZhLRGRtpL.eJd6lKrVOD9+iAtRrU8AZBQ.eJd6lKrVOD9"

        },
        {
            dxName: "MOFTransgender",
            dxId: "OQo3vMLMozg.qy8hh5TKmAw+N3QS8dseYgK.qy8hh5TKmAw+pCIgAYbtdcD.qy8hh5TKmAw+Hr8AuSy4YKS.qy8hh5TKmAw+VpUGS0bfeMz.qy8hh5TKmAw+NxYhMBENJnt.qy8hh5TKmAw+aJ2iu7DSTE3.qy8hh5TKmAw+CmD9190sTk3.qy8hh5TKmAw+W5gQjYOpiMz.qy8hh5TKmAw+EEfp3VGHuII.qy8hh5TKmAw+kX15I1Xgw3K.qy8hh5TKmAw+XIq5kSZFIxc.qy8hh5TKmAw+tYjYIQMBOWg.qy8hh5TKmAw+YaCaSx5WgeP.qy8hh5TKmAw+NCn69WVzGmS.qy8hh5TKmAw+ecJ1sFcbOaw.qy8hh5TKmAw+TuVCB3F7Tos.qy8hh5TKmAw+zWZyXSK9DNk.qy8hh5TKmAw"

        },

        {
            dxName: "ENMChildren",
            dxId: "UROqXtz4l0L.MdbVFagDcvM+zja1VSMWp8m.MdbVFagDcvM+Fd69CR15Kb7.MdbVFagDcvM+QZj31W8iDqf.MdbVFagDcvM+woC5n7JpeRd.MdbVFagDcvM+P5l9reCQSos.MdbVFagDcvM+DtmsvisQUha.MdbVFagDcvM+P0Ytk0RKmbJ.MdbVFagDcvM+kv9nGOpOXM0.MdbVFagDcvM+Mx6a0AMHygn.MdbVFagDcvM+qsjP4WtWNeM.MdbVFagDcvM+yQwGoCoEz6n.MdbVFagDcvM+oXVvdpkoOpQ.MdbVFagDcvM+JxWv1puiWhd.MdbVFagDcvM+LUZhLRGRtpL.MdbVFagDcvM+iAtRrU8AZBQ.MdbVFagDcvM"

        },
        {
            dxName: "ENMAdolescence",
            dxId: "UROqXtz4l0L.pS5QAG6ifEE+zja1VSMWp8m.pS5QAG6ifEE+Fd69CR15Kb7.pS5QAG6ifEE+QZj31W8iDqf.pS5QAG6ifEE+woC5n7JpeRd.pS5QAG6ifEE+P5l9reCQSos.pS5QAG6ifEE+DtmsvisQUha.pS5QAG6ifEE+P0Ytk0RKmbJ.pS5QAG6ifEE+kv9nGOpOXM0.pS5QAG6ifEE+Mx6a0AMHygn.pS5QAG6ifEE+qsjP4WtWNeM.pS5QAG6ifEE+yQwGoCoEz6n.pS5QAG6ifEE+oXVvdpkoOpQ.pS5QAG6ifEE+JxWv1puiWhd.pS5QAG6ifEE+LUZhLRGRtpL.pS5QAG6ifEE+iAtRrU8AZBQ.pS5QAG6ifEE"

        },
        {
            dxName: "ENMAdult",
            dxId: "UROqXtz4l0L.dE2LroslFmI+zja1VSMWp8m.dE2LroslFmI+Fd69CR15Kb7.dE2LroslFmI+QZj31W8iDqf.dE2LroslFmI+woC5n7JpeRd.dE2LroslFmI+P5l9reCQSos.dE2LroslFmI+DtmsvisQUha.dE2LroslFmI+P0Ytk0RKmbJ.dE2LroslFmI+kv9nGOpOXM0.dE2LroslFmI+Mx6a0AMHygn.dE2LroslFmI+qsjP4WtWNeM.dE2LroslFmI+yQwGoCoEz6n.dE2LroslFmI+oXVvdpkoOpQ.dE2LroslFmI+JxWv1puiWhd.dE2LroslFmI+LUZhLRGRtpL.dE2LroslFmI+iAtRrU8AZBQ.dE2LroslFmI"

        },
        {
            dxName: "ENMSenior",
            dxId: "UROqXtz4l0L.d1KOjSqmQfS+zja1VSMWp8m.d1KOjSqmQfS+Fd69CR15Kb7.d1KOjSqmQfS+QZj31W8iDqf.d1KOjSqmQfS+woC5n7JpeRd.d1KOjSqmQfS+P5l9reCQSos.d1KOjSqmQfS+DtmsvisQUha.d1KOjSqmQfS+P0Ytk0RKmbJ.d1KOjSqmQfS+kv9nGOpOXM0.d1KOjSqmQfS+Mx6a0AMHygn.d1KOjSqmQfS+qsjP4WtWNeM.d1KOjSqmQfS+yQwGoCoEz6n.d1KOjSqmQfS+oXVvdpkoOpQ.d1KOjSqmQfS+JxWv1puiWhd.d1KOjSqmQfS+LUZhLRGRtpL.d1KOjSqmQfS+iAtRrU8AZBQ.d1KOjSqmQfS"

        },
        {
            dxName: "ENFChildren",
            dxId: "UROqXtz4l0L.K9oz7QsOX9y+zja1VSMWp8m.K9oz7QsOX9y+Fd69CR15Kb7.K9oz7QsOX9y+QZj31W8iDqf.K9oz7QsOX9y+DPimQ948Cdl.K9oz7QsOX9y+RL6zDOxipUf.K9oz7QsOX9y+woC5n7JpeRd.K9oz7QsOX9y+P5l9reCQSos.K9oz7QsOX9y+DtmsvisQUha.K9oz7QsOX9y+P0Ytk0RKmbJ.K9oz7QsOX9y+kv9nGOpOXM0.K9oz7QsOX9y+Mx6a0AMHygn.K9oz7QsOX9y+qsjP4WtWNeM.K9oz7QsOX9y+yQwGoCoEz6n.K9oz7QsOX9y+oXVvdpkoOpQ.K9oz7QsOX9y+JxWv1puiWhd.K9oz7QsOX9y+LUZhLRGRtpL.K9oz7QsOX9y+iAtRrU8AZBQ.K9oz7QsOX9y"

        },
        {
            dxName: "ENFAdolescence",
            dxId: "UROqXtz4l0L.uWKSMAog0DK+zja1VSMWp8m.uWKSMAog0DK+Fd69CR15Kb7.uWKSMAog0DK+QZj31W8iDqf.uWKSMAog0DK+DPimQ948Cdl.uWKSMAog0DK+RL6zDOxipUf.uWKSMAog0DK+woC5n7JpeRd.uWKSMAog0DK+P5l9reCQSos.uWKSMAog0DK+DtmsvisQUha.uWKSMAog0DK+P0Ytk0RKmbJ.uWKSMAog0DK+kv9nGOpOXM0.uWKSMAog0DK+Mx6a0AMHygn.uWKSMAog0DK+qsjP4WtWNeM.uWKSMAog0DK+yQwGoCoEz6n.uWKSMAog0DK+oXVvdpkoOpQ.uWKSMAog0DK+JxWv1puiWhd.uWKSMAog0DK+LUZhLRGRtpL.uWKSMAog0DK+iAtRrU8AZBQ.uWKSMAog0DK"

        },
        {
            dxName: "ENFAdult",
            dxId: "UROqXtz4l0L.hT6vOD6u3aJ+zja1VSMWp8m.hT6vOD6u3aJ+Fd69CR15Kb7.hT6vOD6u3aJ+QZj31W8iDqf.hT6vOD6u3aJ+DPimQ948Cdl.hT6vOD6u3aJ+RL6zDOxipUf.hT6vOD6u3aJ+woC5n7JpeRd.hT6vOD6u3aJ+P5l9reCQSos.hT6vOD6u3aJ+DtmsvisQUha.hT6vOD6u3aJ+P0Ytk0RKmbJ.hT6vOD6u3aJ+kv9nGOpOXM0.hT6vOD6u3aJ+Mx6a0AMHygn.hT6vOD6u3aJ+qsjP4WtWNeM.hT6vOD6u3aJ+yQwGoCoEz6n.hT6vOD6u3aJ+oXVvdpkoOpQ.hT6vOD6u3aJ+JxWv1puiWhd.hT6vOD6u3aJ+LUZhLRGRtpL.hT6vOD6u3aJ+iAtRrU8AZBQ.hT6vOD6u3aJ"

        },
        {
            dxName: "ENFSenior",
            dxId: "UROqXtz4l0L.XY4AUaQXb8N+zja1VSMWp8m.XY4AUaQXb8N+Fd69CR15Kb7.XY4AUaQXb8N+QZj31W8iDqf.XY4AUaQXb8N+DPimQ948Cdl.XY4AUaQXb8N+RL6zDOxipUf.XY4AUaQXb8N+woC5n7JpeRd.XY4AUaQXb8N+P5l9reCQSos.XY4AUaQXb8N+DtmsvisQUha.XY4AUaQXb8N+P0Ytk0RKmbJ.XY4AUaQXb8N+kv9nGOpOXM0.XY4AUaQXb8N+Mx6a0AMHygn.XY4AUaQXb8N+qsjP4WtWNeM.XY4AUaQXb8N+yQwGoCoEz6n.XY4AUaQXb8N+oXVvdpkoOpQ.XY4AUaQXb8N+JxWv1puiWhd.XY4AUaQXb8N+LUZhLRGRtpL.XY4AUaQXb8N+iAtRrU8AZBQ.XY4AUaQXb8N"

        },
        {
            dxName: "ENTransgender",
            dxId: "OQo3vMLMozg.KgEdissejtN+N3QS8dseYgK.KgEdissejtN+pCIgAYbtdcD.KgEdissejtN+Hr8AuSy4YKS.KgEdissejtN+VpUGS0bfeMz.KgEdissejtN+NxYhMBENJnt.KgEdissejtN+aJ2iu7DSTE3.KgEdissejtN+CmD9190sTk3.KgEdissejtN+W5gQjYOpiMz.KgEdissejtN+EEfp3VGHuII.KgEdissejtN+kX15I1Xgw3K.KgEdissejtN+XIq5kSZFIxc.KgEdissejtN+tYjYIQMBOWg.KgEdissejtN+YaCaSx5WgeP.KgEdissejtN+NCn69WVzGmS.KgEdissejtN+ecJ1sFcbOaw.KgEdissejtN+TuVCB3F7Tos.KgEdissejtN+zWZyXSK9DNk.KgEdissejtN"

        },
        {
            dxName: "EOMChildren",
            dxId: "UROqXtz4l0L.xP27sqOJe1c+zja1VSMWp8m.xP27sqOJe1c+Fd69CR15Kb7.xP27sqOJe1c+QZj31W8iDqf.xP27sqOJe1c+woC5n7JpeRd.xP27sqOJe1c+P5l9reCQSos.xP27sqOJe1c+DtmsvisQUha.xP27sqOJe1c+P0Ytk0RKmbJ.xP27sqOJe1c+kv9nGOpOXM0.xP27sqOJe1c+Mx6a0AMHygn.xP27sqOJe1c+qsjP4WtWNeM.xP27sqOJe1c+yQwGoCoEz6n.xP27sqOJe1c+oXVvdpkoOpQ.xP27sqOJe1c+JxWv1puiWhd.xP27sqOJe1c+LUZhLRGRtpL.xP27sqOJe1c+iAtRrU8AZBQ.xP27sqOJe1c"

        },
        {
            dxName: "EOMAdolescence",
            dxId: "UROqXtz4l0L.t7M9HOIQqIz+zja1VSMWp8m.t7M9HOIQqIz+Fd69CR15Kb7.t7M9HOIQqIz+QZj31W8iDqf.t7M9HOIQqIz+woC5n7JpeRd.t7M9HOIQqIz+P5l9reCQSos.t7M9HOIQqIz+DtmsvisQUha.t7M9HOIQqIz+P0Ytk0RKmbJ.t7M9HOIQqIz+kv9nGOpOXM0.t7M9HOIQqIz+Mx6a0AMHygn.t7M9HOIQqIz+qsjP4WtWNeM.t7M9HOIQqIz+yQwGoCoEz6n.t7M9HOIQqIz+oXVvdpkoOpQ.t7M9HOIQqIz+JxWv1puiWhd.t7M9HOIQqIz+LUZhLRGRtpL.t7M9HOIQqIz+iAtRrU8AZBQ.t7M9HOIQqIz"

        },
        {
            dxName: "EOMADult",
            dxId: "UROqXtz4l0L.cZN8sSFQiBK+zja1VSMWp8m.cZN8sSFQiBK+Fd69CR15Kb7.cZN8sSFQiBK+QZj31W8iDqf.cZN8sSFQiBK+woC5n7JpeRd.cZN8sSFQiBK+P5l9reCQSos.cZN8sSFQiBK+DtmsvisQUha.cZN8sSFQiBK+P0Ytk0RKmbJ.cZN8sSFQiBK+kv9nGOpOXM0.cZN8sSFQiBK+Mx6a0AMHygn.cZN8sSFQiBK+qsjP4WtWNeM.cZN8sSFQiBK+yQwGoCoEz6n.cZN8sSFQiBK+oXVvdpkoOpQ.cZN8sSFQiBK+JxWv1puiWhd.cZN8sSFQiBK+LUZhLRGRtpL.cZN8sSFQiBK+iAtRrU8AZBQ.cZN8sSFQiBK"

        },
        {
            dxName: "EOMASenior",
            dxId: "UROqXtz4l0L.m5ixZe5XYc9+zja1VSMWp8m.m5ixZe5XYc9+Fd69CR15Kb7.m5ixZe5XYc9+QZj31W8iDqf.m5ixZe5XYc9+woC5n7JpeRd.m5ixZe5XYc9+P5l9reCQSos.m5ixZe5XYc9+DtmsvisQUha.m5ixZe5XYc9+P0Ytk0RKmbJ.m5ixZe5XYc9+kv9nGOpOXM0.m5ixZe5XYc9+Mx6a0AMHygn.m5ixZe5XYc9+qsjP4WtWNeM.m5ixZe5XYc9+yQwGoCoEz6n.m5ixZe5XYc9+oXVvdpkoOpQ.m5ixZe5XYc9+JxWv1puiWhd.m5ixZe5XYc9+LUZhLRGRtpL.m5ixZe5XYc9+iAtRrU8AZBQ.m5ixZe5XYc9"

        },
        {
            dxName: "EOFChildren",
            dxId: "UROqXtz4l0L.lsbQcMAkjnS+zja1VSMWp8m.lsbQcMAkjnS+Fd69CR15Kb7.lsbQcMAkjnS+QZj31W8iDqf.lsbQcMAkjnS+DPimQ948Cdl.lsbQcMAkjnS+RL6zDOxipUf.lsbQcMAkjnS+woC5n7JpeRd.lsbQcMAkjnS+P5l9reCQSos.lsbQcMAkjnS+DtmsvisQUha.lsbQcMAkjnS+P0Ytk0RKmbJ.lsbQcMAkjnS+kv9nGOpOXM0.lsbQcMAkjnS+Mx6a0AMHygn.lsbQcMAkjnS+qsjP4WtWNeM.lsbQcMAkjnS+yQwGoCoEz6n.lsbQcMAkjnS+oXVvdpkoOpQ.lsbQcMAkjnS+JxWv1puiWhd.lsbQcMAkjnS+LUZhLRGRtpL.lsbQcMAkjnS+iAtRrU8AZBQ.lsbQcMAkjnS"

        },
        {
            dxName: "EOFAdolescence",
            dxId: "UROqXtz4l0L.J2WRoGiWl0h+zja1VSMWp8m.J2WRoGiWl0h+Fd69CR15Kb7.J2WRoGiWl0h+QZj31W8iDqf.J2WRoGiWl0h+DPimQ948Cdl.J2WRoGiWl0h+RL6zDOxipUf.J2WRoGiWl0h+woC5n7JpeRd.J2WRoGiWl0h+P5l9reCQSos.J2WRoGiWl0h+DtmsvisQUha.J2WRoGiWl0h+P0Ytk0RKmbJ.J2WRoGiWl0h+kv9nGOpOXM0.J2WRoGiWl0h+Mx6a0AMHygn.J2WRoGiWl0h+qsjP4WtWNeM.J2WRoGiWl0h+yQwGoCoEz6n.J2WRoGiWl0h+oXVvdpkoOpQ.J2WRoGiWl0h+JxWv1puiWhd.J2WRoGiWl0h+LUZhLRGRtpL.J2WRoGiWl0h+iAtRrU8AZBQ.J2WRoGiWl0h"

        },
        {
            dxName: "EOFAdult",
            dxId: "UROqXtz4l0L.rIUg2B7XPVQ+zja1VSMWp8m.rIUg2B7XPVQ+Fd69CR15Kb7.rIUg2B7XPVQ+QZj31W8iDqf.rIUg2B7XPVQ+DPimQ948Cdl.rIUg2B7XPVQ+RL6zDOxipUf.rIUg2B7XPVQ+woC5n7JpeRd.rIUg2B7XPVQ+P5l9reCQSos.rIUg2B7XPVQ+DtmsvisQUha.rIUg2B7XPVQ+P0Ytk0RKmbJ.rIUg2B7XPVQ+kv9nGOpOXM0.rIUg2B7XPVQ+Mx6a0AMHygn.rIUg2B7XPVQ+qsjP4WtWNeM.rIUg2B7XPVQ+yQwGoCoEz6n.rIUg2B7XPVQ+oXVvdpkoOpQ.rIUg2B7XPVQ+JxWv1puiWhd.rIUg2B7XPVQ+LUZhLRGRtpL.rIUg2B7XPVQ+iAtRrU8AZBQ.rIUg2B7XPVQ"

        },
        {
            dxName: "EOFSenior",
            dxId: "UROqXtz4l0L.Vio8Jj3chhH+zja1VSMWp8m.Vio8Jj3chhH+Fd69CR15Kb7.Vio8Jj3chhH+QZj31W8iDqf.Vio8Jj3chhH+DPimQ948Cdl.Vio8Jj3chhH+RL6zDOxipUf.Vio8Jj3chhH+woC5n7JpeRd.Vio8Jj3chhH+P5l9reCQSos.Vio8Jj3chhH+DtmsvisQUha.Vio8Jj3chhH+P0Ytk0RKmbJ.Vio8Jj3chhH+kv9nGOpOXM0.Vio8Jj3chhH+Mx6a0AMHygn.Vio8Jj3chhH+qsjP4WtWNeM.Vio8Jj3chhH+yQwGoCoEz6n.Vio8Jj3chhH+oXVvdpkoOpQ.Vio8Jj3chhH+JxWv1puiWhd.Vio8Jj3chhH+LUZhLRGRtpL.Vio8Jj3chhH+iAtRrU8AZBQ.Vio8Jj3chhH"

        },
        {
            dxName: "EOTransgender",
            dxId: "OQo3vMLMozg.DqjeIm3wnAz+N3QS8dseYgK.DqjeIm3wnAz+pCIgAYbtdcD.DqjeIm3wnAz+Hr8AuSy4YKS.DqjeIm3wnAz+VpUGS0bfeMz.DqjeIm3wnAz+NxYhMBENJnt.DqjeIm3wnAz+aJ2iu7DSTE3.DqjeIm3wnAz+CmD9190sTk3.DqjeIm3wnAz+W5gQjYOpiMz.DqjeIm3wnAz+EEfp3VGHuII.DqjeIm3wnAz+kX15I1Xgw3K.DqjeIm3wnAz+XIq5kSZFIxc.DqjeIm3wnAz+tYjYIQMBOWg.DqjeIm3wnAz+YaCaSx5WgeP.DqjeIm3wnAz+NCn69WVzGmS.DqjeIm3wnAz+ecJ1sFcbOaw.DqjeIm3wnAz+TuVCB3F7Tos.DqjeIm3wnAz+zWZyXSK9DNk.DqjeIm3wnAz"

        }

    ];

    //get the selected date via URL
    var windowUrl = window.location.href;
    var params = windowUrl.split('=');
    var gotPeriod = params[2];

    var dxUIDs = [];


    jQuery(document).ready(function () {
        $(".hideInPrint").hide();
        document.getElementById('orgUnitID').innerHTML = orgUnit.name;
        document.getElementById('period').innerHTML = getPeriod(gotPeriod);
        //document.getElementById('peID2').innerHTML = getPeriod(gotPeriod);


        if(orgUnit.id=="AMxR2zzcrou"){
            alert("please select a circle/district");
            window.history.back();
        }
        if(orgUnit.id=="b3vBdsycgAD"){
            alert("please select a circle/district");
            window.history.back();
        }

        //make a string of DE ID's
        $.each(tableDX, function () {
            var deUIDs = this.dxId.split("+");
            $.each(deUIDs, function (i) {
                dxUIDs.push([deUIDs[i].split(".")[0], deUIDs[i].split(".")[1]]);
            });
        });

        $("#btnExport").click(function (e) {
            window.open('data:application/vnd.ms-excel,' + encodeURIComponent($('#printing').html()));
            e.preventDefault();
        });
        // retrieve all organisation units of a selection
        var orgUrl = "../api/organisationUnits/" + orgUnit.id + ".json?fields=id&includeDescendants=true";
        $.get(orgUrl, function (json) {
            noOfOrgUnitChildren = json.organisationUnits.length;
            circle(json);
            district(json);
            hospitals(json);
        });
    });

    function circle(json1) {
        var cirUrl = "../api/organisationUnits/b3vBdsycgAD.json?fields=children[id,name]";
        $.get(cirUrl, function (json) {
            var circles = json;
            noOfCircles = json.children.length;
            compare1(json1, circles);
        });
    }
    function compare1(json1, json2) {
        console.log(noOfCircles);
        for (var i = 0; i < noOfOrgUnitChildren; i++) {

            for (var j = 0; j < noOfCircles; j++) {


                if (json1.organisationUnits[i].id == json2.children[j].id) {
                    console.log("ff");
                    cirIDs[index1] = json2.children[j].id;
                    cirNames[index1] = json2.children[j].name;
                    //orgUnitUIDs+=json2.organisationUnits[j].id+";";
                    index1++;
                    console.log(cirNames);
                }
            }
        }

    }

    function district(json1) {
        var disUrl = "../api/organisationUnitGroups/CXswpFTMKVB.json?fields=organisationUnits[id,name,path]";
        $.get(disUrl, function (json) {
            var districts = json;
            noOfDistricts = districts.organisationUnits.length;
            compare2(json1, districts);
        });
    }

    function compare2(json1, json2) {
        for (var i = 0; i < noOfOrgUnitChildren; i++) {

            for (var j = 0; j < noOfDistricts; j++) {


                if (json1.organisationUnits[i].id == json2.organisationUnits[j].id) {
                    console.log("ggg");
                    districtCircle[index2] = json2.organisationUnits[j].path.split("/")[3];
                    districtIDs[index2] = json2.organisationUnits[j].id;
                    districtNames[index2] = json2.organisationUnits[j].name;
                    //orgUnitUIDs+=json2.organisationUnits[j].id+";";
                    index2++;
                    //console.log(orgUnitUIDs);
                }
            }
        }
        if (districtIDs.length == 0) {
            {
                check++;
                alert("Selected Facility is not an Intervention of Circle/District");
                window.history.back();
            }
        }
    }

    function hospitals(json1) {
        var hosUrl = "../api/organisationUnitGroups/S57GNhlxPe7.json?fields=organisationUnits[id,name,path]";
        $.get(hosUrl, function (json) {
            var hospitals = json;
            noOfHospitalss = hospitals.organisationUnits.length;
            compare3(json1, hospitals);
        });
    }


    function compare3(json1, json2) {
        for (var i = 0; i < noOfOrgUnitChildren; i++) {

            for (var j = 0; j < noOfHospitalss; j++) {


                if (json1.organisationUnits[i].id == json2.organisationUnits[j].id) {
                    //console.log("kkk");
                    hospitalDistrict[index3] = json2.organisationUnits[j].path.split("/")[4];
                    hospitalIDs[index3] = json2.organisationUnits[j].id;
                    hospitalNames[index3] = json2.organisationUnits[j].name;
                    orgUnitUIDs += json2.organisationUnits[j].id + ";";
                    index3++;
                    //console.log(orgUnitUIDs);
                }
            }
        }
        if (hospitalIDs.length == 0 && check==0) {

                alert("Selected Facility is not having hospitals");
                window.history.back();

        }
        else{
            loadData(orgUnitUIDs);
        }

    }

    //function to set the selected dates.
    function getPeriod(pr) {
        var year = pr.substring(0, 4);
        var month = pr.substring(4, 6);
        var strMonth = "";

        if (month == "01" || month == "1")        strMonth = "January";
        else if (month == "02" || month == "2")    strMonth = "February";
        else if (month == "03" || month == "3")    strMonth = "March";
        else if (month == "04" || month == "4")    strMonth = "April";
        else if (month == "05" || month == "5")    strMonth = "May";
        else if (month == "06" || month == "6")    strMonth = "June";
        else if (month == "07" || month == "7")    strMonth = "July";
        else if (month == "08" || month == "8")    strMonth = "August";
        else if (month == "09" || month == "9")    strMonth = "September";
        else if (month == "10")                strMonth = "October";
        else if (month == "11")                strMonth = "November";
        else if (month == "12")                strMonth = "December";

        return strMonth + " " + year;
    }




    function loadData(orgUnitUIDs) {
        //console.log(orgUnitUIDs);
        var deUIDs = "";
        $.each(dxUIDs, function (idx) {
            if (deUIDs.search(dxUIDs[idx][0]) < 0) {
                deUIDs += dxUIDs[idx][0] + ";";
            }
        });
        //console.log(orgNames);
        //console.log(orgIDs);
        var url = "../api/analytics.json?dimension=dx:" + deUIDs + "&dimension=ou:" + orgUnitUIDs + "&dimension=co&filter=pe:" + period;

        $.get(url, function (json) {


            jsonData1 = json;
            //console.log( jsonData1 );

            loadReport(jsonData1);
        });

    }
    //show report
    function loadReport(json) {
        var htmlReport = "";
        var index4 = 0;
        var staTotal = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];

        if (cirIDs.length > 0) {
            for (var i = 0; i < cirIDs.length; i++) {
                var cirTotal = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                for (var j = 0; j < districtIDs.length; j++) {
                    //console.log(districtNames[j]);
                    if (cirIDs[i] == districtCircle[j]) {
                        var disTotal = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                        var p = 0;
                        for (var k = 0; k < hospitalIDs.length; k++) {
                            if (districtIDs[j] == hospitalDistrict[k]) {
                                p++;
                                //console.log(districtNames[j]);
                                //console.log(hospitalNames[k]);

                                index4++;
                                $("#showingTable > tbody").html("");
                                htmlReport += "<tbody>";
                                htmlReport += "<tr>";
                                htmlReport += "<td align='center'style='padding-left:5px'>" + (index4) + "</td>";
                                htmlReport += "<td align='left'style='padding-left:5px'>" + hospitalNames[k] + "</td>";

                                var d = 0;
                                var cellTotal = [];
                                for (var c = 0; c < 36; c++) {
                                    var val = 0;


                                        for(var f =(0+d); f < d+9; f++) {
                                            val += getValueForCategoryOptionCombo(json, dxUIDs[f][0], hospitalIDs[k], dxUIDs[f][1]);
                                        }


                                    d=d+9;
                                    cellTotal[c] = val;
                                    htmlReport += "<td align='center'>" + val + "</td>";

                                }

                                htmlReport += "<td align='center'>" + (cellTotal[0] + cellTotal[18]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[1] + cellTotal[19]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[2] + cellTotal[20]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[3] + cellTotal[21]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[4] + cellTotal[22]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[5] + cellTotal[23]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[6] + cellTotal[24]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[7] + cellTotal[25]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[8] + cellTotal[26]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[9] + cellTotal[27]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[10] + cellTotal[28]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[11] + cellTotal[29]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[12] + cellTotal[30]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[13] + cellTotal[31]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[14] + cellTotal[32]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[15] + cellTotal[33]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[16] + cellTotal[34]) + "</td>";
                                htmlReport += "<td align='center'>" + (cellTotal[17] + cellTotal[35]) + "</td>";
                                htmlReport += "</tr>";

                            }

                        }

                    }

                }

            }


        }
        else{
         for (var j = 0; j < districtIDs.length; j++) {
         //console.log(districtNames[j]);
         //var disTotal=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
         for (var k = 0; k < hospitalIDs.length; k++) {
         if (districtIDs[j] == hospitalDistrict[k]) {
         //console.log(districtNames[j]);
         //console.log(hospitalNames[k]);
             p++;
             //console.log(districtNames[j]);
             //console.log(hospitalNames[k]);

             index4++;
             $("#showingTable > tbody").html("");
             htmlReport += "<tbody>";
             htmlReport += "<tr>";
             htmlReport += "<td align='left'style='padding-left:5px'>" + (index4) + "</td>";
             htmlReport += "<td align='left'style='padding-left:5px'>" + hospitalNames[k] + "</td>";

             var d = 0;
             var cellTotal = [];
             for (var c = 0; c < 36; c++) {
                 var val = 0;



                     val += getValueForCategoryOptionCombo(json,tableDX[c].dxId, hospitalIDs[k]);



                 d=d+9;
                 cellTotal[c] = val;
                 htmlReport += "<td align='center'>" + val + "</td>";

             }

             htmlReport += "<td align='center'>" + (cellTotal[0] + cellTotal[18]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[1] + cellTotal[19]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[2] + cellTotal[20]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[3] + cellTotal[21]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[4] + cellTotal[22]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[5] + cellTotal[23]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[6] + cellTotal[24]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[7] + cellTotal[25]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[8] + cellTotal[26]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[9] + cellTotal[27]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[10] + cellTotal[28]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[11] + cellTotal[29]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[12] + cellTotal[30]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[13] + cellTotal[31]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[14] + cellTotal[32]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[15] + cellTotal[33]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[16] + cellTotal[34]) + "</td>";
             htmlReport += "<td align='center'>" + (cellTotal[17] + cellTotal[35]) + "</td>";
             htmlReport += "</tr>";
         }
         }




         }

         }
        $("#showingTable").append(htmlReport);
        hideLoad();

    }

    function getValueForCategoryOptionCombo(json, dx,ou) {
        var coc;
        var de;
        var result = 0;
        var d = dx.split("+");
        $.each(d, function (i) {
            de = (d[i].split(".")[0]);
            coc = d[i].split(".")[1];
            for (var j = 0; j < json.rows.length; j++) {
                if (json.rows[j][0] == de && json.rows[j][1] == coc && json.rows[j][2] == ou && json.rows[j][3] != null) {
                    result+=parseInt(json.rows[j][3]);
                }
            }
        });


        return result;
    }


    //retrieve value for category options
   /* function getValueForCategoryOptionCombo(json, de, orgUnit, coc) {
     var result = 0;
     for (var i = 0; i < json.rows.length; i++) {
     if (json.rows[i][0] == de && json.rows[i][2] == orgUnit && json.rows[i][1] == coc && json.rows[i][3] != null) {
     result += parseInt(json.rows[i][3]);
     }
     }
     return result;
     }
     */

    function hideLoad() {
        document.getElementById("cover").style.display = "none";
        document.getElementById("loads").style.display = "none";
        //document.getElementById("loading").style.display="none";
        document.getElementsByTagName("body")[0].style.overflow = "scroll";
    }


</script>


<script type="text/javascript">
    function printContent(el) {
        var restorepage = document.body.innerHTML;
        var printcontent = document.getElementById(el).innerHTML;
        document.body.innerHTML = printcontent;
        window.print();
        document.body.innerHTML = restorepage;
    }
</script>

<p><span style="font-size:12px;">
<style>

    td {
        padding: 5px 10px;
        font: Arial, Helvetica, sans-serif;
    }

    bd {
        border-style: solid;
        border-color: #000000;
    }

    #cover {
        position: fixed;
        top: 0;
        left: 0;
        background: rgba(0, 0, 0, 0.7);
        z-index: 5;
        width: 100%;
        height: 100%;
    }

    #loads {
        height: 100px;
        width: 500px;
        position: fixed;
        z-index: 10;
        margin: 0 auto;
        top: 50%;
        left: 50%;
        margin-top: -50px;
        margin-left: -250px;
        background: #999;
        border: 5px solid #cccccc;
        text-align = center;
        border-radius: 5px;
    }

    #loading {
        width: 400px;
        font-size: 20px;
        font-family: verdana;
        font-weight: bolder;
        position: fixed;
        top: 50%;
        left: 50%;
        margin: 0 auto;
        margin-top: -8px;
        margin-left: -200px;
    }

    .vtext {
        /*width:1px;
        height: 50px;
        -ms-transform: rotate(90deg);
        -webkit-transform: rotate(90deg);
        transform: rotate(90deg);
        border-style: hidden;*/
    }

</style>
<div id="loads"><p id="loading" align="center">Reports Loading... Please Wait...</p></div>
		<div id="cover"></div>

</span></p>

<style>
    td {
        border: solid black 1px;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 13px;
    }

</style>
<input type="button" id="btnBack" value=" Goto Report Selection Page"
       onclick="location.href='../dhis-web-reports-app/index.html#/generate-report'"/>
<input type="button" onclick="printContent('printing');" value="Print"/>
<input type="button" id="btnExport" value=" Download Excel "/>


</br></br>

<div id="printing">

    <div id='state'>
        <table id="showingTable" border="1" cellspacing="6" cellpadding="4"
               style="border-collapse:collapse; border:solid black 2px; font:Arial, Helvetica, sans-serif">
            <thead>
            <tr align="center" height="40">
                <td bgcolor="#99CC99" width="100%" colspan="56"><span style="text-align: center;font-size: 25px;"> Hospital OPD report</span>
                </td>
            </tr>


            <tr align="center" bgcolor="gray">
                <td bgcolor="yellow" colspan="1" style="text-align: center;"><span style="font-size:14px;"><strong>Facility</strong></span>
                </td>
                <td bgcolor="yellow" colspan="3" id="orgUnitID" style="text-align: center;"><span
                        style="font-size:14px;"><strong>&nbsp;</strong></span></td>

                <td colspan="1" style="text-align: center;"><span style="font-size:14px;"><strong>Period:</strong></span>
                </td>
                <td colspan="3" id="period" style="text-align: center;"><span style="font-size:14px;"><strong>
                    &nbsp;</strong></span></td>


                <td colspan="48" style="text-align: center;"><span style="font-size:14px;"><strong>
                    &nbsp;</strong></span></td>

            </tr>


            <tr align="center" height="20" bgcolor="gray">
                <td style="height: 20px;" width="54" colspan="1" rowspan="4"><strong>Sr.No</strong></td>
                <td style="height: 20px;" width="54" colspan="1" rowspan="4"><strong>Name of the Hospital</strong></td>
                <td style="height: 20px;" colspan="18"><strong>Morning OPD</strong></td>
                <td style="height: 20px;" colspan="18"><strong>Evening OPD</strong></td>
                <td style="height: 20px;" colspan="18"><strong>Total OPD</strong></td>
            </tr>

            <tr align="center" height="20" bgcolor="gray">
                <td style="height: 20px;" width="54" colspan="9"><strong>New OPD</strong></td>
                <td style="height: 20px;" width="54" colspan="9"><strong>OLD OPD</strong></td>
                <td style="height: 20px;" width="54" colspan="9"><strong>New OPD</strong></td>
                <td style="height: 20px;" width="54" colspan="9"><strong>OLD OPD</strong></td>
                <td style="height: 20px;" width="54" colspan="9"><strong>New OPD</strong></td>
                <td style="height: 20px;" width="54" colspan="9"><strong>OLD OPD</strong></td>
            </tr>

            <tr align="center" height="20" bgcolor="gray">
                <td style="height: 20px;" width="54" colspan="4"><strong>Male</strong></td>
                <td style="height: 20px;" width="54" colspan="4"><strong>Female</strong></td>
                <td style="height: 20px;" width="54" colspan="1" rowspan="2"><strong>Transgender</strong></td>

                <td style="height: 20px;" width="54" colspan="4"><strong>Male</strong></td>
                <td style="height: 20px;" width="54" colspan="4"><strong>Female</strong></td>
                <td style="height: 20px;" width="54" colspan="1" rowspan="2"><strong>Transgender</strong></td>

                <td style="height: 20px;" width="54" colspan="4"><strong>Male</strong></td>
                <td style="height: 20px;" width="54" colspan="4"><strong>Female</strong></td>
                <td style="height: 20px;" width="54" colspan="1" rowspan="2"><strong>Transgender</strong></td>

                <td style="height: 20px;" width="54" colspan="4"><strong>Male</strong></td>
                <td style="height: 20px;" width="54" colspan="4"><strong>Female</strong></td>
                <td style="height: 20px;" width="54" colspan="1" rowspan="2"><strong>Transgender</strong></td>

                <td style="height: 20px;" width="54" colspan="4"><strong>Male</strong></td>
                <td style="height: 20px;" width="54" colspan="4"><strong>Female</strong></td>
                <td style="height: 20px;" width="54" colspan="1" rowspan="2"><strong>Transgender</strong></td>

                <td style="height: 20px;" width="54" colspan="4"><strong>Male</strong></td>
                <td style="height: 20px;" width="54" colspan="4"><strong>Female</strong></td>
                <td style="height: 20px;" width="54" colspan="1" rowspan="2"><strong>Transgender</strong></td>
            </tr>

            <tr align="center" height="20" bgcolor="gray">
                <td style="height: 20px;" width="54" colspan="1"><strong>Children<12</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adolescence(12-18)</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adult (18-60) </strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Senior Citizen </strong></td>

                <td style="height: 20px;" width="54" colspan="1"><strong>Children<12</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adolescence(12-18)</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adult (18-60) </strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Senior Citizen </strong></td>

                <td style="height: 20px;" width="54" colspan="1"><strong>Children<12</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adolescence(12-18)</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adult (18-60) </strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Senior Citizen </strong></td>

                <td style="height: 20px;" width="54" colspan="1"><strong>Children<12</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adolescence(12-18)</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adult (18-60) </strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Senior Citizen </strong></td>

                <td style="height: 20px;" width="54" colspan="1"><strong>Children<12</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adolescence(12-18)</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adult (18-60) </strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Senior Citizen </strong></td>

                <td style="height: 20px;" width="54" colspan="1"><strong>Children<12</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adolescence(12-18)</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adult (18-60) </strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Senior Citizen </strong></td>

                <td style="height: 20px;" width="54" colspan="1"><strong>Children<12</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adolescence(12-18)</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adult (18-60) </strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Senior Citizen </strong></td>


                <td style="height: 20px;" width="54" colspan="1"><strong>Children<12</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adolescence(12-18)</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adult (18-60) </strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Senior Citizen </strong></td>


                <td style="height: 20px;" width="54" colspan="1"><strong>Children<12</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adolescence(12-18)</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adult (18-60) </strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Senior Citizen </strong></td>

                <td style="height: 20px;" width="54" colspan="1"><strong>Children<12</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adolescence(12-18)</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adult (18-60) </strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Senior Citizen </strong></td>

                <td style="height: 20px;" width="54" colspan="1"><strong>Children<12</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adolescence(12-18)</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adult (18-60) </strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Senior Citizen </strong></td>


                <td style="height: 20px;" width="54" colspan="1"><strong>Children<12</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adolescence(12-18)</strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Adult (18-60) </strong></td>
                <td style="height: 20px;" width="54" colspan="1"><strong>Senior Citizen </strong></td>




            </tr>

            </thead>
            <tbody>

            </tbody>
        </table>

    </div>
</div>